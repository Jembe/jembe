{"version":3,"sources":["componentApi/utils.js","componentApi/directives/for.js","componentApi/directives/bind.js","componentApi/directives/text.js","componentApi/directives/html.js","componentApi/directives/show.js","componentApi/directives/if.js","componentApi/directives/on.js","componentApi/directives/model.js","../../../node_modules/observable-membrane/dist/modules/observable-membrane.js","componentApi/observable.js","../../../node_modules/process/browser.js","../../../node_modules/node-libs-browser/node_modules/path-browserify/index.js","componentApi/magic/jmb.js","componentApi/component.js","componentApi/index.js","utils.js","morphdom/morphAttrs.js","morphdom/util.js","morphdom/specialElHandlers.js","morphdom/morphdom.js","morphdom/index.js","client.js","jembe.js","../../../node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["domReady","Promise","resolve","document","readyState","addEventListener","arrayUnique","array","Array","from","Set","isTesting","navigator","userAgent","includes","checkedAttrLooseCompare","valueA","valueB","warnIfMalformedTemplate","el","directive","tagName","toLowerCase","console","warn","content","childElementCount","kebabCase","subject","replace","camelCase","match","char","toUpperCase","walk","callback","node","firstElementChild","nextElementSibling","debounce","func","wait","timeout","context","args","arguments","later","apply","clearTimeout","setTimeout","handleError","expression","error","Object","assign","tryCatch","cb","value","catch","e","saferEval","dataContext","additionalHelperVariables","call","Function","keys","values","saferEvalNoReturn","AsyncFunction","getPrototypeOf","constructor","methodReference","xAttrRE","isXAttr","attr","name","replaceAtAndColonWithStandardSyntax","test","getXAttrs","component","type","directives","attributes","filter","map","parseHtmlAttribute","spreadDirective","spreadObject","$data","concat","entries","i","sortDirectives","directiveOrder","sort","a","b","typeA","indexOf","typeB","normalizedName","typeMatch","valueMatch","modifiers","isBooleanAttr","attrName","booleanAttributes","startsWith","convertClassStringToArray","classList","filterFn","Boolean","split","TRANSITION_TYPE_IN","TRANSITION_TYPE_OUT","TRANSITION_CANCELLED","transitionIn","show","reject","forceSkip","__jmb_transition","attrs","showAttr","settingBothSidesOfTransition","index","transitionHelperIn","some","transitionClassesIn","transitionOut","hide","transitionHelperOut","transitionClassesOut","showCallback","styleValues","duration","modifierValue","origin","first","opacity","scale","second","transitionHelper","hideCallback","key","fallback","rawValue","isNumeric","join","hook1","hook2","cancel","opacityCache","style","transformCache","transform","transformOriginCache","transformOrigin","noModifiers","transitionOpacity","transitionScale","stages","start","during","transitionProperty","trim","transitionDuration","transitionTimingFunction","end","cleanup","transition","ensureStringExpression","evaluateReturnExpression","enter","find","enterStart","enterEnd","transitionClasses","leave","leaveStart","leaveEnd","classesDuring","classesStart","classesEnd","originalClasses","__jmb_original_classes","add","remove","finish","once","isConnected","nextFrame","requestAnimationFrame","Number","getComputedStyle","animationDuration","isArray","isNaN","called","handleForDirective","templateEl","initialUpdate","extraVars","iteratorNames","parseForExpression","items","evaluateItemsAndReturnEmptyIfXIfIsPresentAndFalseOnElement","currentEl","forEach","item","iterationScopeVariables","getIterationScopeVariables","currentKey","generateKeyForIteration","nextEl","lookAheadForMatchingKeyedElementAndMoveItIfFound","addElementInLoopAfterCurrentEl","__jmb_for","initializeElements","__jmb_for_key","updateElements","removeAnyLeftOverElementsFromPreviousUpdate","forIteratorRE","stripParensRE","forAliasRE","inMatch","String","res","iteratorMatch","collection","scopeVariables","bindKeyAttribute","ifAttribute","clone","importNode","parentElement","insertBefore","undefined","tmpNextEl","nextElementFromOldLoop","nextElementFromOldLoopImmutable","nextSibling","handleAttributeBindingDirective","attrType","Alpine","ignoreFocusedForValueBinding","activeElement","isSameNode","checked","val","updateSelect","setAttribute","keysSortedByBooleanValue","classNames","className","newClasses","removeAttribute","setIfChanged","getAttribute","arrayWrappedValue","options","option","selected","text","handleTextDirective","output","textContent","handleHtmlDirective","innerHTML","handleShowDirective","display","__jmb_is_shown","length","removeProperty","handle","showDirectiveLastElement","contains","executeAndClearRemainingShowDirectiveStack","showDirectiveStack","push","handleIfDirective","expressionResult","elementHasAlreadyBeenAdded","__jmb_inserted_me","registerListener","event","mutated","passive","handler","listenerTarget","target","offsetWidth","offsetHeight","runListenerHandler","removeEventListener","window","body","isKeyEvent","isListeningForASpecificKeyThatHasntBeenPressed","preventDefault","stopPropagation","returnValue","then","$jmb","callsCommands","executeCommands","nextModifier","delayModifier","m","delayId","delayTime","endsWith","parseInt","substr","comp","timerId","unnamedTimers","Date","getTime","originalComponentNamedTimers","namedTimers","id","nextTickStack","Event","__jmb_listeners","self","evaluateCommandExpression","keyModifiers","debounceIndex","splice","keyToModifier","systemKeyModifiers","selectedSystemKeyModifiers","modifier","activelyPressedKeyModifiers","registerModelListener","listenerExpression","rightSideOfExpression","generateModelAssignmentFunction","hasAttribute","currentValue","CustomEvent","detail","newValue","safeParseNumber","multiple","selectedOptions","number","parseFloat","create","ObjectCreate","defineProperty","ObjectDefineProperty","defineProperties","ObjectDefineProperties","isExtensible","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","preventExtensions","hasOwnProperty","ArrayPush","ArrayConcat","ArrayMap","prototype","OtS","toString","obj","isUndefined","isFunction","proxyToValueMap","WeakMap","registerProxy","proxy","set","unwrap","replicaOrAny","get","BaseProxyHandler","membrane","originalTarget","wrapDescriptor","descriptor","wrapValue","originalSet","originalGet","wrapGetter","wrapSetter","copyDescriptorIntoShadowTarget","shadowTarget","originalDescriptor","wrappedDesc","lockShadowTarget","targetKeys","tagPropertyKey","thisArg","argArray","construct","newTarget","valueObserved","has","ownKeys","desc","writable","configurable","enumerable","getterMap","setterMap","reverseGetterMap","reverseSetterMap","ReactiveProxyHandler","getProxy","wrappedGetter","wrappedSetter","v","unwrapDescriptor","unwrapGetter","unwrapSetter","redGet","reverseGetter","redSet","reverseSetter","valueMutated","oldValue","deleteProperty","setPrototypeOf","Error","getterMap$1","setterMap$1","ReadOnlyHandler","getReadOnlyProxy","extract","objectOrArray","original","names","reduce","seed","formatter","header","plainOrProxy","object","hasBody","getGlobal","globalThis","global","init","ReferenceError","devtoolsFormatters","ObjectDotPrototype","defaultValueIsObservable","proto","defaultValueObserved","defaultValueMutated","defaultValueDistortion","createShadowTarget","ReactiveMembrane","valueDistortion","valueIsObservable","objectGraph","unwrappedValue","distorted","o","getReactiveState","readOnly","reactive","unwrapProxy","p","distortedValue","reactiveState","reactiveHandler","Proxy","readOnlyHandler","wrap","data","mutationCallback","ObservableMembrane","observable","unwrappedData","copy","process","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","len","run","nextTick","Item","title","env","argv","version","versions","noop","on","addListener","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","JMB","jembeClient","execName","actionName","params","kwargs","addCallCommand","stateName","FileList","File","addFilesForUpload","addInitialiseCommand","eventName","to","addEmitCommand","relativeExecName","mergeExistingParams","componentNames","startWith","equalSoFar","execNameSplit","thisExecNameSplit","slice","component_reset","disableInputs","consolidateCommands","componentsOnPage","components","c","Component","$el","mounted","state","actions","mount","originalComponent","JSON","parse","stringify","localAttr","localExpression","initAttr","initExpression","updateAttr","updateExpression","dataExtras","canonicalComponentElementReference","unobservedData","$local","getUnobservedData","actionEnabled","wrapDataInObservable","$refs","getRefsProxy","$nextTick","watchers","$watch","property","initReturnedCallback","pauseReactivity","listenForNewElementsToInitialize","unmount","timerName","timerInfo","findTargetPathInData","tree","level","is","treeIsArray","subpath","updateDom","path","fullDotNotationKey","dotNotationParts","comparisonData","part","walkAndSkipNestedComponents","initializeComponentCallback","__jmb","rootEl","initializeElement","executeAndClearNextTickStack","ltarget","registerListeners","resolveBoundAttributes","updateElement","shift","reverse","promiseChain","promise","finishElement","$dispatch","getDispatchFunction","dispatchEvent","bubbles","targetNode","observerOptions","childList","subtree","observer","MutationObserver","mutations","closestParentComponent","closest","attributeName","addedNodes","nodeType","observe","refObj","ref","ComponentAPI","componentRef","dom","originalComponentRef","api","elIsNewComponent","walkComponentDom","callbackOnNewComponent","myExecName","componentExecName","deepCopy","inObject","outObject","getCookie","cookieValue","cookie","cookies","substring","decodeURIComponent","DOCUMENT_FRAGMENT_NODE","morphAttrs","fromNode","toNode","toNodeAttrs","attrNamespaceURI","attrValue","fromValue","namespaceURI","localName","getAttributeNS","prefix","setAttributeNS","fromNodeAttrs","d","hasAttributeNS","removeAttributeNS","range","NS_XHTML","doc","HAS_TEMPLATE_SUPPORT","createElement","HAS_RANGE_SUPPORT","createRange","createFragmentFromTemplate","str","template","childNodes","createFragmentFromRange","selectNode","fragment","createContextualFragment","createFragmentFromWrap","toElement","compareNodeNames","fromEl","toEl","fromNodeName","nodeName","toNodeName","fromCodeStart","toCodeStart","charCodeAt","createElementNS","moveChildren","curChild","firstChild","nextChild","appendChild","syncBooleanAttrProp","OPTION","parentNode","parentName","selectedIndex","INPUT","TEXTAREA","nodeValue","placeholder","SELECT","optgroup","ELEMENT_NODE","TEXT_NODE","COMMENT_NODE","defaultGetNodeKey","morphdomFactory","morphdom","toNodeHtml","getNodeKey","onBeforeNodeAdded","onNodeAdded","onBeforeElUpdated","onElUpdated","onBeforeNodeDiscarded","onNodeDiscarded","onBeforeElChildrenUpdated","childrenOnly","fromNodesLookup","keyedRemovalList","addKeyedRemoval","walkDiscardedChildNodes","skipKeyedNodes","removeNode","removeChild","indexTree","handleNodeAdded","unmatchedFromEl","replaceChild","morphEl","cleanupFromEl","curFromNodeChild","curFromNodeKey","fromNextSibling","toElKey","morphChildren","specialElHandlers","curToNodeChild","curToNodeKey","toNextSibling","matchingFromEl","outer","curFromNodeType","isCompatible","isEqualNode","nodeToBeAdded","cloneNode","onBeforeNodeAddedResult","actualize","ownerDocument","specialElHandler","morphedNode","morphedNodeType","toNodeType","elToRemove","ComponentRef","onDocument","hierarchyLevel","isPageComponent","url","changesUrl","_cleanDom","placeHolders","_getPlaceHolders","toJsonRequest","merge","parentComponent","replaceWith","documentElement","_morphdom","Node","domString","div","domParser","parseFromString","UploadedFile","paramName","fileUploadId","files","multipleFiles","addToFormData","formData","file","append","JembeClient","getComponentsFromDocument","updateLocation","commands","filesForUpload","DOMParser","xRequestUrl","xRequestsInProgress","xRequestActiveElement","xRequestDisabledElements","disableInputBeforeRequestTimeoutId","onpopstate","onHistoryPopState","xRequestHeadersGenerators","componentsNodes","querySelectorAll","componentNode","eval","getComponentsFromXResponse","xJembeResponse","xComp","updateDocument","currentComponents","compRef","pageExecNames","pageExecName","pen","processingExecNames","newComponents","currentComponent","orignalComponent","placeHolderName","initParams","exisitingInitCommands","x","existingCmd","paramValue","_updateParam","_updateParamR","paramNames","pName","existingFileId","uf","fileId","Math","random","initCommandIndex","findIndex","cmd","getXUploadRequestFormData","fd","FormData","getXRequestJson","setXRequestUrl","executeUpload","uploadFormData","headers","calculateXRequestHeaders","fetch","method","cache","credentials","redirect","referrer","response","ok","dispatchUpdatePageErrorEvent","json","ufiles","fu","fileUploadResponseId","location","href","dispatchStartUpdatePageEvent","requestBody","enableInputsAfterResponse","info","dispatchUpdatePageEvent","initCommandsExecNames","callCommandsExecNames","topComponent","historyState","history","replaceState","pushState","domNode","isXUpdate","inputsDisabled","fromEntries","disableInputsBeforeRequest","networkError","disabled","f","focus","addXRequestHeaderGenerator","headerGenCallback","walkComponent","querySelector","walkDocument","OVERLAY_ID","OldModule","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","every","generated","js","clear","hmrApply","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","message","stack","overlay","createErrorOverlay","getElementById","stackTrace","innerText","getParents","modules","parents","k","dep","deps","cached"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;AACO,SAASA,QAAT,GAAoB;AACvB,SAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;AAC1B,QAAIC,QAAQ,CAACC,UAAT,IAAuB,SAA3B,EAAsC;AAClCD,MAAAA,QAAQ,CAACE,gBAAT,CAA0B,kBAA1B,EAA8CH,OAA9C;AACH,KAFD,MAEO;AACHA,MAAAA,OAAO;AACV;AACJ,GANM,CAAP;AAOH;;AAEM,SAASI,WAAT,CAAqBC,KAArB,EAA4B;AAC/B,SAAOC,KAAK,CAACC,IAAN,CAAW,IAAIC,GAAJ,CAAQH,KAAR,CAAX,CAAP;AACH;;AAEM,SAASI,SAAT,GAAqB;AACxB,SAAOC,SAAS,CAACC,SAAV,EAAqBD,SAAS,CAACC,SAAV,CAAoBC,QAApB,CAA6B,SAA7B,KACrBF,SAAS,CAACC,SAAV,CAAoBC,QAApB,CAA6B,OAA7B,CADP;AAEH;;AAEM,SAASC,uBAAT,CAAiCC,MAAjC,EAAyCC,MAAzC,EAAiD;AACpD,SAAOD,MAAM,IAAIC,MAAjB;AACH;;AAEM,SAASC,uBAAT,CAAiCC,EAAjC,EAAqCC,SAArC,EAAgD;AACnD,MAAID,EAAE,CAACE,OAAH,CAAWC,WAAX,OAA6B,UAAjC,EAA6C;AACzCC,IAAAA,OAAO,CAACC,IAAR,CAAc,YAAWJ,SAAU,+FAA8FA,SAAU,EAA3I;AACH,GAFD,MAEO,IAAID,EAAE,CAACM,OAAH,CAAWC,iBAAX,KAAiC,CAArC,EAAwC;AAC3CH,IAAAA,OAAO,CAACC,IAAR,CAAc,gCAA+BJ,SAAU,4GAAvD;AACH;AACJ;;AAEM,SAASO,SAAT,CAAmBC,OAAnB,EAA4B;AAC/B,SAAOA,OAAO,CAACC,OAAR,CAAgB,iBAAhB,EAAmC,OAAnC,EAA4CA,OAA5C,CAAoD,OAApD,EAA6D,GAA7D,EAAkEP,WAAlE,EAAP;AACH;;AAEM,SAASQ,SAAT,CAAmBF,OAAnB,EAA4B;AAC/B,SAAOA,OAAO,CAACN,WAAR,GAAsBO,OAAtB,CAA8B,QAA9B,EAAwC,CAACE,KAAD,EAAQC,IAAR,KAAiBA,IAAI,CAACC,WAAL,EAAzD,CAAP;AACH;;AAEM,SAASC,IAAT,CAAcf,EAAd,EAAkBgB,QAAlB,EAA4B;AAC/B,MAAIA,QAAQ,CAAChB,EAAD,CAAR,KAAiB,KAArB,EAA4B;AAE5B,MAAIiB,IAAI,GAAGjB,EAAE,CAACkB,iBAAd;;AAEA,SAAOD,IAAP,EAAa;AACTF,IAAAA,IAAI,CAACE,IAAD,EAAOD,QAAP,CAAJ;AAEAC,IAAAA,IAAI,GAAGA,IAAI,CAACE,kBAAZ;AACH;AACJ;;AAEM,SAASC,QAAT,CAAkBC,IAAlB,EAAwBC,IAAxB,EAA8B;AACjC,MAAIC,OAAJ;AACA,SAAO,YAAY;AACf,QAAIC,OAAO,GAAG,IAAd;AAAA,QAAoBC,IAAI,GAAGC,SAA3B;;AACA,QAAIC,KAAK,GAAG,YAAY;AACpBJ,MAAAA,OAAO,GAAG,IAAV;AACAF,MAAAA,IAAI,CAACO,KAAL,CAAWJ,OAAX,EAAoBC,IAApB;AACH,KAHD;;AAIAI,IAAAA,YAAY,CAACN,OAAD,CAAZ;AACAA,IAAAA,OAAO,GAAGO,UAAU,CAACH,KAAD,EAAQL,IAAR,CAApB;AACH,GARD;AASH;;AAED,MAAMS,WAAW,GAAG,CAAC/B,EAAD,EAAKgC,UAAL,EAAiBC,KAAjB,KAA2B;AAC3C7B,EAAAA,OAAO,CAACC,IAAR,CAAc,iBAAgB4B,KAAM,qBAAoBD,UAAW,aAAnE,EAAiFhC,EAAjF;;AAEA,MAAI,CAAER,SAAS,EAAf,EAAmB;AACf0C,IAAAA,MAAM,CAACC,MAAP,CAAcF,KAAd,EAAqB;AAAEjC,MAAAA,EAAF;AAAMgC,MAAAA;AAAN,KAArB;AACA,UAAMC,KAAN;AACH;AACJ,CAPD;;AASA,SAASG,QAAT,CAAkBC,EAAlB,EAAsB;AAAErC,EAAAA,EAAF;AAAMgC,EAAAA;AAAN,CAAtB,EAA0C;AACtC,MAAI;AACA,UAAMM,KAAK,GAAGD,EAAE,EAAhB;AACA,WAAOC,KAAK,YAAYxD,OAAjB,GACDwD,KAAK,CAACC,KAAN,CAAaC,CAAD,IAAOT,WAAW,CAAC/B,EAAD,EAAKgC,UAAL,EAAiBQ,CAAjB,CAA9B,CADC,GAEDF,KAFN;AAGH,GALD,CAKE,OAAOE,CAAP,EAAU;AACRT,IAAAA,WAAW,CAAC/B,EAAD,EAAKgC,UAAL,EAAiBQ,CAAjB,CAAX;AACH;AACJ;;AAEM,SAASC,SAAT,CAAmBzC,EAAnB,EAAuBgC,UAAvB,EAAmCU,WAAnC,EAAgDC,yBAAyB,GAAG,EAA5E,EAAgF;AACnF,SAAOP,QAAQ,CAAC,MAAM;AAClB,QAAI,OAAOJ,UAAP,KAAsB,UAA1B,EAAsC;AAClC,aAAOA,UAAU,CAACY,IAAX,CAAgBF,WAAhB,CAAP;AACH;;AAED,WAAQ,IAAIG,QAAJ,CAAa,CAAC,OAAD,EAAU,GAAGX,MAAM,CAACY,IAAP,CAAYH,yBAAZ,CAAb,CAAb,EAAoE,wDAAuDX,UAAW,4BAAtI,CAAD,CACHU,WADG,EACU,GAAGR,MAAM,CAACa,MAAP,CAAcJ,yBAAd,CADb,CAAP;AAGH,GARc,EAQZ;AAAE3C,IAAAA,EAAF;AAAMgC,IAAAA;AAAN,GARY,CAAf;AASH;;AAEM,SAASgB,iBAAT,CAA2BhD,EAA3B,EAA+BgC,UAA/B,EAA2CU,WAA3C,EAAwDC,yBAAyB,GAAG,EAApF,EAAwF;AAC3F,SAAOP,QAAQ,CAAC,MAAM;AAClB,QAAI,OAAOJ,UAAP,KAAsB,UAA1B,EAAsC;AAClC,aAAOlD,OAAO,CAACC,OAAR,CAAgBiD,UAAU,CAACY,IAAX,CAAgBF,WAAhB,EAA6BC,yBAAyB,CAAC,QAAD,CAAtD,CAAhB,CAAP;AACH;;AAED,QAAIM,aAAa,GAAGJ,QAApB;AAEA;;AACII,IAAAA,aAAa,GAAGf,MAAM,CAACgB,cAAP,CAAsB,kBAAgB,CAAE,CAAxC,EAA0CC,WAA1D;AACJ;AAEA;AACA;;AACA,QAAIjB,MAAM,CAACY,IAAP,CAAYJ,WAAZ,EAAyB/C,QAAzB,CAAkCqC,UAAlC,CAAJ,EAAmD;AAC/C,UAAIoB,eAAe,GAAI,IAAIP,QAAJ,CAAa,CAAC,aAAD,EAAgB,GAAGX,MAAM,CAACY,IAAP,CAAYH,yBAAZ,CAAnB,CAAb,EAA0E,8BAA6BX,UAAW,IAAlH,CAAD,CAClBU,WADkB,EACL,GAAGR,MAAM,CAACa,MAAP,CAAcJ,yBAAd,CADE,CAAtB;;AAIA,UAAI,OAAOS,eAAP,KAA2B,UAA/B,EAA2C;AACvC,eAAOtE,OAAO,CAACC,OAAR,CAAgBqE,eAAe,CAACR,IAAhB,CAAqBF,WAArB,EAAkCC,yBAAyB,CAAC,QAAD,CAA3D,CAAhB,CAAP;AACH,OAFD,MAEO;AACH,eAAO7D,OAAO,CAACC,OAAR,EAAP;AACH;AACJ;;AAED,WAAOD,OAAO,CAACC,OAAR,CAAiB,IAAIkE,aAAJ,CAAkB,CAAC,aAAD,EAAgB,GAAGf,MAAM,CAACY,IAAP,CAAYH,yBAAZ,CAAnB,CAAlB,EAA+E,uBAAsBX,UAAW,IAAhH,CAAD,CACnBU,WADmB,EACN,GAAGR,MAAM,CAACa,MAAP,CAAcJ,yBAAd,CADG,CAAhB,CAAP;AAGH,GA5Bc,EA4BZ;AAAE3C,IAAAA,EAAF;AAAMgC,IAAAA;AAAN,GA5BY,CAAf;AA6BH;;AAED,MAAMqB,OAAO,GAAG,+EAAhB;;AAEO,SAASC,OAAT,CAAiBC,IAAjB,EAAuB;AAC1B,QAAMC,IAAI,GAAGC,mCAAmC,CAACF,IAAI,CAACC,IAAN,CAAhD;AAEA,SAAOH,OAAO,CAACK,IAAR,CAAaF,IAAb,CAAP;AACH;;AAEM,SAASG,SAAT,CAAmB3D,EAAnB,EAAuB4D,SAAvB,EAAkCC,IAAlC,EAAwC;AAC3C,MAAIC,UAAU,GAAGzE,KAAK,CAACC,IAAN,CAAWU,EAAE,CAAC+D,UAAd,EAA0BC,MAA1B,CAAiCV,OAAjC,EAA0CW,GAA1C,CAA8CC,kBAA9C,CAAjB,CAD2C,CAG3C;;AACA,MAAIC,eAAe,GAAGL,UAAU,CAACE,MAAX,CAAkB/D,SAAS,IAAIA,SAAS,CAAC4D,IAAV,KAAmB,QAAlD,EAA4D,CAA5D,CAAtB;;AAEA,MAAIM,eAAJ,EAAqB;AACjB,QAAIC,YAAY,GAAG3B,SAAS,CAACzC,EAAD,EAAKmE,eAAe,CAACnC,UAArB,EAAiC4B,SAAS,CAACS,KAA3C,CAA5B,CADiB,CAGjB;;AACAP,IAAAA,UAAU,GAAGA,UAAU,CAACQ,MAAX,CAAkBpC,MAAM,CAACqC,OAAP,CAAeH,YAAf,EAA6BH,GAA7B,CAAiC,CAAC,CAACT,IAAD,EAAOlB,KAAP,CAAD,KAAmB4B,kBAAkB,CAAC;AAAEV,MAAAA,IAAF;AAAQlB,MAAAA;AAAR,KAAD,CAAtE,CAAlB,CAAb;AACH;;AAED,MAAIuB,IAAJ,EAAU,OAAOC,UAAU,CAACE,MAAX,CAAkBQ,CAAC,IAAIA,CAAC,CAACX,IAAF,KAAWA,IAAlC,CAAP;AAEV,SAAOY,cAAc,CAACX,UAAD,CAArB;AACH;;AAED,SAASW,cAAT,CAAwBX,UAAxB,EAAoC;AAChC,MAAIY,cAAc,GAAG,CAAC,MAAD,EAAS,OAAT,EAAkB,MAAlB,EAA0B,WAA1B,CAArB;AAEA,SAAOZ,UAAU,CAACa,IAAX,CAAgB,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAC7B,QAAIC,KAAK,GAAGJ,cAAc,CAACK,OAAf,CAAuBH,CAAC,CAACf,IAAzB,MAAmC,CAAC,CAApC,GAAwC,WAAxC,GAAsDe,CAAC,CAACf,IAApE;AACA,QAAImB,KAAK,GAAGN,cAAc,CAACK,OAAf,CAAuBF,CAAC,CAAChB,IAAzB,MAAmC,CAAC,CAApC,GAAwC,WAAxC,GAAsDgB,CAAC,CAAChB,IAApE;AAEA,WAAOa,cAAc,CAACK,OAAf,CAAuBD,KAAvB,IAAgCJ,cAAc,CAACK,OAAf,CAAuBC,KAAvB,CAAvC;AACH,GALM,CAAP;AAMH;;AAEM,SAASd,kBAAT,CAA4B;AAAEV,EAAAA,IAAF;AAAQlB,EAAAA;AAAR,CAA5B,EAA6C;AAChD,QAAM2C,cAAc,GAAGxB,mCAAmC,CAACD,IAAD,CAA1D;AAEA,QAAM0B,SAAS,GAAGD,cAAc,CAACrE,KAAf,CAAqByC,OAArB,CAAlB;AACA,QAAM8B,UAAU,GAAGF,cAAc,CAACrE,KAAf,CAAqB,oBAArB,CAAnB;AACA,QAAMwE,SAAS,GAAGH,cAAc,CAACrE,KAAf,CAAqB,uBAArB,KAAiD,EAAnE;AAEA,SAAO;AACHiD,IAAAA,IAAI,EAAEqB,SAAS,GAAGA,SAAS,CAAC,CAAD,CAAZ,GAAkB,IAD9B;AAEH5C,IAAAA,KAAK,EAAE6C,UAAU,GAAGA,UAAU,CAAC,CAAD,CAAb,GAAmB,IAFjC;AAGHC,IAAAA,SAAS,EAAEA,SAAS,CAACnB,GAAV,CAAcO,CAAC,IAAIA,CAAC,CAAC9D,OAAF,CAAU,GAAV,EAAe,EAAf,CAAnB,CAHR;AAIHsB,IAAAA,UAAU,EAAEM;AAJT,GAAP;AAMH;;AAEM,SAAS+C,aAAT,CAAuBC,QAAvB,EAAiC;AACpC;AACA;AACA,QAAMC,iBAAiB,GAAG,CACtB,UADsB,EACX,SADW,EACD,UADC,EACU,UADV,EACqB,QADrB,EAC8B,MAD9B,EACsC,UADtC,EAEtB,WAFsB,EAET,WAFS,EAEI,UAFJ,EAEgB,YAFhB,EAE6B,iBAF7B,EAGtB,qBAHsB,EAGC,gBAHD,EAGmB,UAHnB,EAG+B,UAH/B,EAG2C,MAH3C,EAItB,OAJsB,EAIb,aAJa,EAIE,SAJF,EAIa,OAJb,EAIsB,UAJtB,EAIkC,OAJlC,EAI2C,OAJ3C,EAKtB,UALsB,CAA1B;AAQA,SAAOA,iBAAiB,CAAC5F,QAAlB,CAA2B2F,QAA3B,CAAP;AACH;;AAEM,SAAS7B,mCAAT,CAA6CD,IAA7C,EAAmD;AACtD,MAAIA,IAAI,CAACgC,UAAL,CAAgB,GAAhB,CAAJ,EAA0B;AACtB,WAAOhC,IAAI,CAAC9C,OAAL,CAAa,GAAb,EAAkB,SAAlB,CAAP;AACH,GAFD,MAEO,IAAI8C,IAAI,CAACgC,UAAL,CAAgB,GAAhB,CAAJ,EAA0B;AAC7B,WAAOhC,IAAI,CAAC9C,OAAL,CAAa,GAAb,EAAkB,WAAlB,CAAP;AACH;;AAED,SAAO8C,IAAP;AACH;;AAEM,SAASiC,yBAAT,CAAmCC,SAAnC,EAA8CC,QAAQ,GAAGC,OAAzD,EAAkE;AACrE,SAAOF,SAAS,CAACG,KAAV,CAAgB,GAAhB,EAAqB7B,MAArB,CAA4B2B,QAA5B,CAAP;AACH;;AAEM,MAAMG,kBAAkB,GAAG,IAA3B;;AACA,MAAMC,mBAAmB,GAAG,KAA5B;;AACA,MAAMC,oBAAoB,GAAG,WAA7B;;;AAEA,SAASC,YAAT,CAAsBjG,EAAtB,EAA0BkG,IAA1B,EAAgCC,MAAhC,EAAwCvC,SAAxC,EAAmDwC,SAAS,GAAG,KAA/D,EAAsE;AACzE;AACA,MAAIA,SAAJ,EAAe,OAAOF,IAAI,EAAX;;AAEf,MAAIlG,EAAE,CAACqG,gBAAH,IAAuBrG,EAAE,CAACqG,gBAAH,CAAoBxC,IAApB,KAA6BiC,kBAAxD,EAA4E;AACxE;AACA;AACA;AACH;;AAED,QAAMQ,KAAK,GAAG3C,SAAS,CAAC3D,EAAD,EAAK4D,SAAL,EAAgB,YAAhB,CAAvB;AACA,QAAM2C,QAAQ,GAAG5C,SAAS,CAAC3D,EAAD,EAAK4D,SAAL,EAAgB,MAAhB,CAAT,CAAiC,CAAjC,CAAjB,CAXyE,CAazE;;AACA,MAAI2C,QAAQ,IAAIA,QAAQ,CAACnB,SAAT,CAAmBzF,QAAnB,CAA4B,YAA5B,CAAhB,EAA2D;AACvD,QAAIyF,SAAS,GAAGmB,QAAQ,CAACnB,SAAzB,CADuD,CAGvD;;AACA,QAAIA,SAAS,CAACzF,QAAV,CAAmB,KAAnB,KAA6B,CAAEyF,SAAS,CAACzF,QAAV,CAAmB,IAAnB,CAAnC,EAA6D,OAAOuG,IAAI,EAAX;AAE7D,UAAMM,4BAA4B,GAAGpB,SAAS,CAACzF,QAAV,CAAmB,IAAnB,KAA4ByF,SAAS,CAACzF,QAAV,CAAmB,KAAnB,CAAjE,CANuD,CAQvD;;AACAyF,IAAAA,SAAS,GAAGoB,4BAA4B,GAClCpB,SAAS,CAACpB,MAAV,CAAiB,CAACQ,CAAD,EAAIiC,KAAJ,KAAcA,KAAK,GAAGrB,SAAS,CAACL,OAAV,CAAkB,KAAlB,CAAvC,CADkC,GACiCK,SADzE;AAGAsB,IAAAA,kBAAkB,CAAC1G,EAAD,EAAKoF,SAAL,EAAgBc,IAAhB,EAAsBC,MAAtB,CAAlB,CAZuD,CAa3D;AACC,GAdD,MAcO,IAAIG,KAAK,CAACK,IAAN,CAAWpD,IAAI,IAAI,CAAC,OAAD,EAAU,aAAV,EAAyB,WAAzB,EAAsC5D,QAAtC,CAA+C4D,IAAI,CAACjB,KAApD,CAAnB,CAAJ,EAAoF;AACvFsE,IAAAA,mBAAmB,CAAC5G,EAAD,EAAK4D,SAAL,EAAgB0C,KAAhB,EAAuBJ,IAAvB,EAA6BC,MAA7B,CAAnB;AACH,GAFM,MAEA;AACP;AACID,IAAAA,IAAI;AACP;AACJ;;AAEM,SAASW,aAAT,CAAuB7G,EAAvB,EAA2B8G,IAA3B,EAAiCX,MAAjC,EAAyCvC,SAAzC,EAAoDwC,SAAS,GAAG,KAAhE,EAAuE;AAC1E;AACA,MAAIA,SAAJ,EAAe,OAAOU,IAAI,EAAX;;AAEf,MAAI9G,EAAE,CAACqG,gBAAH,IAAuBrG,EAAE,CAACqG,gBAAH,CAAoBxC,IAApB,KAA6BkC,mBAAxD,EAA6E;AACzE;AACA;AACA;AACH;;AAED,QAAMO,KAAK,GAAG3C,SAAS,CAAC3D,EAAD,EAAK4D,SAAL,EAAgB,YAAhB,CAAvB;AACA,QAAM2C,QAAQ,GAAG5C,SAAS,CAAC3D,EAAD,EAAK4D,SAAL,EAAgB,MAAhB,CAAT,CAAiC,CAAjC,CAAjB;;AAEA,MAAI2C,QAAQ,IAAIA,QAAQ,CAACnB,SAAT,CAAmBzF,QAAnB,CAA4B,YAA5B,CAAhB,EAA2D;AACvD,QAAIyF,SAAS,GAAGmB,QAAQ,CAACnB,SAAzB;AAEA,QAAIA,SAAS,CAACzF,QAAV,CAAmB,IAAnB,KAA4B,CAAEyF,SAAS,CAACzF,QAAV,CAAmB,KAAnB,CAAlC,EAA6D,OAAOmH,IAAI,EAAX;AAE7D,UAAMN,4BAA4B,GAAGpB,SAAS,CAACzF,QAAV,CAAmB,IAAnB,KAA4ByF,SAAS,CAACzF,QAAV,CAAmB,KAAnB,CAAjE;AAEAyF,IAAAA,SAAS,GAAGoB,4BAA4B,GAClCpB,SAAS,CAACpB,MAAV,CAAiB,CAACQ,CAAD,EAAIiC,KAAJ,KAAcA,KAAK,GAAGrB,SAAS,CAACL,OAAV,CAAkB,KAAlB,CAAvC,CADkC,GACiCK,SADzE;AAGA2B,IAAAA,mBAAmB,CAAC/G,EAAD,EAAKoF,SAAL,EAAgBoB,4BAAhB,EAA8CM,IAA9C,EAAoDX,MAApD,CAAnB;AACH,GAXD,MAWO,IAAIG,KAAK,CAACK,IAAN,CAAWpD,IAAI,IAAI,CAAC,OAAD,EAAU,aAAV,EAAyB,WAAzB,EAAsC5D,QAAtC,CAA+C4D,IAAI,CAACjB,KAApD,CAAnB,CAAJ,EAAoF;AACvF0E,IAAAA,oBAAoB,CAAChH,EAAD,EAAK4D,SAAL,EAAgB0C,KAAhB,EAAuBQ,IAAvB,EAA6BX,MAA7B,CAApB;AACH,GAFM,MAEA;AACHW,IAAAA,IAAI;AACP;AACJ;;AAEM,SAASJ,kBAAT,CAA4B1G,EAA5B,EAAgCoF,SAAhC,EAA2C6B,YAA3C,EAAyDd,MAAzD,EAAiE;AACpE;AACA,QAAMe,WAAW,GAAG;AAChBC,IAAAA,QAAQ,EAAEC,aAAa,CAAChC,SAAD,EAAY,UAAZ,EAAwB,GAAxB,CADP;AAEhBiC,IAAAA,MAAM,EAAED,aAAa,CAAChC,SAAD,EAAY,QAAZ,EAAsB,QAAtB,CAFL;AAGhBkC,IAAAA,KAAK,EAAE;AACHC,MAAAA,OAAO,EAAE,CADN;AAEHC,MAAAA,KAAK,EAAEJ,aAAa,CAAChC,SAAD,EAAY,OAAZ,EAAqB,EAArB;AAFjB,KAHS;AAOhBqC,IAAAA,MAAM,EAAE;AACJF,MAAAA,OAAO,EAAE,CADL;AAEJC,MAAAA,KAAK,EAAE;AAFH;AAPQ,GAApB;AAaAE,EAAAA,gBAAgB,CAAC1H,EAAD,EAAKoF,SAAL,EAAgB6B,YAAhB,EAA8B,MAAM,CAAE,CAAtC,EAAwCd,MAAxC,EAAgDe,WAAhD,EAA6DpB,kBAA7D,CAAhB;AACH;;AAEM,SAASiB,mBAAT,CAA6B/G,EAA7B,EAAiCoF,SAAjC,EAA4CoB,4BAA5C,EAA0EmB,YAA1E,EAAwFxB,MAAxF,EAAgG;AACnG;AACA;AACA;AACA,QAAMgB,QAAQ,GAAGX,4BAA4B,GACvCY,aAAa,CAAChC,SAAD,EAAY,UAAZ,EAAwB,GAAxB,CAD0B,GAEvCgC,aAAa,CAAChC,SAAD,EAAY,UAAZ,EAAwB,GAAxB,CAAb,GAA4C,CAFlD;AAIA,QAAM8B,WAAW,GAAG;AAChBC,IAAAA,QAAQ,EAAEA,QADM;AAEhBE,IAAAA,MAAM,EAAED,aAAa,CAAChC,SAAD,EAAY,QAAZ,EAAsB,QAAtB,CAFL;AAGhBkC,IAAAA,KAAK,EAAE;AACHC,MAAAA,OAAO,EAAE,CADN;AAEHC,MAAAA,KAAK,EAAE;AAFJ,KAHS;AAOhBC,IAAAA,MAAM,EAAE;AACJF,MAAAA,OAAO,EAAE,CADL;AAEJC,MAAAA,KAAK,EAAEJ,aAAa,CAAChC,SAAD,EAAY,OAAZ,EAAqB,EAArB;AAFhB;AAPQ,GAApB;AAaAsC,EAAAA,gBAAgB,CAAC1H,EAAD,EAAKoF,SAAL,EAAgB,MAAM,CAAE,CAAxB,EAA0BuC,YAA1B,EAAwCxB,MAAxC,EAAgDe,WAAhD,EAA6DnB,mBAA7D,CAAhB;AACH;;AAED,SAASqB,aAAT,CAAuBhC,SAAvB,EAAkCwC,GAAlC,EAAuCC,QAAvC,EAAiD;AAC7C;AACA,MAAIzC,SAAS,CAACL,OAAV,CAAkB6C,GAAlB,MAA2B,CAAC,CAAhC,EAAmC,OAAOC,QAAP,CAFU,CAI7C;;AACA,QAAMC,QAAQ,GAAG1C,SAAS,CAACA,SAAS,CAACL,OAAV,CAAkB6C,GAAlB,IAAyB,CAA1B,CAA1B;AAEA,MAAI,CAAEE,QAAN,EAAgB,OAAOD,QAAP;;AAEhB,MAAID,GAAG,KAAK,OAAZ,EAAqB;AACjB;AACA;AACA;AACA,QAAI,CAAEG,SAAS,CAACD,QAAD,CAAf,EAA2B,OAAOD,QAAP;AAC9B;;AAED,MAAID,GAAG,KAAK,UAAZ,EAAwB;AACpB;AACA,QAAIhH,KAAK,GAAGkH,QAAQ,CAAClH,KAAT,CAAe,YAAf,CAAZ;AACA,QAAIA,KAAJ,EAAW,OAAOA,KAAK,CAAC,CAAD,CAAZ;AACd;;AAED,MAAIgH,GAAG,KAAK,QAAZ,EAAsB;AAClB;AACA,QAAI,CAAC,KAAD,EAAQ,OAAR,EAAiB,MAAjB,EAAyB,QAAzB,EAAmC,QAAnC,EAA6CjI,QAA7C,CAAsDyF,SAAS,CAACA,SAAS,CAACL,OAAV,CAAkB6C,GAAlB,IAAyB,CAA1B,CAA/D,CAAJ,EAAkG;AAC9F,aAAO,CAACE,QAAD,EAAW1C,SAAS,CAACA,SAAS,CAACL,OAAV,CAAkB6C,GAAlB,IAAyB,CAA1B,CAApB,EAAkDI,IAAlD,CAAuD,GAAvD,CAAP;AACH;AACJ;;AAED,SAAOF,QAAP;AACH;;AAEM,SAASJ,gBAAT,CAA0B1H,EAA1B,EAA8BoF,SAA9B,EAAyC6C,KAAzC,EAAgDC,KAAhD,EAAuD/B,MAAvD,EAA+De,WAA/D,EAA4ErD,IAA5E,EAAkF;AACrF;AACA,MAAI7D,EAAE,CAACqG,gBAAP,EAAyB;AACrBrG,IAAAA,EAAE,CAACqG,gBAAH,CAAoB8B,MAApB,IAA8BnI,EAAE,CAACqG,gBAAH,CAAoB8B,MAApB,EAA9B;AACH,GAJoF,CAMrF;;;AACA,QAAMC,YAAY,GAAGpI,EAAE,CAACqI,KAAH,CAASd,OAA9B;AACA,QAAMe,cAAc,GAAGtI,EAAE,CAACqI,KAAH,CAASE,SAAhC;AACA,QAAMC,oBAAoB,GAAGxI,EAAE,CAACqI,KAAH,CAASI,eAAtC,CATqF,CAWrF;;AACA,QAAMC,WAAW,GAAG,CAAEtD,SAAS,CAACzF,QAAV,CAAmB,SAAnB,CAAF,IAAmC,CAAEyF,SAAS,CAACzF,QAAV,CAAmB,OAAnB,CAAzD;AACA,QAAMgJ,iBAAiB,GAAGD,WAAW,IAAItD,SAAS,CAACzF,QAAV,CAAmB,SAAnB,CAAzC;AACA,QAAMiJ,eAAe,GAAGF,WAAW,IAAItD,SAAS,CAACzF,QAAV,CAAmB,OAAnB,CAAvC,CAdqF,CAgBrF;AACA;AACA;;AACA,QAAMkJ,MAAM,GAAG;AACXC,IAAAA,KAAK,GAAG;AACJ,UAAIH,iBAAJ,EAAuB3I,EAAE,CAACqI,KAAH,CAASd,OAAT,GAAmBL,WAAW,CAACI,KAAZ,CAAkBC,OAArC;AACvB,UAAIqB,eAAJ,EAAqB5I,EAAE,CAACqI,KAAH,CAASE,SAAT,GAAsB,SAAQrB,WAAW,CAACI,KAAZ,CAAkBE,KAAlB,GAA0B,GAAI,GAA5D;AACxB,KAJU;;AAKXuB,IAAAA,MAAM,GAAG;AACL,UAAIH,eAAJ,EAAqB5I,EAAE,CAACqI,KAAH,CAASI,eAAT,GAA2BvB,WAAW,CAACG,MAAvC;AACrBrH,MAAAA,EAAE,CAACqI,KAAH,CAASW,kBAAT,GAA8B,CAAEL,iBAAiB,GAAI,SAAJ,GAAgB,EAAnC,EAAwCC,eAAe,GAAI,WAAJ,GAAkB,EAAzE,EAA6EZ,IAA7E,CAAkF,GAAlF,EAAuFiB,IAAvF,EAA9B;AACAjJ,MAAAA,EAAE,CAACqI,KAAH,CAASa,kBAAT,GAA+B,GAAEhC,WAAW,CAACC,QAAZ,GAAuB,IAAK,GAA7D;AACAnH,MAAAA,EAAE,CAACqI,KAAH,CAASc,wBAAT,GAAqC,gCAArC;AACH,KAVU;;AAWXjD,IAAAA,IAAI,GAAG;AACH+B,MAAAA,KAAK;AACR,KAbU;;AAcXmB,IAAAA,GAAG,GAAG;AACF,UAAIT,iBAAJ,EAAuB3I,EAAE,CAACqI,KAAH,CAASd,OAAT,GAAmBL,WAAW,CAACO,MAAZ,CAAmBF,OAAtC;AACvB,UAAIqB,eAAJ,EAAqB5I,EAAE,CAACqI,KAAH,CAASE,SAAT,GAAsB,SAAQrB,WAAW,CAACO,MAAZ,CAAmBD,KAAnB,GAA2B,GAAI,GAA7D;AACxB,KAjBU;;AAkBXV,IAAAA,IAAI,GAAG;AACHoB,MAAAA,KAAK;AACR,KApBU;;AAqBXmB,IAAAA,OAAO,GAAG;AACN,UAAIV,iBAAJ,EAAuB3I,EAAE,CAACqI,KAAH,CAASd,OAAT,GAAmBa,YAAnB;AACvB,UAAIQ,eAAJ,EAAqB5I,EAAE,CAACqI,KAAH,CAASE,SAAT,GAAqBD,cAArB;AACrB,UAAIM,eAAJ,EAAqB5I,EAAE,CAACqI,KAAH,CAASI,eAAT,GAA2BD,oBAA3B;AACrBxI,MAAAA,EAAE,CAACqI,KAAH,CAASW,kBAAT,GAA8B,IAA9B;AACAhJ,MAAAA,EAAE,CAACqI,KAAH,CAASa,kBAAT,GAA8B,IAA9B;AACAlJ,MAAAA,EAAE,CAACqI,KAAH,CAASc,wBAAT,GAAoC,IAApC;AACH;;AA5BU,GAAf;AA+BAG,EAAAA,UAAU,CAACtJ,EAAD,EAAK6I,MAAL,EAAahF,IAAb,EAAmBsC,MAAnB,CAAV;AACH;;AAED,MAAMoD,sBAAsB,GAAG,CAACvH,UAAD,EAAahC,EAAb,EAAiB4D,SAAjB,KAA+B;AAC1D,SAAO,OAAO5B,UAAP,KAAsB,UAAtB,GACD4B,SAAS,CAAC4F,wBAAV,CAAmCxJ,EAAnC,EAAuCgC,UAAvC,CADC,GAEDA,UAFN;AAGH,CAJD;;AAMO,SAAS4E,mBAAT,CAA6B5G,EAA7B,EAAiC4D,SAAjC,EAA4CE,UAA5C,EAAwDmD,YAAxD,EAAsEd,MAAtE,EAA8E;AACjF,QAAMsD,KAAK,GAAGhE,yBAAyB,CAAC8D,sBAAsB,CAAC,CAACzF,UAAU,CAAC4F,IAAX,CAAgBlF,CAAC,IAAIA,CAAC,CAAClC,KAAF,KAAY,OAAjC,KAA6C;AAAEN,IAAAA,UAAU,EAAE;AAAd,GAA9C,EAAkEA,UAAnE,EAA+EhC,EAA/E,EAAmF4D,SAAnF,CAAvB,CAAvC;AACA,QAAM+F,UAAU,GAAGlE,yBAAyB,CAAC8D,sBAAsB,CAAC,CAACzF,UAAU,CAAC4F,IAAX,CAAgBlF,CAAC,IAAIA,CAAC,CAAClC,KAAF,KAAY,aAAjC,KAAmD;AAAEN,IAAAA,UAAU,EAAE;AAAd,GAApD,EAAwEA,UAAzE,EAAqFhC,EAArF,EAAyF4D,SAAzF,CAAvB,CAA5C;AACA,QAAMgG,QAAQ,GAAGnE,yBAAyB,CAAC8D,sBAAsB,CAAC,CAACzF,UAAU,CAAC4F,IAAX,CAAgBlF,CAAC,IAAIA,CAAC,CAAClC,KAAF,KAAY,WAAjC,KAAiD;AAAEN,IAAAA,UAAU,EAAE;AAAd,GAAlD,EAAsEA,UAAvE,EAAmFhC,EAAnF,EAAuF4D,SAAvF,CAAvB,CAA1C;AAEAiG,EAAAA,iBAAiB,CAAC7J,EAAD,EAAKyJ,KAAL,EAAYE,UAAZ,EAAwBC,QAAxB,EAAkC3C,YAAlC,EAAgD,MAAM,CAAE,CAAxD,EAA0DnB,kBAA1D,EAA8EK,MAA9E,CAAjB;AACH;;AAEM,SAASa,oBAAT,CAA8BhH,EAA9B,EAAkC4D,SAAlC,EAA6CE,UAA7C,EAAyD6D,YAAzD,EAAuExB,MAAvE,EAA+E;AAClF,QAAM2D,KAAK,GAAGrE,yBAAyB,CAAC8D,sBAAsB,CAAC,CAACzF,UAAU,CAAC4F,IAAX,CAAgBlF,CAAC,IAAIA,CAAC,CAAClC,KAAF,KAAY,OAAjC,KAA6C;AAAEN,IAAAA,UAAU,EAAE;AAAd,GAA9C,EAAkEA,UAAnE,EAA+EhC,EAA/E,EAAmF4D,SAAnF,CAAvB,CAAvC;AACA,QAAMmG,UAAU,GAAGtE,yBAAyB,CAAC8D,sBAAsB,CAAC,CAACzF,UAAU,CAAC4F,IAAX,CAAgBlF,CAAC,IAAIA,CAAC,CAAClC,KAAF,KAAY,aAAjC,KAAmD;AAAEN,IAAAA,UAAU,EAAE;AAAd,GAApD,EAAwEA,UAAzE,EAAqFhC,EAArF,EAAyF4D,SAAzF,CAAvB,CAA5C;AACA,QAAMoG,QAAQ,GAAGvE,yBAAyB,CAAC8D,sBAAsB,CAAC,CAACzF,UAAU,CAAC4F,IAAX,CAAgBlF,CAAC,IAAIA,CAAC,CAAClC,KAAF,KAAY,WAAjC,KAAiD;AAAEN,IAAAA,UAAU,EAAE;AAAd,GAAlD,EAAsEA,UAAvE,EAAmFhC,EAAnF,EAAuF4D,SAAvF,CAAvB,CAA1C;AAEAiG,EAAAA,iBAAiB,CAAC7J,EAAD,EAAK8J,KAAL,EAAYC,UAAZ,EAAwBC,QAAxB,EAAkC,MAAM,CAAE,CAA1C,EAA4CrC,YAA5C,EAA0D5B,mBAA1D,EAA+EI,MAA/E,CAAjB;AACH;;AAEM,SAAS0D,iBAAT,CAA2B7J,EAA3B,EAA+BiK,aAA/B,EAA8CC,YAA9C,EAA4DC,UAA5D,EAAwElC,KAAxE,EAA+EC,KAA/E,EAAsFrE,IAAtF,EAA4FsC,MAA5F,EAAoG;AACvG;AACA,MAAInG,EAAE,CAACqG,gBAAP,EAAyB;AACrBrG,IAAAA,EAAE,CAACqG,gBAAH,CAAoB8B,MAApB,IAA8BnI,EAAE,CAACqG,gBAAH,CAAoB8B,MAApB,EAA9B;AACH;;AAED,QAAMiC,eAAe,GAAGpK,EAAE,CAACqK,sBAAH,IAA6B,EAArD;AAEA,QAAMxB,MAAM,GAAG;AACXC,IAAAA,KAAK,GAAG;AACJ9I,MAAAA,EAAE,CAAC0F,SAAH,CAAa4E,GAAb,CAAiB,GAAGJ,YAApB;AACH,KAHU;;AAIXnB,IAAAA,MAAM,GAAG;AACL/I,MAAAA,EAAE,CAAC0F,SAAH,CAAa4E,GAAb,CAAiB,GAAGL,aAApB;AACH,KANU;;AAOX/D,IAAAA,IAAI,GAAG;AACH+B,MAAAA,KAAK;AACR,KATU;;AAUXmB,IAAAA,GAAG,GAAG;AACF;AACApJ,MAAAA,EAAE,CAAC0F,SAAH,CAAa6E,MAAb,CAAoB,GAAGL,YAAY,CAAClG,MAAb,CAAoBQ,CAAC,IAAI,CAAC4F,eAAe,CAACzK,QAAhB,CAAyB6E,CAAzB,CAA1B,CAAvB;AACAxE,MAAAA,EAAE,CAAC0F,SAAH,CAAa4E,GAAb,CAAiB,GAAGH,UAApB;AACH,KAdU;;AAeXrD,IAAAA,IAAI,GAAG;AACHoB,MAAAA,KAAK;AACR,KAjBU;;AAkBXmB,IAAAA,OAAO,GAAG;AACNrJ,MAAAA,EAAE,CAAC0F,SAAH,CAAa6E,MAAb,CAAoB,GAAGN,aAAa,CAACjG,MAAd,CAAqBQ,CAAC,IAAI,CAAC4F,eAAe,CAACzK,QAAhB,CAAyB6E,CAAzB,CAA3B,CAAvB;AACAxE,MAAAA,EAAE,CAAC0F,SAAH,CAAa6E,MAAb,CAAoB,GAAGJ,UAAU,CAACnG,MAAX,CAAkBQ,CAAC,IAAI,CAAC4F,eAAe,CAACzK,QAAhB,CAAyB6E,CAAzB,CAAxB,CAAvB;AACH;;AArBU,GAAf;AAwBA8E,EAAAA,UAAU,CAACtJ,EAAD,EAAK6I,MAAL,EAAahF,IAAb,EAAmBsC,MAAnB,CAAV;AACH;;AAEM,SAASmD,UAAT,CAAoBtJ,EAApB,EAAwB6I,MAAxB,EAAgChF,IAAhC,EAAsCsC,MAAtC,EAA8C;AACjD,QAAMqE,MAAM,GAAGC,IAAI,CAAC,MAAM;AACtB5B,IAAAA,MAAM,CAAC/B,IAAP,GADsB,CAGtB;AACA;;AACA,QAAI9G,EAAE,CAAC0K,WAAP,EAAoB;AAChB7B,MAAAA,MAAM,CAACQ,OAAP;AACH;;AAED,WAAOrJ,EAAE,CAACqG,gBAAV;AACH,GAVkB,CAAnB;AAYArG,EAAAA,EAAE,CAACqG,gBAAH,GAAsB;AAClB;AACDxC,IAAAA,IAAI,EAAEA,IAFa;AAGlB;AACA;AACA;AACAsE,IAAAA,MAAM,EAAEsC,IAAI,CAAC,MAAM;AACftE,MAAAA,MAAM,CAACH,oBAAD,CAAN;AAEAwE,MAAAA,MAAM;AACT,KAJW,CANM;AAWlBA,IAAAA,MAXkB;AAYlB;AACAG,IAAAA,SAAS,EAAE;AAbO,GAAtB;AAgBA9B,EAAAA,MAAM,CAACC,KAAP;AACAD,EAAAA,MAAM,CAACE,MAAP;AAEA/I,EAAAA,EAAE,CAACqG,gBAAH,CAAoBsE,SAApB,GAAgCC,qBAAqB,CAAC,MAAM;AACxD;AACA;AACA,QAAIzD,QAAQ,GAAG0D,MAAM,CAACC,gBAAgB,CAAC9K,EAAD,CAAhB,CAAqBkJ,kBAArB,CAAwCxI,OAAxC,CAAgD,KAAhD,EAAuD,EAAvD,EAA2DA,OAA3D,CAAmE,GAAnE,EAAwE,EAAxE,CAAD,CAAN,GAAsF,IAArG;;AAEA,QAAIyG,QAAQ,KAAK,CAAjB,EAAoB;AAChBA,MAAAA,QAAQ,GAAG0D,MAAM,CAACC,gBAAgB,CAAC9K,EAAD,CAAhB,CAAqB+K,iBAArB,CAAuCrK,OAAvC,CAA+C,GAA/C,EAAoD,EAApD,CAAD,CAAN,GAAkE,IAA7E;AACH;;AAEDmI,IAAAA,MAAM,CAAC3C,IAAP;AAEAlG,IAAAA,EAAE,CAACqG,gBAAH,CAAoBsE,SAApB,GAAgCC,qBAAqB,CAAC,MAAM;AACxD/B,MAAAA,MAAM,CAACO,GAAP;AAEAtH,MAAAA,UAAU,CAAC9B,EAAE,CAACqG,gBAAH,CAAoBmE,MAArB,EAA6BrD,QAA7B,CAAV;AACH,KAJoD,CAArD;AAKH,GAhBoD,CAArD;AAiBH;;AAEM,SAASY,SAAT,CAAmBtH,OAAnB,EAA2B;AAC9B,SAAO,CAAEpB,KAAK,CAAC2L,OAAN,CAAcvK,OAAd,CAAF,IAA4B,CAAEwK,KAAK,CAACxK,OAAD,CAA1C;AACH,EAED;AACA;;;AACO,SAASgK,IAAT,CAAczJ,QAAd,EAAwB;AAC3B,MAAIkK,MAAM,GAAG,KAAb;AAEA,SAAO,YAAY;AACf,QAAI,CAAEA,MAAN,EAAc;AACVA,MAAAA,MAAM,GAAG,IAAT;AACAlK,MAAAA,QAAQ,CAACY,KAAT,CAAe,IAAf,EAAqBF,SAArB;AACH;AACJ,GALD;AAMH;;;;;;;;;ACphBD;;AAEO,SAASyJ,kBAAT,CAA4BvH,SAA5B,EAAuCwH,UAAvC,EAAmDpJ,UAAnD,EAA+DqJ,aAA/D,EAA8EC,SAA9E,EAAyF;AAC5F,sCAAwBF,UAAxB,EAAoC,SAApC;AAEA,MAAIG,aAAa,GAAG,OAAOvJ,UAAP,KAAsB,UAAtB,GACdwJ,kBAAkB,CAAC5H,SAAS,CAAC4F,wBAAV,CAAmC4B,UAAnC,EAA+CpJ,UAA/C,CAAD,CADJ,GAEdwJ,kBAAkB,CAACxJ,UAAD,CAFxB;AAIA,MAAIyJ,KAAK,GAAGC,0DAA0D,CAAC9H,SAAD,EAAYwH,UAAZ,EAAwBG,aAAxB,EAAuCD,SAAvC,CAAtE,CAP4F,CAS5F;;AACA,MAAIK,SAAS,GAAGP,UAAhB;AACAK,EAAAA,KAAK,CAACG,OAAN,CAAc,CAACC,IAAD,EAAOpF,KAAP,KAAiB;AAC3B,QAAIqF,uBAAuB,GAAGC,0BAA0B,CAACR,aAAD,EAAgBM,IAAhB,EAAsBpF,KAAtB,EAA6BgF,KAA7B,EAAoCH,SAAS,EAA7C,CAAxD;AACA,QAAIU,UAAU,GAAGC,uBAAuB,CAACrI,SAAD,EAAYwH,UAAZ,EAAwB3E,KAAxB,EAA+BqF,uBAA/B,CAAxC;AACA,QAAII,MAAM,GAAGC,gDAAgD,CAACR,SAAS,CAACxK,kBAAX,EAA+B6K,UAA/B,CAA7D,CAH2B,CAK3B;;AACA,QAAI,CAAEE,MAAN,EAAc;AACVA,MAAAA,MAAM,GAAGE,8BAA8B,CAAChB,UAAD,EAAaO,SAAb,CAAvC,CADU,CAGV;;AACA,+BAAaO,MAAb,EAAqB,MAAM,CAAE,CAA7B,EAA+B,MAAM,CAAE,CAAvC,EAAyCtI,SAAzC,EAAoDyH,aAApD;AAEAa,MAAAA,MAAM,CAACG,SAAP,GAAmBP,uBAAnB;AACAlI,MAAAA,SAAS,CAAC0I,kBAAV,CAA6BJ,MAA7B,EAAqC,MAAMA,MAAM,CAACG,SAAlD,EAPU,CAQd;AACC,KATD,MASO;AACH;AACA,aAAOH,MAAM,CAACK,aAAd;AAEAL,MAAAA,MAAM,CAACG,SAAP,GAAmBP,uBAAnB;AACAlI,MAAAA,SAAS,CAAC4I,cAAV,CAAyBN,MAAzB,EAAiC,MAAMA,MAAM,CAACG,SAA9C;AACH;;AAEDV,IAAAA,SAAS,GAAGO,MAAZ;AACAP,IAAAA,SAAS,CAACY,aAAV,GAA0BP,UAA1B;AACH,GAzBD;AA2BAS,EAAAA,2CAA2C,CAACd,SAAD,EAAY/H,SAAZ,CAA3C;AACH,EAED;;;AACA,SAAS4H,kBAAT,CAA4BxJ,UAA5B,EAAwC;AACpC,MAAI0K,aAAa,GAAG,gCAApB;AACA,MAAIC,aAAa,GAAG,UAApB;AACA,MAAIC,UAAU,GAAG,oCAAjB;AACA,MAAIC,OAAO,GAAGC,MAAM,CAAC9K,UAAD,CAAN,CAAmBpB,KAAnB,CAAyBgM,UAAzB,CAAd;AACA,MAAI,CAAEC,OAAN,EAAe;AACf,MAAIE,GAAG,GAAG,EAAV;AACAA,EAAAA,GAAG,CAACtB,KAAJ,GAAYoB,OAAO,CAAC,CAAD,CAAP,CAAW5D,IAAX,EAAZ;AACA,MAAI4C,IAAI,GAAGgB,OAAO,CAAC,CAAD,CAAP,CAAW5D,IAAX,GAAkBvI,OAAlB,CAA0BiM,aAA1B,EAAyC,EAAzC,CAAX;AACA,MAAIK,aAAa,GAAGnB,IAAI,CAACjL,KAAL,CAAW8L,aAAX,CAApB;;AAEA,MAAIM,aAAJ,EAAmB;AACfD,IAAAA,GAAG,CAAClB,IAAJ,GAAWA,IAAI,CAACnL,OAAL,CAAagM,aAAb,EAA4B,EAA5B,EAAgCzD,IAAhC,EAAX;AACA8D,IAAAA,GAAG,CAACtG,KAAJ,GAAYuG,aAAa,CAAC,CAAD,CAAb,CAAiB/D,IAAjB,EAAZ;;AAEA,QAAI+D,aAAa,CAAC,CAAD,CAAjB,EAAsB;AAClBD,MAAAA,GAAG,CAACE,UAAJ,GAAiBD,aAAa,CAAC,CAAD,CAAb,CAAiB/D,IAAjB,EAAjB;AACH;AACJ,GAPD,MAOO;AACH8D,IAAAA,GAAG,CAAClB,IAAJ,GAAWA,IAAX;AACH;;AACD,SAAOkB,GAAP;AACH;;AAED,SAAShB,0BAAT,CAAoCR,aAApC,EAAmDM,IAAnD,EAAyDpF,KAAzD,EAAgEgF,KAAhE,EAAuEH,SAAvE,EAAkF;AAC9E;AACA,MAAI4B,cAAc,GAAG5B,SAAS,GAAG,EAAC,GAAGA;AAAJ,GAAH,GAAoB,EAAlD;AACA4B,EAAAA,cAAc,CAAC3B,aAAa,CAACM,IAAf,CAAd,GAAqCA,IAArC;AACA,MAAIN,aAAa,CAAC9E,KAAlB,EAAyByG,cAAc,CAAC3B,aAAa,CAAC9E,KAAf,CAAd,GAAsCA,KAAtC;AACzB,MAAI8E,aAAa,CAAC0B,UAAlB,EAA8BC,cAAc,CAAC3B,aAAa,CAAC0B,UAAf,CAAd,GAA2CxB,KAA3C;AAE9B,SAAOyB,cAAP;AACH;;AAED,SAASjB,uBAAT,CAAiCrI,SAAjC,EAA4C5D,EAA5C,EAAgDyG,KAAhD,EAAuDqF,uBAAvD,EAAgF;AAC5E,MAAIqB,gBAAgB,GAAG,sBAAUnN,EAAV,EAAc4D,SAAd,EAAyB,MAAzB,EAAiCI,MAAjC,CAAwCT,IAAI,IAAIA,IAAI,CAACjB,KAAL,KAAe,KAA/D,EAAsE,CAAtE,CAAvB,CAD4E,CAG5E;;AACA,MAAI,CAAE6K,gBAAN,EAAwB,OAAO1G,KAAP;AAExB,SAAO7C,SAAS,CAAC4F,wBAAV,CAAmCxJ,EAAnC,EAAuCmN,gBAAgB,CAACnL,UAAxD,EAAoE,MAAM8J,uBAA1E,CAAP;AACH;;AAED,SAASJ,0DAAT,CAAoE9H,SAApE,EAA+E5D,EAA/E,EAAmFuL,aAAnF,EAAkGD,SAAlG,EAA6G;AACzG,MAAI8B,WAAW,GAAG,sBAAUpN,EAAV,EAAc4D,SAAd,EAAyB,IAAzB,EAA+B,CAA/B,CAAlB;;AAEA,MAAIwJ,WAAW,IAAI,CAAExJ,SAAS,CAAC4F,wBAAV,CAAmCxJ,EAAnC,EAAuCoN,WAAW,CAACpL,UAAnD,CAArB,EAAqF;AACjF,WAAO,EAAP;AACH;;AAED,MAAIyJ,KAAK,GAAG7H,SAAS,CAAC4F,wBAAV,CAAmCxJ,EAAnC,EAAuCuL,aAAa,CAACE,KAArD,EAA4DH,SAA5D,CAAZ,CAPyG,CASzG;;AACA,MAAI,sBAAUG,KAAV,KAAoBA,KAAK,IAAI,CAAjC,EAAoC;AAChCA,IAAAA,KAAK,GAAGpM,KAAK,CAACC,IAAN,CAAWD,KAAK,CAACoM,KAAD,CAAL,CAAa3I,IAAb,EAAX,EAAgC0B,CAAC,IAAIA,CAAC,GAAG,CAAzC,CAAR;AACH;;AAED,SAAOiH,KAAP;AACH;;AAED,SAASW,8BAAT,CAAwChB,UAAxC,EAAoDO,SAApD,EAA+D;AAC3D,MAAI0B,KAAK,GAAGrO,QAAQ,CAACsO,UAAT,CAAoBlC,UAAU,CAAC9K,OAA/B,EAAwC,IAAxC,CAAZ;AAEAqL,EAAAA,SAAS,CAAC4B,aAAV,CAAwBC,YAAxB,CAAqCH,KAArC,EAA4C1B,SAAS,CAACxK,kBAAtD;AAEA,SAAOwK,SAAS,CAACxK,kBAAjB;AACH;;AAED,SAASgL,gDAAT,CAA0DD,MAA1D,EAAkEF,UAAlE,EAA8E;AAC1E,MAAI,CAAEE,MAAN,EAAc,OAD4D,CAG1E;;AACA,MAAIA,MAAM,CAACK,aAAP,KAAyBkB,SAA7B,EAAwC,OAJkC,CAM1E;;AACA,MAAIvB,MAAM,CAACK,aAAP,KAAyBP,UAA7B,EAAyC,OAAOE,MAAP,CAPiC,CAS1E;AACA;;AACA,MAAIwB,SAAS,GAAGxB,MAAhB;;AAEA,SAAMwB,SAAN,EAAiB;AACb,QAAIA,SAAS,CAACnB,aAAV,KAA4BP,UAAhC,EAA4C;AACxC,aAAO0B,SAAS,CAACH,aAAV,CAAwBC,YAAxB,CAAqCE,SAArC,EAAgDxB,MAAhD,CAAP;AACH;;AAEDwB,IAAAA,SAAS,GAAIA,SAAS,CAACvM,kBAAV,IAAgCuM,SAAS,CAACvM,kBAAV,CAA6BoL,aAA7B,KAA+CkB,SAAhF,GAA6FC,SAAS,CAACvM,kBAAvG,GAA4H,KAAxI;AACH;AACJ;;AAED,SAASsL,2CAAT,CAAqDd,SAArD,EAAgE/H,SAAhE,EAA2E;AACvE,MAAI+J,sBAAsB,GAAIhC,SAAS,CAACxK,kBAAV,IAAgCwK,SAAS,CAACxK,kBAAV,CAA6BoL,aAA7B,KAA+CkB,SAAhF,GAA6F9B,SAAS,CAACxK,kBAAvG,GAA4H,KAAzJ;;AAEA,SAAOwM,sBAAP,EAA+B;AAC3B,QAAIC,+BAA+B,GAAGD,sBAAtC;AACA,QAAIE,WAAW,GAAGF,sBAAsB,CAACxM,kBAAzC;AACA,8BAAcwM,sBAAd,EAAsC,MAAM;AACxCC,MAAAA,+BAA+B,CAACrD,MAAhC;AACH,KAFD,EAEG,MAAM,CAAE,CAFX,EAEa3G,SAFb;AAGA+J,IAAAA,sBAAsB,GAAIE,WAAW,IAAIA,WAAW,CAACtB,aAAZ,KAA8BkB,SAA9C,GAA2DI,WAA3D,GAAyE,KAAlG;AACH;AACJ;;;;;;;;;ACjJD;;AACA;;;;AAEO,SAASC,+BAAT,CAAyClK,SAAzC,EAAoD5D,EAApD,EAAwDsF,QAAxD,EAAkEtD,UAAlE,EAA8EsJ,SAA9E,EAAyFyC,QAAzF,EAAmG3I,SAAnG,EAA8G;AACjH,MAAI9C,KAAK,GAAGsB,SAAS,CAAC4F,wBAAV,CAAmCxJ,EAAnC,EAAuCgC,UAAvC,EAAmDsJ,SAAnD,CAAZ;;AAEA,MAAIhG,QAAQ,KAAK,OAAjB,EAA0B;AACtB,QAAI0I,eAAOC,4BAAP,IAAuCjP,QAAQ,CAACkP,aAAT,CAAuBC,UAAvB,CAAkCnO,EAAlC,CAA3C,EAAkF,OAD5D,CAGtB;;AACA,QAAIsC,KAAK,KAAKmL,SAAV,IAAuBX,MAAM,CAAC9K,UAAD,CAAN,CAAmBpB,KAAnB,CAAyB,IAAzB,CAA3B,EAA2D;AACvD0B,MAAAA,KAAK,GAAG,EAAR;AACH;;AAED,QAAItC,EAAE,CAAC6D,IAAH,KAAY,OAAhB,EAAyB;AACrB;AACA;AACA;AACA,UAAI7D,EAAE,CAAC+D,UAAH,CAAczB,KAAd,KAAwBmL,SAAxB,IAAqCM,QAAQ,KAAK,MAAtD,EAA8D;AAC1D/N,QAAAA,EAAE,CAACsC,KAAH,GAAWA,KAAX;AACH,OAFD,MAEO,IAAIyL,QAAQ,KAAK,MAAjB,EAAyB;AAC5B/N,QAAAA,EAAE,CAACoO,OAAH,GAAa,oCAAwBpO,EAAE,CAACsC,KAA3B,EAAkCA,KAAlC,CAAb;AACH;AACJ,KATD,MASO,IAAItC,EAAE,CAAC6D,IAAH,KAAY,UAAhB,EAA4B;AAC/B;AACA;AACA;AACA,UAAI,OAAOvB,KAAP,KAAiB,SAAjB,IAA8B,CAAE,CAAC,IAAD,EAAOmL,SAAP,EAAkB9N,QAAlB,CAA2B2C,KAA3B,CAAhC,IAAqEyL,QAAQ,KAAK,MAAtF,EAA8F;AAC1F/N,QAAAA,EAAE,CAACsC,KAAH,GAAWwK,MAAM,CAACxK,KAAD,CAAjB;AACH,OAFD,MAEO,IAAIyL,QAAQ,KAAK,MAAjB,EAAyB;AAC5B,YAAI1O,KAAK,CAAC2L,OAAN,CAAc1I,KAAd,CAAJ,EAA0B;AACtB;AACA;AACA;AACAtC,UAAAA,EAAE,CAACoO,OAAH,GAAa9L,KAAK,CAACqE,IAAN,CAAW0H,GAAG,IAAI,oCAAwBA,GAAxB,EAA6BrO,EAAE,CAACsC,KAAhC,CAAlB,CAAb;AACH,SALD,MAKO;AACHtC,UAAAA,EAAE,CAACoO,OAAH,GAAa,CAAC,CAAC9L,KAAf;AACH;AACJ;AACJ,KAhBM,MAgBA,IAAItC,EAAE,CAACE,OAAH,KAAe,QAAnB,EAA6B;AAChCoO,MAAAA,YAAY,CAACtO,EAAD,EAAKsC,KAAL,CAAZ;AACH,KAFM,MAEA;AACH,UAAItC,EAAE,CAACsC,KAAH,KAAaA,KAAjB,EAAwB;AAExBtC,MAAAA,EAAE,CAACsC,KAAH,GAAWA,KAAX;AACH;AACJ,GAxCD,MAwCO,IAAIgD,QAAQ,KAAK,OAAjB,EAA0B;AAC7B,QAAIjG,KAAK,CAAC2L,OAAN,CAAc1I,KAAd,CAAJ,EAA0B;AACtB,YAAM8H,eAAe,GAAGpK,EAAE,CAACqK,sBAAH,IAA6B,EAArD;AACArK,MAAAA,EAAE,CAACuO,YAAH,CAAgB,OAAhB,EAAyB,wBAAYnE,eAAe,CAAC9F,MAAhB,CAAuBhC,KAAvB,CAAZ,EAA2C0F,IAA3C,CAAgD,GAAhD,CAAzB;AACH,KAHD,MAGO,IAAI,OAAO1F,KAAP,KAAiB,QAArB,EAA+B;AAClC;AACA;AACA,YAAMkM,wBAAwB,GAAGtM,MAAM,CAACY,IAAP,CAAYR,KAAZ,EAAmBqC,IAAnB,CAAwB,CAACC,CAAD,EAAIC,CAAJ,KAAUvC,KAAK,CAACsC,CAAD,CAAL,GAAWtC,KAAK,CAACuC,CAAD,CAAlD,CAAjC;AAEA2J,MAAAA,wBAAwB,CAAC5C,OAAzB,CAAiC6C,UAAU,IAAI;AAC3C,YAAInM,KAAK,CAACmM,UAAD,CAAT,EAAuB;AACnB,gDAA0BA,UAA1B,EAAsC7C,OAAtC,CAA8C8C,SAAS,IAAI1O,EAAE,CAAC0F,SAAH,CAAa4E,GAAb,CAAiBoE,SAAjB,CAA3D;AACH,SAFD,MAEO;AACH,gDAA0BD,UAA1B,EAAsC7C,OAAtC,CAA8C8C,SAAS,IAAI1O,EAAE,CAAC0F,SAAH,CAAa6E,MAAb,CAAoBmE,SAApB,CAA3D;AACH;AACJ,OAND;AAOH,KAZM,MAYA;AACH,YAAMtE,eAAe,GAAGpK,EAAE,CAACqK,sBAAH,IAA6B,EAArD;AACA,YAAMsE,UAAU,GAAGrM,KAAK,GAAG,sCAA0BA,KAA1B,CAAH,GAAsC,EAA9D;AACAtC,MAAAA,EAAE,CAACuO,YAAH,CAAgB,OAAhB,EAAyB,wBAAYnE,eAAe,CAAC9F,MAAhB,CAAuBqK,UAAvB,CAAZ,EAAgD3G,IAAhD,CAAqD,GAArD,CAAzB;AACH;AACJ,GArBM,MAqBA;AACH1C,IAAAA,QAAQ,GAAGF,SAAS,CAACzF,QAAV,CAAmB,OAAnB,IAA8B,sBAAU2F,QAAV,CAA9B,GAAoDA,QAA/D,CADG,CAGH;;AACA,QAAI,CAAC,IAAD,EAAOmI,SAAP,EAAkB,KAAlB,EAAyB9N,QAAzB,CAAkC2C,KAAlC,CAAJ,EAA8C;AAC1CtC,MAAAA,EAAE,CAAC4O,eAAH,CAAmBtJ,QAAnB;AACH,KAFD,MAEO;AACH,gCAAcA,QAAd,IAA0BuJ,YAAY,CAAC7O,EAAD,EAAKsF,QAAL,EAAeA,QAAf,CAAtC,GAAiEuJ,YAAY,CAAC7O,EAAD,EAAKsF,QAAL,EAAehD,KAAf,CAA7E;AACH;AACJ;AACJ;;AAED,SAASuM,YAAT,CAAsB7O,EAAtB,EAA0BsF,QAA1B,EAAoChD,KAApC,EAA2C;AACvC,MAAItC,EAAE,CAAC8O,YAAH,CAAgBxJ,QAAhB,KAA6BhD,KAAjC,EAAwC;AACpCtC,IAAAA,EAAE,CAACuO,YAAH,CAAgBjJ,QAAhB,EAA0BhD,KAA1B;AACH;AACJ;;AAED,SAASgM,YAAT,CAAsBtO,EAAtB,EAA0BsC,KAA1B,EAAiC;AAC7B,QAAMyM,iBAAiB,GAAG,GAAGzK,MAAH,CAAUhC,KAAV,EAAiB2B,GAAjB,CAAqB3B,KAAK,IAAI;AAAE,WAAOA,KAAK,GAAG,EAAf;AAAmB,GAAnD,CAA1B;AAEAjD,EAAAA,KAAK,CAACC,IAAN,CAAWU,EAAE,CAACgP,OAAd,EAAuBpD,OAAvB,CAA+BqD,MAAM,IAAI;AACrCA,IAAAA,MAAM,CAACC,QAAP,GAAkBH,iBAAiB,CAACpP,QAAlB,CAA2BsP,MAAM,CAAC3M,KAAP,IAAgB2M,MAAM,CAACE,IAAlD,CAAlB;AACH,GAFD;AAGH;;;;;;;;;AC3FM,SAASC,mBAAT,CAA6BpP,EAA7B,EAAiCqP,MAAjC,EAAyCrN,UAAzC,EAAqD;AACxD;AACA,MAAIqN,MAAM,KAAK5B,SAAX,IAAwBX,MAAM,CAAC9K,UAAD,CAAN,CAAmBpB,KAAnB,CAAyB,IAAzB,CAA5B,EAA4D;AACxDyO,IAAAA,MAAM,GAAG,EAAT;AACH;;AAEDrP,EAAAA,EAAE,CAACsP,WAAH,GAAiBD,MAAjB;AACH;;;;;;;;;ACPM,SAASE,mBAAT,CAA6B3L,SAA7B,EAAwC5D,EAAxC,EAA4CgC,UAA5C,EAAwDsJ,SAAxD,EAAmE;AACtEtL,EAAAA,EAAE,CAACwP,SAAH,GAAe5L,SAAS,CAAC4F,wBAAV,CAAmCxJ,EAAnC,EAAuCgC,UAAvC,EAAmDsJ,SAAnD,CAAf;AACH;;;;;;;;;ACFD;;AAEO,SAASmE,mBAAT,CAA6B7L,SAA7B,EAAwC5D,EAAxC,EAA4CsC,KAA5C,EAAmD8C,SAAnD,EAA8DiG,aAAa,GAAG,KAA9E,EAAqF;AACxF,QAAMvE,IAAI,GAAG,MAAM;AACf9G,IAAAA,EAAE,CAACqI,KAAH,CAASqH,OAAT,GAAmB,MAAnB;AACA1P,IAAAA,EAAE,CAAC2P,cAAH,GAAoB,KAApB;AACH,GAHD;;AAKA,QAAMzJ,IAAI,GAAG,MAAM;AACf,QAAIlG,EAAE,CAACqI,KAAH,CAASuH,MAAT,KAAoB,CAApB,IAAyB5P,EAAE,CAACqI,KAAH,CAASqH,OAAT,KAAqB,MAAlD,EAA0D;AACtD1P,MAAAA,EAAE,CAAC4O,eAAH,CAAmB,OAAnB;AACH,KAFD,MAEO;AACH5O,MAAAA,EAAE,CAACqI,KAAH,CAASwH,cAAT,CAAwB,SAAxB;AACH;;AAED7P,IAAAA,EAAE,CAAC2P,cAAH,GAAoB,IAApB;AACH,GARD;;AAUA,MAAItE,aAAa,KAAK,IAAtB,EAA4B;AACxB,QAAI/I,KAAJ,EAAW;AACP4D,MAAAA,IAAI;AACP,KAFD,MAEO;AACHY,MAAAA,IAAI;AACP;;AACD;AACH;;AAED,QAAMgJ,MAAM,GAAG,CAAC/Q,OAAD,EAAUoH,MAAV,KAAqB;AAChC,QAAI7D,KAAJ,EAAW;AACP,UAAItC,EAAE,CAACqI,KAAH,CAASqH,OAAT,KAAqB,MAArB,IAA+B1P,EAAE,CAACqG,gBAAtC,EAAwD;AACpD,iCAAarG,EAAb,EAAiB,MAAM;AACnBkG,UAAAA,IAAI;AACP,SAFD,EAEGC,MAFH,EAEWvC,SAFX;AAGH;;AACD7E,MAAAA,OAAO,CAAC,MAAM,CAAE,CAAT,CAAP;AACH,KAPD,MAOO;AACH,UAAIiB,EAAE,CAACqI,KAAH,CAASqH,OAAT,KAAqB,MAAzB,EAAiC;AAC7B,kCAAc1P,EAAd,EAAkB,MAAM;AACpBjB,UAAAA,OAAO,CAAC,MAAM;AACV+H,YAAAA,IAAI;AACP,WAFM,CAAP;AAGH,SAJD,EAIGX,MAJH,EAIWvC,SAJX;AAKH,OAND,MAMO;AACH7E,QAAAA,OAAO,CAAC,MAAM,CAAE,CAAT,CAAP;AACH;AACJ;AACJ,GAnBD,CAzBwF,CA8CxF;AACA;AACA;AAEA;;;AACA,MAAIqG,SAAS,CAACzF,QAAV,CAAmB,WAAnB,CAAJ,EAAqC;AACjCmQ,IAAAA,MAAM,CAACtF,MAAM,IAAIA,MAAM,EAAjB,EAAqB,MAAM,CAAE,CAA7B,CAAN;AACA;AACH,GAtDuF,CAwDxF;AACA;AACA;;;AACA,MAAI5G,SAAS,CAACmM,wBAAV,IAAsC,CAAEnM,SAAS,CAACmM,wBAAV,CAAmCC,QAAnC,CAA4ChQ,EAA5C,CAA5C,EAA6F;AACzF4D,IAAAA,SAAS,CAACqM,0CAAV;AACH;;AAEDrM,EAAAA,SAAS,CAACsM,kBAAV,CAA6BC,IAA7B,CAAkCL,MAAlC;AAEAlM,EAAAA,SAAS,CAACmM,wBAAV,GAAqC/P,EAArC;AACH;;;;;;;;;ACpED;;AAEO,SAASoQ,iBAAT,CAA2BxM,SAA3B,EAAsC5D,EAAtC,EAA0CqQ,gBAA1C,EAA4DhF,aAA5D,EAA2EC,SAA3E,EAAsF;AACzF,sCAAwBtL,EAAxB,EAA4B,QAA5B;AAEA,QAAMsQ,0BAA0B,GAAGtQ,EAAE,CAACmB,kBAAH,IAAyBnB,EAAE,CAACmB,kBAAH,CAAsBoP,iBAAtB,KAA4C,IAAxG;;AAEA,MAAIF,gBAAgB,KAAK,CAAEC,0BAAF,IAAgCtQ,EAAE,CAACqG,gBAAxC,CAApB,EAA+E;AAC3E,UAAMgH,KAAK,GAAGrO,QAAQ,CAACsO,UAAT,CAAoBtN,EAAE,CAACM,OAAvB,EAAgC,IAAhC,CAAd;AAEAN,IAAAA,EAAE,CAACuN,aAAH,CAAiBC,YAAjB,CAA8BH,KAA9B,EAAqCrN,EAAE,CAACmB,kBAAxC;AAEA,6BAAanB,EAAE,CAACmB,kBAAhB,EAAoC,MAAM,CAAE,CAA5C,EAA8C,MAAM,CAAE,CAAtD,EAAwDyC,SAAxD,EAAmEyH,aAAnE;AAEAzH,IAAAA,SAAS,CAAC0I,kBAAV,CAA6BtM,EAAE,CAACmB,kBAAhC,EAAoDmK,SAApD;AAEAtL,IAAAA,EAAE,CAACmB,kBAAH,CAAsBoP,iBAAtB,GAA0C,IAA1C;AACH,GAVD,MAUO,IAAI,CAAEF,gBAAF,IAAsBC,0BAA1B,EAAsD;AACzD,8BAActQ,EAAE,CAACmB,kBAAjB,EAAqC,MAAM;AACvCnB,MAAAA,EAAE,CAACmB,kBAAH,CAAsBoJ,MAAtB;AACH,KAFD,EAEG,MAAM,CAAE,CAFX,EAEa3G,SAFb,EAEwByH,aAFxB;AAGH;AACJ;;;;;;;;;ACtBD;;AAEO,SAASmF,gBAAT,CAA0B5M,SAA1B,EAAqC5D,EAArC,EAAyCyQ,KAAzC,EAAgDrL,SAAhD,EAA2DpD,UAA3D,EAAuEsJ,SAAS,GAAG,MAAM,CAAG,CAA5F,EAA8FoF,OAAO,GAAC,KAAtG,EAA6G;AAChH,QAAM1B,OAAO,GAAG;AACZ2B,IAAAA,OAAO,EAAEvL,SAAS,CAACzF,QAAV,CAAmB,SAAnB;AADG,GAAhB;;AAIA,MAAIyF,SAAS,CAACzF,QAAV,CAAmB,OAAnB,CAAJ,EAAiC;AAC7B8Q,IAAAA,KAAK,GAAG,sBAAUA,KAAV,CAAR;AACH;;AAED,MAAIG,OAAJ,EAAaC,cAAb;;AAEA,MAAIzL,SAAS,CAACzF,QAAV,CAAmB,MAAnB,CAAJ,EAAgC;AAC5BkR,IAAAA,cAAc,GAAG7R,QAAjB;;AAEA4R,IAAAA,OAAO,GAAGpO,CAAC,IAAI;AACX;AACA,UAAIxC,EAAE,CAACgQ,QAAH,CAAYxN,CAAC,CAACsO,MAAd,CAAJ,EAA2B,OAFhB,CAIX;;AACA,UAAI9Q,EAAE,CAAC+Q,WAAH,GAAiB,CAAjB,IAAsB/Q,EAAE,CAACgR,YAAH,GAAkB,CAA5C,EAA+C,OALpC,CAOX;AACA;;AACAC,MAAAA,kBAAkB,CAACrN,SAAD,EAAY5B,UAAZ,EAAwBQ,CAAxB,EAA2B8I,SAA3B,EAAsCtL,EAAtC,CAAlB;;AAEA,UAAIoF,SAAS,CAACzF,QAAV,CAAmB,MAAnB,CAAJ,EAAgC;AAC5BX,QAAAA,QAAQ,CAACkS,mBAAT,CAA6BT,KAA7B,EAAoCG,OAApC,EAA6C5B,OAA7C;AACH;AACJ,KAdD;AAeH,GAlBD,MAkBO;AACH6B,IAAAA,cAAc,GAAGzL,SAAS,CAACzF,QAAV,CAAmB,QAAnB,IACXwR,MADW,GACD/L,SAAS,CAACzF,QAAV,CAAmB,UAAnB,IAAiCX,QAAjC,GAA4CgB,EAD5D;;AAGA4Q,IAAAA,OAAO,GAAGpO,CAAC,IAAI;AACX;AACA;AACA,UAAIqO,cAAc,KAAKM,MAAnB,IAA6BN,cAAc,KAAK7R,QAApD,EAA8D;AAC1D,YAAI,CAACA,QAAQ,CAACoS,IAAT,CAAcpB,QAAd,CAAuBhQ,EAAvB,CAAL,EAAiC;AAC7B6Q,UAAAA,cAAc,CAACK,mBAAf,CAAmCT,KAAnC,EAA0CG,OAA1C,EAAmD5B,OAAnD;AACA;AACH;AACJ;;AAED,UAAIqC,UAAU,CAACZ,KAAD,CAAd,EAAuB;AACnB,YAAIa,8CAA8C,CAAC9O,CAAD,EAAI4C,SAAJ,CAAlD,EAAkE;AAC9D;AACH;AACJ;;AAED,UAAIA,SAAS,CAACzF,QAAV,CAAmB,SAAnB,CAAJ,EAAmC6C,CAAC,CAAC+O,cAAF;AACnC,UAAInM,SAAS,CAACzF,QAAV,CAAmB,MAAnB,CAAJ,EAAgC6C,CAAC,CAACgP,eAAF,GAjBrB,CAmBX;AACA;AACA;;AACA,UAAI,CAACpM,SAAS,CAACzF,QAAV,CAAmB,MAAnB,CAAD,IAA+B6C,CAAC,CAACsO,MAAF,KAAa9Q,EAAhD,EAAoD;AAChD,cAAMyR,WAAW,GAAGR,kBAAkB,CAACrN,SAAD,EAAY5B,UAAZ,EAAwBQ,CAAxB,EAA2B8I,SAA3B,EAAsCtL,EAAtC,CAAtC;AAEAyR,QAAAA,WAAW,CAACC,IAAZ,CAAiBpP,KAAK,IAAI;AACtB,cAAIA,KAAK,KAAK,KAAd,EAAqB;AACjBE,YAAAA,CAAC,CAAC+O,cAAF;AACH,WAFD,MAEO;AACH,gBAAInM,SAAS,CAACzF,QAAV,CAAmB,MAAnB,CAAJ,EAAgC;AAC5BkR,cAAAA,cAAc,CAACK,mBAAf,CAAmCT,KAAnC,EAA0CG,OAA1C,EAAmD5B,OAAnD;AACH;AACJ;AACJ,SARD;AASH;AACJ,KAnCD;AAoCH,GArE+G,CAuEhH;AACA;;;AACA,MAAI,CAAC5J,SAAS,CAACzF,QAAV,CAAmB,OAAnB,CAAL,EAAkC;AAC9BiR,IAAAA,OAAO,GAAG,CAAC,CAAChN,SAAD,EAAYvC,IAAZ,KAAqB;AAC5B,aAAOmB,CAAC,IAAI;AACRoB,QAAAA,SAAS,CAAC+N,IAAV,CAAeC,aAAf,GAA+B,KAA/B;AACAvQ,QAAAA,IAAI,CAACmB,CAAD,CAAJ;;AACA,YAAIoB,SAAS,CAAC+N,IAAV,CAAeC,aAAf,KAAiC,IAArC,EAA2C;AACvChO,UAAAA,SAAS,CAAC+N,IAAV,CAAeE,eAAf,CAA+B,CAACzM,SAAS,CAACzF,QAAV,CAAmB,aAAnB,CAAhC;AACH;AACJ,OAND;AAOH,KARS,EAQPiE,SARO,EAQIgN,OARJ,CAAV;AASH;;AAED,MAAIxL,SAAS,CAACzF,QAAV,CAAmB,UAAnB,CAAJ,EAAoC;AAChC,QAAImS,YAAY,GAAG1M,SAAS,CAACA,SAAS,CAACL,OAAV,CAAkB,UAAlB,IAAgC,CAAjC,CAAT,IAAgD,cAAnE;AACA,QAAIzD,IAAI,GAAG,sBAAUwQ,YAAY,CAACjM,KAAb,CAAmB,IAAnB,EAAyB,CAAzB,CAAV,IAAyCgF,MAAM,CAACiH,YAAY,CAACjM,KAAb,CAAmB,IAAnB,EAAyB,CAAzB,CAAD,CAA/C,GAA+E,GAA1F;AACA+K,IAAAA,OAAO,GAAG,qBAASA,OAAT,EAAkBtP,IAAlB,EAAwB,IAAxB,CAAV;AACH;;AACD,QAAMyQ,aAAa,GAAG3M,SAAS,CAACsE,IAAV,CAAesI,CAAC,IAAIA,CAAC,CAACxM,UAAF,CAAa,OAAb,CAApB,CAAtB;;AACA,MAAIuM,aAAa,KAAKtE,SAAtB,EAAiC;AAC7B,UAAMwE,OAAO,GAAGF,aAAa,CAAClM,KAAd,CAAoB,GAApB,EAAyB,CAAzB,EAA4B,CAA5B,CAAhB;AACA,QAAIqM,SAAS,GAAG9M,SAAS,CAACA,SAAS,CAACL,OAAV,CAAkBgN,aAAlB,IAAmC,CAApC,CAAzB;AACAG,IAAAA,SAAS,GAAGA,SAAS,KAAKzE,SAAd,IAA2ByE,SAAS,CAACC,QAAV,CAAmB,IAAnB,CAA3B,GAAsDC,QAAQ,CAACF,SAAS,CAACG,MAAV,CAAiB,CAAjB,EAAoBH,SAAS,CAACtC,MAAV,GAAmB,CAAvC,CAAD,CAA9D,GAA4G,GAAxH;;AACA,QAAIqC,OAAO,KAAKxE,SAAhB,EAA2B;AACvBmD,MAAAA,OAAO,GAAG,CAAC,CAAC0B,IAAD,EAAOjR,IAAP,KAAgB;AACvB,eAAQmB,CAAD,IAAO;AACV,cAAI+P,OAAO,GAAGpB,MAAM,CAACrP,UAAP,CAAkB,YAAY;AAAET,YAAAA,IAAI,CAACmB,CAAD,CAAJ;AAAS,WAAzC,EAA2C0P,SAA3C,CAAd;AACAI,UAAAA,IAAI,CAACE,aAAL,CAAmBrC,IAAnB,CAAwBoC,OAAxB;AAEH,SAJD;AAKH,OANS,EAMP3O,SANO,EAMIgN,OANJ,CAAV;AAOH,KARD,MAQO;AACH,UAAI9H,KAAK,GAAG,IAAI2J,IAAJ,GAAWC,OAAX,EAAZ;;AACA,UAAI9O,SAAS,CAAC+O,4BAAV,CAAuCV,OAAvC,MAAoDxE,SAAxD,EAAmE;AAC/D3E,QAAAA,KAAK,GAAGlF,SAAS,CAAC+O,4BAAV,CAAuCV,OAAvC,EAAgDnJ,KAAxD;AACAoJ,QAAAA,SAAS,GAAGA,SAAS,IAAK,IAAIO,IAAJ,GAAWC,OAAX,EAAD,GAAyB5J,KAA7B,CAArB;AACH;;AAED,UAAIoJ,SAAS,GAAG,CAAhB,EAAmB;AACftB,QAAAA,OAAO,GAAG,CAAC,CAAC0B,IAAD,EAAOjR,IAAP,KAAgB;AACvB,iBAAQmB,CAAD,IAAO;AACV,gBAAI+P,OAAO,GAAGpB,MAAM,CAACrP,UAAP,CAAkB,YAAY;AACxCT,cAAAA,IAAI,CAACmB,CAAD,CAAJ;AACA,qBAAO8P,IAAI,CAACM,WAAL,CAAiBX,OAAjB,CAAP;AACH,aAHa,EAGXC,SAHW,CAAd;AAIAI,YAAAA,IAAI,CAACM,WAAL,CAAiBX,OAAjB,IAA4B;AACxBY,cAAAA,EAAE,EAAEN,OADoB;AAExBzJ,cAAAA,KAAK,EAAEA;AAFiB,aAA5B;AAIH,WATD;AAUH,SAXS,EAWPlF,SAXO,EAWIgN,OAXJ,CAAV;AAYH,OAbD,MAaO;AACH;AACAhN,QAAAA,SAAS,CAACkP,aAAV,CAAwB3C,IAAxB,CAA6B,MAAM;AAC/BS,UAAAA,OAAO,CAAC,IAAImC,KAAJ,CAAU,OAAV,EAAmB;AAAEjC,YAAAA,MAAM,EAAE9Q;AAAV,WAAnB,CAAD,CAAP;AACH,SAFD;AAGA,eALG,CAKI;AACV;AACJ;AACJ;;AAED,MAAIyQ,KAAK,KAAK,OAAd,EAAuB;AACnB,QAAI,CAAEC,OAAN,EAAe;AACX9M,MAAAA,SAAS,CAACkP,aAAV,CAAwB3C,IAAxB,CAA6B,MAAM;AAC/BS,QAAAA,OAAO,CAAC,IAAImC,KAAJ,CAAU,OAAV,EAAmB;AAAEjC,UAAAA,MAAM,EAAE9Q;AAAV,SAAnB,CAAD,CAAP;AACH,OAFD;AAGH;AACJ,GAND,MAMO;AACH;AACA,QAAIA,EAAE,CAACgT,eAAH,KAAuBvF,SAA3B,EAAsC;AAClCzN,MAAAA,EAAE,CAACgT,eAAH,GAAqB,EAArB;AACH;;AACDhT,IAAAA,EAAE,CAACgT,eAAH,CAAmB7C,IAAnB,CAAwB,CAACU,cAAD,EAAiBJ,KAAjB,EAAwBG,OAAxB,EAAiC5B,OAAjC,CAAxB;;AACA6B,IAAAA,cAAc,CAAC3R,gBAAf,CAAgCuR,KAAhC,EAAuCG,OAAvC,EAAgD5B,OAAhD;AACH;AACJ;;AAED,SAASiC,kBAAT,CAA4BrN,SAA5B,EAAuC5B,UAAvC,EAAmDQ,CAAnD,EAAsD8I,SAAtD,EAAiE2H,IAAjE,EAAuE;AACnE,SAAOrP,SAAS,CAACsP,yBAAV,CAAoC1Q,CAAC,CAACsO,MAAtC,EAA8C9O,UAA9C,EAA0D,MAAM;AACnE,WAAO,EAAE,GAAGsJ,SAAS,EAAd;AAAkB,gBAAU9I,CAA5B;AAA+B,eAASyQ;AAAxC,KAAP;AACH,GAFM,CAAP;AAGH;;AAED,SAAS5B,UAAT,CAAoBZ,KAApB,EAA2B;AACvB,SAAO,CAAC,SAAD,EAAY,OAAZ,EAAqB9Q,QAArB,CAA8B8Q,KAA9B,CAAP;AACH;;AAED,SAASa,8CAAT,CAAwD9O,CAAxD,EAA2D4C,SAA3D,EAAsE;AAClE,MAAI+N,YAAY,GAAG/N,SAAS,CAACpB,MAAV,CAAiBQ,CAAC,IAAI;AACrC,WAAO,CAAC,CAAC,QAAD,EAAW,UAAX,EAAuB,SAAvB,EAAkC,MAAlC,EAA0C7E,QAA1C,CAAmD6E,CAAnD,CAAR;AACH,GAFkB,CAAnB;;AAIA,MAAI2O,YAAY,CAACxT,QAAb,CAAsB,UAAtB,CAAJ,EAAuC;AACnC,QAAIyT,aAAa,GAAGD,YAAY,CAACpO,OAAb,CAAqB,UAArB,CAApB;AACAoO,IAAAA,YAAY,CAACE,MAAb,CAAoBD,aAApB,EAAmC,sBAAU,CAACD,YAAY,CAACC,aAAa,GAAG,CAAjB,CAAZ,IAAmC,cAApC,EAAoDvN,KAApD,CAA0D,IAA1D,EAAgE,CAAhE,CAAV,IAAgF,CAAhF,GAAoF,CAAvH;AACH,GARiE,CAUlE;;;AACA,MAAIsN,YAAY,CAACvD,MAAb,KAAwB,CAA5B,EAA+B,OAAO,KAAP,CAXmC,CAalE;;AACA,MAAIuD,YAAY,CAACvD,MAAb,KAAwB,CAAxB,IAA6BuD,YAAY,CAAC,CAAD,CAAZ,KAAoBG,aAAa,CAAC9Q,CAAC,CAACoF,GAAH,CAAlE,EAA2E,OAAO,KAAP,CAdT,CAgBlE;;AACA,QAAM2L,kBAAkB,GAAG,CAAC,MAAD,EAAS,OAAT,EAAkB,KAAlB,EAAyB,MAAzB,EAAiC,KAAjC,EAAwC,OAAxC,CAA3B;AACA,QAAMC,0BAA0B,GAAGD,kBAAkB,CAACvP,MAAnB,CAA0ByP,QAAQ,IAAIN,YAAY,CAACxT,QAAb,CAAsB8T,QAAtB,CAAtC,CAAnC;AAEAN,EAAAA,YAAY,GAAGA,YAAY,CAACnP,MAAb,CAAoBQ,CAAC,IAAI,CAACgP,0BAA0B,CAAC7T,QAA3B,CAAoC6E,CAApC,CAA1B,CAAf;;AAEA,MAAIgP,0BAA0B,CAAC5D,MAA3B,GAAoC,CAAxC,EAA2C;AACvC,UAAM8D,2BAA2B,GAAGF,0BAA0B,CAACxP,MAA3B,CAAkCyP,QAAQ,IAAI;AAC9E;AACA,UAAIA,QAAQ,KAAK,KAAb,IAAsBA,QAAQ,KAAK,OAAvC,EAAgDA,QAAQ,GAAG,MAAX;AAEhD,aAAOjR,CAAC,CAAE,GAAEiR,QAAS,KAAb,CAAR;AACH,KALmC,CAApC,CADuC,CAQvC;;AACA,QAAIC,2BAA2B,CAAC9D,MAA5B,KAAuC4D,0BAA0B,CAAC5D,MAAtE,EAA8E;AAC1E;AACA,UAAIuD,YAAY,CAAC,CAAD,CAAZ,KAAoBG,aAAa,CAAC9Q,CAAC,CAACoF,GAAH,CAArC,EAA8C,OAAO,KAAP;AACjD;AACJ,GAnCiE,CAqClE;;;AACA,SAAO,IAAP;AACH;;AAED,SAAS0L,aAAT,CAAuB1L,GAAvB,EAA4B;AACxB,UAAQA,GAAR;AACI,SAAK,GAAL;AACI,aAAO,OAAP;;AACJ,SAAK,GAAL;AACA,SAAK,UAAL;AACI,aAAO,OAAP;;AACJ;AACI,aAAOA,GAAG,IAAI,sBAAUA,GAAV,CAAd;AAPR;AASH;;;;;;;;;ACpND;;AACA;;AAEO,SAAS+L,qBAAT,CAA+B/P,SAA/B,EAA0C5D,EAA1C,EAA8CoF,SAA9C,EAAyDpD,UAAzD,EAAqEsJ,SAArE,EAAgF;AACnF;AACA;AACA,MAAImF,KAAK,GAAIzQ,EAAE,CAACE,OAAH,CAAWC,WAAX,OAA6B,QAA9B,IACL,CAAC,UAAD,EAAa,OAAb,EAAsBR,QAAtB,CAA+BK,EAAE,CAAC6D,IAAlC,CADK,IAELuB,SAAS,CAACzF,QAAV,CAAmB,MAAnB,CAFK,GAGN,QAHM,GAGK,OAHjB;AAKA,QAAMiU,kBAAkB,GAAI,GAAE5R,UAAW,oCAAmCA,UAAW,GAAvF;AAEA,4BAAiB4B,SAAjB,EAA4B5D,EAA5B,EAAgCyQ,KAAhC,EAAuCrL,SAAvC,EAAkDwO,kBAAlD,EAAsE,MAAM;AACxE,WAAO,EACH,GAAGtI,SAAS,EADT;AAEHuI,MAAAA,qBAAqB,EAAEC,+BAA+B,CAAC9T,EAAD,EAAKoF,SAAL,EAAgBpD,UAAhB;AAFnD,KAAP;AAIH,GALD;AAMH;;AAED,SAAS8R,+BAAT,CAAyC9T,EAAzC,EAA6CoF,SAA7C,EAAwDpD,UAAxD,EAAoE;AAChE,MAAIhC,EAAE,CAAC6D,IAAH,KAAY,OAAhB,EAAyB;AACrB;AACA;AACA;AACA,QAAI,CAAE7D,EAAE,CAAC+T,YAAH,CAAgB,MAAhB,CAAN,EAA+B/T,EAAE,CAACuO,YAAH,CAAgB,MAAhB,EAAwBvM,UAAxB;AAClC;;AAED,SAAO,CAACyO,KAAD,EAAQuD,YAAR,KAAyB;AAC5B;AACA,QAAIvD,KAAK,YAAYwD,WAAjB,IAAgCxD,KAAK,CAACyD,MAA1C,EAAkD;AAC9C,aAAOzD,KAAK,CAACyD,MAAb;AACH,KAFD,MAEO,IAAIlU,EAAE,CAAC6D,IAAH,KAAY,UAAhB,EAA4B;AAC/B;AACA,UAAIxE,KAAK,CAAC2L,OAAN,CAAcgJ,YAAd,CAAJ,EAAiC;AAC7B,cAAMG,QAAQ,GAAG/O,SAAS,CAACzF,QAAV,CAAmB,QAAnB,IAA+ByU,eAAe,CAAC3D,KAAK,CAACK,MAAN,CAAaxO,KAAd,CAA9C,GAAqEmO,KAAK,CAACK,MAAN,CAAaxO,KAAnG;AACA,eAAOmO,KAAK,CAACK,MAAN,CAAa1C,OAAb,GAAuB4F,YAAY,CAAC1P,MAAb,CAAoB,CAAC6P,QAAD,CAApB,CAAvB,GAAyDH,YAAY,CAAChQ,MAAb,CAAoBhE,EAAE,IAAI,CAAC,oCAAwBA,EAAxB,EAA4BmU,QAA5B,CAA3B,CAAhE;AACH,OAHD,MAGO;AACH,eAAO1D,KAAK,CAACK,MAAN,CAAa1C,OAApB;AACH;AACJ,KARM,MAQA,IAAIpO,EAAE,CAACE,OAAH,CAAWC,WAAX,OAA6B,QAA7B,IAAyCH,EAAE,CAACqU,QAAhD,EAA0D;AAC7D,aAAOjP,SAAS,CAACzF,QAAV,CAAmB,QAAnB,IACDN,KAAK,CAACC,IAAN,CAAWmR,KAAK,CAACK,MAAN,CAAawD,eAAxB,EAAyCrQ,GAAzC,CAA6CgL,MAAM,IAAI;AACrD,cAAMnH,QAAQ,GAAGmH,MAAM,CAAC3M,KAAP,IAAgB2M,MAAM,CAACE,IAAxC;AACA,eAAOiF,eAAe,CAACtM,QAAD,CAAtB;AACH,OAHC,CADC,GAKDzI,KAAK,CAACC,IAAN,CAAWmR,KAAK,CAACK,MAAN,CAAawD,eAAxB,EAAyCrQ,GAAzC,CAA6CgL,MAAM,IAAI;AACrD,eAAOA,MAAM,CAAC3M,KAAP,IAAgB2M,MAAM,CAACE,IAA9B;AACH,OAFC,CALN;AAQH,KATM,MASA;AACH,YAAMrH,QAAQ,GAAG2I,KAAK,CAACK,MAAN,CAAaxO,KAA9B;AACA,aAAO8C,SAAS,CAACzF,QAAV,CAAmB,QAAnB,IACDyU,eAAe,CAACtM,QAAD,CADd,GAEA1C,SAAS,CAACzF,QAAV,CAAmB,MAAnB,IAA6BmI,QAAQ,CAACmB,IAAT,EAA7B,GAA+CnB,QAFtD;AAGH;AACJ,GA3BD;AA4BH;;AAED,SAASsM,eAAT,CAAyBtM,QAAzB,EAAmC;AAC/B,QAAMyM,MAAM,GAAGzM,QAAQ,GAAG0M,UAAU,CAAC1M,QAAD,CAAb,GAA0B,IAAjD;AACA,SAAO,sBAAUyM,MAAV,IAAoBA,MAApB,GAA6BzM,QAApC;AACH;;;;;;;;;;AC9DD;AACA;AACA;AACA,MAAM;AAAEkD,EAAAA;AAAF,IAAc3L,KAApB;AACA,MAAM;AAAE6D,EAAAA,cAAF;AAAkBuR,EAAAA,MAAM,EAAEC,YAA1B;AAAwCC,EAAAA,cAAc,EAAEC,oBAAxD;AAA8EC,EAAAA,gBAAgB,EAAEC,sBAAhG;AAAwHC,EAAAA,YAAxH;AAAsIC,EAAAA,wBAAtI;AAAgKC,EAAAA,mBAAhK;AAAqLC,EAAAA,qBAArL;AAA4MC,EAAAA,iBAA5M;AAA+NC,EAAAA;AAA/N,IAAmPlT,MAAzP;AACA,MAAM;AAAEiO,EAAAA,IAAI,EAAEkF,SAAR;AAAmB/Q,EAAAA,MAAM,EAAEgR,WAA3B;AAAwCrR,EAAAA,GAAG,EAAEsR;AAA7C,IAA2DlW,KAAK,CAACmW,SAAvE;AACA,MAAMC,GAAG,GAAG,GAAGC,QAAf;;AACA,SAASA,QAAT,CAAkBC,GAAlB,EAAuB;AACnB,MAAIA,GAAG,IAAIA,GAAG,CAACD,QAAf,EAAyB;AACrB,WAAOC,GAAG,CAACD,QAAJ,EAAP;AACH,GAFD,MAGK,IAAI,OAAOC,GAAP,KAAe,QAAnB,EAA6B;AAC9B,WAAOF,GAAG,CAAC7S,IAAJ,CAAS+S,GAAT,CAAP;AACH,GAFI,MAGA;AACD,WAAOA,GAAG,GAAG,EAAb;AACH;AACJ;;AACD,SAASC,WAAT,CAAqBD,GAArB,EAA0B;AACtB,SAAOA,GAAG,KAAKlI,SAAf;AACH;;AACD,SAASoI,UAAT,CAAoBF,GAApB,EAAyB;AACrB,SAAO,OAAOA,GAAP,KAAe,UAAtB;AACH;;AACD,MAAMG,eAAe,GAAG,IAAIC,OAAJ,EAAxB;;AACA,SAASC,aAAT,CAAuBC,KAAvB,EAA8B3T,KAA9B,EAAqC;AACjCwT,EAAAA,eAAe,CAACI,GAAhB,CAAoBD,KAApB,EAA2B3T,KAA3B;AACH;;AACD,MAAM6T,MAAM,GAAIC,YAAD,IAAkBN,eAAe,CAACO,GAAhB,CAAoBD,YAApB,KAAqCA,YAAtE;;AAEA,MAAME,gBAAN,CAAuB;AACnBnT,EAAAA,WAAW,CAACoT,QAAD,EAAWjU,KAAX,EAAkB;AACzB,SAAKkU,cAAL,GAAsBlU,KAAtB;AACA,SAAKiU,QAAL,GAAgBA,QAAhB;AACH,GAJkB,CAKnB;;;AACAE,EAAAA,cAAc,CAACC,UAAD,EAAa;AACvB,QAAItB,cAAc,CAACxS,IAAf,CAAoB8T,UAApB,EAAgC,OAAhC,CAAJ,EAA8C;AAC1CA,MAAAA,UAAU,CAACpU,KAAX,GAAmB,KAAKqU,SAAL,CAAeD,UAAU,CAACpU,KAA1B,CAAnB;AACH,KAFD,MAGK;AACD,YAAM;AAAE4T,QAAAA,GAAG,EAAEU,WAAP;AAAoBP,QAAAA,GAAG,EAAEQ;AAAzB,UAAyCH,UAA/C;;AACA,UAAI,CAACd,WAAW,CAACiB,WAAD,CAAhB,EAA+B;AAC3BH,QAAAA,UAAU,CAACL,GAAX,GAAiB,KAAKS,UAAL,CAAgBD,WAAhB,CAAjB;AACH;;AACD,UAAI,CAACjB,WAAW,CAACgB,WAAD,CAAhB,EAA+B;AAC3BF,QAAAA,UAAU,CAACR,GAAX,GAAiB,KAAKa,UAAL,CAAgBH,WAAhB,CAAjB;AACH;AACJ;;AACD,WAAOF,UAAP;AACH;;AACDM,EAAAA,8BAA8B,CAACC,YAAD,EAAerP,GAAf,EAAoB;AAC9C,UAAM;AAAE4O,MAAAA;AAAF,QAAqB,IAA3B,CAD8C,CAE9C;AACA;AACA;;AACA,UAAMU,kBAAkB,GAAGlC,wBAAwB,CAACwB,cAAD,EAAiB5O,GAAjB,CAAnD;;AACA,QAAI,CAACgO,WAAW,CAACsB,kBAAD,CAAhB,EAAsC;AAClC,YAAMC,WAAW,GAAG,KAAKV,cAAL,CAAoBS,kBAApB,CAApB;AACAtC,MAAAA,oBAAoB,CAACqC,YAAD,EAAerP,GAAf,EAAoBuP,WAApB,CAApB;AACH;AACJ;;AACDC,EAAAA,gBAAgB,CAACH,YAAD,EAAe;AAC3B,UAAM;AAAET,MAAAA;AAAF,QAAqB,IAA3B;AACA,UAAMa,UAAU,GAAG/B,WAAW,CAAC1S,IAAZ,CAAiBqS,mBAAmB,CAACuB,cAAD,CAApC,EAAsDtB,qBAAqB,CAACsB,cAAD,CAA3E,CAAnB;AACAa,IAAAA,UAAU,CAACzL,OAAX,CAAoBhE,GAAD,IAAS;AACxB,WAAKoP,8BAAL,CAAoCC,YAApC,EAAkDrP,GAAlD;AACH,KAFD;AAGA,UAAM;AAAE2O,MAAAA,QAAQ,EAAE;AAAEe,QAAAA;AAAF;AAAZ,QAAmC,IAAzC;;AACA,QAAI,CAAC1B,WAAW,CAAC0B,cAAD,CAAZ,IAAgC,CAAClC,cAAc,CAACxS,IAAf,CAAoBqU,YAApB,EAAkCK,cAAlC,CAArC,EAAwF;AACpF1C,MAAAA,oBAAoB,CAACqC,YAAD,EAAeK,cAAf,EAA+B5C,YAAY,CAAC,IAAD,CAA3C,CAApB;AACH;;AACDS,IAAAA,iBAAiB,CAAC8B,YAAD,CAAjB;AACH,GA3CkB,CA4CnB;;;AACArV,EAAAA,KAAK,CAACqV,YAAD,EAAeM,OAAf,EAAwBC,QAAxB,EAAkC;AACnC;AACH;;AACDC,EAAAA,SAAS,CAACR,YAAD,EAAeO,QAAf,EAAyBE,SAAzB,EAAoC;AACzC;AACH;;AACDrB,EAAAA,GAAG,CAACY,YAAD,EAAerP,GAAf,EAAoB;AACnB,UAAM;AAAE4O,MAAAA,cAAF;AAAkBD,MAAAA,QAAQ,EAAE;AAAEoB,QAAAA;AAAF;AAA5B,QAAkD,IAAxD;AACA,UAAMrV,KAAK,GAAGkU,cAAc,CAAC5O,GAAD,CAA5B;AACA+P,IAAAA,aAAa,CAACnB,cAAD,EAAiB5O,GAAjB,CAAb;AACA,WAAO,KAAK+O,SAAL,CAAerU,KAAf,CAAP;AACH;;AACDsV,EAAAA,GAAG,CAACX,YAAD,EAAerP,GAAf,EAAoB;AACnB,UAAM;AAAE4O,MAAAA,cAAF;AAAkBD,MAAAA,QAAQ,EAAE;AAAEe,QAAAA,cAAF;AAAkBK,QAAAA;AAAlB;AAA5B,QAAkE,IAAxE;AACAA,IAAAA,aAAa,CAACnB,cAAD,EAAiB5O,GAAjB,CAAb,CAFmB,CAGnB;AACA;;AACA,WAAOA,GAAG,IAAI4O,cAAP,IAAyB5O,GAAG,KAAK0P,cAAxC;AACH;;AACDO,EAAAA,OAAO,CAACZ,YAAD,EAAe;AAClB,UAAM;AAAET,MAAAA,cAAF;AAAkBD,MAAAA,QAAQ,EAAE;AAAEe,QAAAA;AAAF;AAA5B,QAAmD,IAAzD,CADkB,CAElB;;AACA,UAAMxU,IAAI,GAAG8S,WAAW,CAAC0B,cAAD,CAAX,IAA+BlC,cAAc,CAACxS,IAAf,CAAoB4T,cAApB,EAAoCc,cAApC,CAA/B,GAAqF,EAArF,GAA0F,CAACA,cAAD,CAAvG,CAHkB,CAIlB;;AACAjC,IAAAA,SAAS,CAACzT,KAAV,CAAgBkB,IAAhB,EAAsBmS,mBAAmB,CAACuB,cAAD,CAAzC;AACAnB,IAAAA,SAAS,CAACzT,KAAV,CAAgBkB,IAAhB,EAAsBoS,qBAAqB,CAACsB,cAAD,CAA3C;AACA,WAAO1T,IAAP;AACH;;AACDiS,EAAAA,YAAY,CAACkC,YAAD,EAAe;AACvB,UAAM;AAAET,MAAAA;AAAF,QAAqB,IAA3B,CADuB,CAEvB;;AACA,QAAI,CAACzB,YAAY,CAACkC,YAAD,CAAjB,EAAiC;AAC7B,aAAO,KAAP,CAD6B,CACf;AACjB;;AACD,QAAI,CAAClC,YAAY,CAACyB,cAAD,CAAjB,EAAmC;AAC/B,WAAKY,gBAAL,CAAsBH,YAAtB;AACA,aAAO,KAAP;AACH;;AACD,WAAO,IAAP;AACH;;AACD/T,EAAAA,cAAc,CAAC+T,YAAD,EAAe;AACzB,UAAM;AAAET,MAAAA;AAAF,QAAqB,IAA3B;AACA,WAAOtT,cAAc,CAACsT,cAAD,CAArB;AACH;;AACDxB,EAAAA,wBAAwB,CAACiC,YAAD,EAAerP,GAAf,EAAoB;AACxC,UAAM;AAAE4O,MAAAA,cAAF;AAAkBD,MAAAA,QAAQ,EAAE;AAAEoB,QAAAA,aAAF;AAAiBL,QAAAA;AAAjB;AAA5B,QAAkE,IAAxE,CADwC,CAExC;;AACAK,IAAAA,aAAa,CAACnB,cAAD,EAAiB5O,GAAjB,CAAb;AACA,QAAIkQ,IAAI,GAAG9C,wBAAwB,CAACwB,cAAD,EAAiB5O,GAAjB,CAAnC;;AACA,QAAIgO,WAAW,CAACkC,IAAD,CAAf,EAAuB;AACnB,UAAIlQ,GAAG,KAAK0P,cAAZ,EAA4B;AACxB,eAAO7J,SAAP;AACH,OAHkB,CAInB;AACA;;;AACAqK,MAAAA,IAAI,GAAG;AAAExV,QAAAA,KAAK,EAAEmL,SAAT;AAAoBsK,QAAAA,QAAQ,EAAE,KAA9B;AAAqCC,QAAAA,YAAY,EAAE,KAAnD;AAA0DC,QAAAA,UAAU,EAAE;AAAtE,OAAP;AACArD,MAAAA,oBAAoB,CAACqC,YAAD,EAAeK,cAAf,EAA+BQ,IAA/B,CAApB;AACA,aAAOA,IAAP;AACH;;AACD,QAAIA,IAAI,CAACE,YAAL,KAAsB,KAA1B,EAAiC;AAC7B;AACA,WAAKhB,8BAAL,CAAoCC,YAApC,EAAkDrP,GAAlD;AACH,KAlBuC,CAmBxC;AACA;AACA;;;AACA,WAAO,KAAK6O,cAAL,CAAoBqB,IAApB,CAAP;AACH;;AAhHkB;;AAmHvB,MAAMI,SAAS,GAAG,IAAInC,OAAJ,EAAlB;AACA,MAAMoC,SAAS,GAAG,IAAIpC,OAAJ,EAAlB;AACA,MAAMqC,gBAAgB,GAAG,IAAIrC,OAAJ,EAAzB;AACA,MAAMsC,gBAAgB,GAAG,IAAItC,OAAJ,EAAzB;;AACA,MAAMuC,oBAAN,SAAmChC,gBAAnC,CAAoD;AAChDK,EAAAA,SAAS,CAACrU,KAAD,EAAQ;AACb,WAAO,KAAKiU,QAAL,CAAcgC,QAAd,CAAuBjW,KAAvB,CAAP;AACH;;AACDwU,EAAAA,UAAU,CAACD,WAAD,EAAc;AACpB,UAAM2B,aAAa,GAAGN,SAAS,CAAC7B,GAAV,CAAcQ,WAAd,CAAtB;;AACA,QAAI,CAACjB,WAAW,CAAC4C,aAAD,CAAhB,EAAiC;AAC7B,aAAOA,aAAP;AACH;;AACD,UAAM5H,OAAO,GAAG,IAAhB;;AACA,UAAMyF,GAAG,GAAG,YAAY;AACpB;AACA,aAAOzF,OAAO,CAAC+F,SAAR,CAAkBE,WAAW,CAACjU,IAAZ,CAAiBuT,MAAM,CAAC,IAAD,CAAvB,CAAlB,CAAP;AACH,KAHD;;AAIA+B,IAAAA,SAAS,CAAChC,GAAV,CAAcW,WAAd,EAA2BR,GAA3B;AACA+B,IAAAA,gBAAgB,CAAClC,GAAjB,CAAqBG,GAArB,EAA0BQ,WAA1B;AACA,WAAOR,GAAP;AACH;;AACDU,EAAAA,UAAU,CAACH,WAAD,EAAc;AACpB,UAAM6B,aAAa,GAAGN,SAAS,CAAC9B,GAAV,CAAcO,WAAd,CAAtB;;AACA,QAAI,CAAChB,WAAW,CAAC6C,aAAD,CAAhB,EAAiC;AAC7B,aAAOA,aAAP;AACH;;AACD,UAAMvC,GAAG,GAAG,UAAUwC,CAAV,EAAa;AACrB;AACA9B,MAAAA,WAAW,CAAChU,IAAZ,CAAiBuT,MAAM,CAAC,IAAD,CAAvB,EAA+BA,MAAM,CAACuC,CAAD,CAArC;AACH,KAHD;;AAIAP,IAAAA,SAAS,CAACjC,GAAV,CAAcU,WAAd,EAA2BV,GAA3B;AACAmC,IAAAA,gBAAgB,CAACnC,GAAjB,CAAqBA,GAArB,EAA0BU,WAA1B;AACA,WAAOV,GAAP;AACH;;AACDyC,EAAAA,gBAAgB,CAACjC,UAAD,EAAa;AACzB,QAAItB,cAAc,CAACxS,IAAf,CAAoB8T,UAApB,EAAgC,OAAhC,CAAJ,EAA8C;AAC1C;AACAA,MAAAA,UAAU,CAACpU,KAAX,GAAmB6T,MAAM,CAACO,UAAU,CAACpU,KAAZ,CAAzB;AACH,KAHD,MAIK;AACD,YAAM;AAAE4T,QAAAA,GAAF;AAAOG,QAAAA;AAAP,UAAeK,UAArB;;AACA,UAAI,CAACd,WAAW,CAACS,GAAD,CAAhB,EAAuB;AACnBK,QAAAA,UAAU,CAACL,GAAX,GAAiB,KAAKuC,YAAL,CAAkBvC,GAAlB,CAAjB;AACH;;AACD,UAAI,CAACT,WAAW,CAACM,GAAD,CAAhB,EAAuB;AACnBQ,QAAAA,UAAU,CAACR,GAAX,GAAiB,KAAK2C,YAAL,CAAkB3C,GAAlB,CAAjB;AACH;AACJ;;AACD,WAAOQ,UAAP;AACH;;AACDkC,EAAAA,YAAY,CAACE,MAAD,EAAS;AACjB,UAAMC,aAAa,GAAGX,gBAAgB,CAAC/B,GAAjB,CAAqByC,MAArB,CAAtB;;AACA,QAAI,CAAClD,WAAW,CAACmD,aAAD,CAAhB,EAAiC;AAC7B,aAAOA,aAAP;AACH;;AACD,UAAMnI,OAAO,GAAG,IAAhB;;AACA,UAAMyF,GAAG,GAAG,YAAY;AACpB;AACA,aAAOF,MAAM,CAAC2C,MAAM,CAAClW,IAAP,CAAYgO,OAAO,CAAC+F,SAAR,CAAkB,IAAlB,CAAZ,CAAD,CAAb;AACH,KAHD;;AAIAuB,IAAAA,SAAS,CAAChC,GAAV,CAAcG,GAAd,EAAmByC,MAAnB;AACAV,IAAAA,gBAAgB,CAAClC,GAAjB,CAAqB4C,MAArB,EAA6BzC,GAA7B;AACA,WAAOA,GAAP;AACH;;AACDwC,EAAAA,YAAY,CAACG,MAAD,EAAS;AACjB,UAAMC,aAAa,GAAGZ,gBAAgB,CAAChC,GAAjB,CAAqB2C,MAArB,CAAtB;;AACA,QAAI,CAACpD,WAAW,CAACqD,aAAD,CAAhB,EAAiC;AAC7B,aAAOA,aAAP;AACH;;AACD,UAAMrI,OAAO,GAAG,IAAhB;;AACA,UAAMsF,GAAG,GAAG,UAAUwC,CAAV,EAAa;AACrB;AACAM,MAAAA,MAAM,CAACpW,IAAP,CAAYgO,OAAO,CAAC+F,SAAR,CAAkB,IAAlB,CAAZ,EAAqC/F,OAAO,CAAC+F,SAAR,CAAkB+B,CAAlB,CAArC;AACH,KAHD;;AAIAP,IAAAA,SAAS,CAACjC,GAAV,CAAcA,GAAd,EAAmB8C,MAAnB;AACAX,IAAAA,gBAAgB,CAACnC,GAAjB,CAAqB8C,MAArB,EAA6B9C,GAA7B;AACA,WAAOA,GAAP;AACH;;AACDA,EAAAA,GAAG,CAACe,YAAD,EAAerP,GAAf,EAAoBtF,KAApB,EAA2B;AAC1B,UAAM;AAAEkU,MAAAA,cAAF;AAAkBD,MAAAA,QAAQ,EAAE;AAAE2C,QAAAA;AAAF;AAA5B,QAAiD,IAAvD;AACA,UAAMC,QAAQ,GAAG3C,cAAc,CAAC5O,GAAD,CAA/B;;AACA,QAAIuR,QAAQ,KAAK7W,KAAjB,EAAwB;AACpBkU,MAAAA,cAAc,CAAC5O,GAAD,CAAd,GAAsBtF,KAAtB;AACA4W,MAAAA,YAAY,CAAC1C,cAAD,EAAiB5O,GAAjB,CAAZ;AACH,KAHD,MAIK,IAAIA,GAAG,KAAK,QAAR,IAAoBoD,OAAO,CAACwL,cAAD,CAA/B,EAAiD;AAClD;AACA;AACA;AACA;AACA0C,MAAAA,YAAY,CAAC1C,cAAD,EAAiB5O,GAAjB,CAAZ;AACH;;AACD,WAAO,IAAP;AACH;;AACDwR,EAAAA,cAAc,CAACnC,YAAD,EAAerP,GAAf,EAAoB;AAC9B,UAAM;AAAE4O,MAAAA,cAAF;AAAkBD,MAAAA,QAAQ,EAAE;AAAE2C,QAAAA;AAAF;AAA5B,QAAiD,IAAvD;AACA,WAAO1C,cAAc,CAAC5O,GAAD,CAArB;AACAsR,IAAAA,YAAY,CAAC1C,cAAD,EAAiB5O,GAAjB,CAAZ;AACA,WAAO,IAAP;AACH;;AACDyR,EAAAA,cAAc,CAACpC,YAAD,EAAezB,SAAf,EAA0B;AACpC,QAAI,kBAAyB,YAA7B,EAA2C;AACvC,YAAM,IAAI8D,KAAJ,CAAW,wDAAuD5D,QAAQ,CAAC,KAAKc,cAAN,CAAsB,oDAAhG,CAAN;AACH;AACJ;;AACDrB,EAAAA,iBAAiB,CAAC8B,YAAD,EAAe;AAC5B,QAAIlC,YAAY,CAACkC,YAAD,CAAhB,EAAgC;AAC5B,YAAM;AAAET,QAAAA;AAAF,UAAqB,IAA3B;AACArB,MAAAA,iBAAiB,CAACqB,cAAD,CAAjB,CAF4B,CAG5B;AACA;AACA;;AACA,UAAIzB,YAAY,CAACyB,cAAD,CAAhB,EAAkC;AAC9B,eAAO,KAAP;AACH;;AACD,WAAKY,gBAAL,CAAsBH,YAAtB;AACH;;AACD,WAAO,IAAP;AACH;;AACDtC,EAAAA,cAAc,CAACsC,YAAD,EAAerP,GAAf,EAAoB8O,UAApB,EAAgC;AAC1C,UAAM;AAAEF,MAAAA,cAAF;AAAkBD,MAAAA,QAAQ,EAAE;AAAE2C,QAAAA,YAAF;AAAgB5B,QAAAA;AAAhB;AAA5B,QAAiE,IAAvE;;AACA,QAAI1P,GAAG,KAAK0P,cAAR,IAA0B,CAAClC,cAAc,CAACxS,IAAf,CAAoB4T,cAApB,EAAoC5O,GAApC,CAA/B,EAAyE;AACrE;AACA;AACA;AACA;AACA;AACA,aAAO,IAAP;AACH;;AACDgN,IAAAA,oBAAoB,CAAC4B,cAAD,EAAiB5O,GAAjB,EAAsB,KAAK+Q,gBAAL,CAAsBjC,UAAtB,CAAtB,CAApB,CAV0C,CAW1C;;AACA,QAAIA,UAAU,CAACsB,YAAX,KAA4B,KAAhC,EAAuC;AACnC,WAAKhB,8BAAL,CAAoCC,YAApC,EAAkDrP,GAAlD;AACH;;AACDsR,IAAAA,YAAY,CAAC1C,cAAD,EAAiB5O,GAAjB,CAAZ;AACA,WAAO,IAAP;AACH;;AArI+C;;AAwIpD,MAAM2R,WAAW,GAAG,IAAIxD,OAAJ,EAApB;AACA,MAAMyD,WAAW,GAAG,IAAIzD,OAAJ,EAApB;;AACA,MAAM0D,eAAN,SAA8BnD,gBAA9B,CAA+C;AAC3CK,EAAAA,SAAS,CAACrU,KAAD,EAAQ;AACb,WAAO,KAAKiU,QAAL,CAAcmD,gBAAd,CAA+BpX,KAA/B,CAAP;AACH;;AACDwU,EAAAA,UAAU,CAACD,WAAD,EAAc;AACpB,UAAM2B,aAAa,GAAGe,WAAW,CAAClD,GAAZ,CAAgBQ,WAAhB,CAAtB;;AACA,QAAI,CAACjB,WAAW,CAAC4C,aAAD,CAAhB,EAAiC;AAC7B,aAAOA,aAAP;AACH;;AACD,UAAM5H,OAAO,GAAG,IAAhB;;AACA,UAAMyF,GAAG,GAAG,YAAY;AACpB;AACA,aAAOzF,OAAO,CAAC+F,SAAR,CAAkBE,WAAW,CAACjU,IAAZ,CAAiBuT,MAAM,CAAC,IAAD,CAAvB,CAAlB,CAAP;AACH,KAHD;;AAIAoD,IAAAA,WAAW,CAACrD,GAAZ,CAAgBW,WAAhB,EAA6BR,GAA7B;AACA,WAAOA,GAAP;AACH;;AACDU,EAAAA,UAAU,CAACH,WAAD,EAAc;AACpB,UAAM6B,aAAa,GAAGe,WAAW,CAACnD,GAAZ,CAAgBO,WAAhB,CAAtB;;AACA,QAAI,CAAChB,WAAW,CAAC6C,aAAD,CAAhB,EAAiC;AAC7B,aAAOA,aAAP;AACH;;AACD,UAAM7H,OAAO,GAAG,IAAhB;;AACA,UAAMsF,GAAG,GAAG,UAAUwC,CAAV,EAAa;AACrB,UAAI,kBAAyB,YAA7B,EAA2C;AACvC,cAAM;AAAElC,UAAAA;AAAF,YAAqB5F,OAA3B;AACA,cAAM,IAAI0I,KAAJ,CAAW,gDAA+C9C,cAAe,OAAMA,cAAe,iBAA9F,CAAN;AACH;AACJ,KALD;;AAMAgD,IAAAA,WAAW,CAACtD,GAAZ,CAAgBU,WAAhB,EAA6BV,GAA7B;AACA,WAAOA,GAAP;AACH;;AACDA,EAAAA,GAAG,CAACe,YAAD,EAAerP,GAAf,EAAoBtF,KAApB,EAA2B;AAC1B,QAAI,kBAAyB,YAA7B,EAA2C;AACvC,YAAM;AAAEkU,QAAAA;AAAF,UAAqB,IAA3B;AACA,YAAM,IAAI8C,KAAJ,CAAW,iCAAgC1R,GAAG,CAAC8N,QAAJ,EAAe,SAAQc,cAAe,OAAMA,cAAe,iBAAtG,CAAN;AACH;;AACD,WAAO,KAAP;AACH;;AACD4C,EAAAA,cAAc,CAACnC,YAAD,EAAerP,GAAf,EAAoB;AAC9B,QAAI,kBAAyB,YAA7B,EAA2C;AACvC,YAAM;AAAE4O,QAAAA;AAAF,UAAqB,IAA3B;AACA,YAAM,IAAI8C,KAAJ,CAAW,oCAAmC1R,GAAG,CAAC8N,QAAJ,EAAe,SAAQc,cAAe,OAAMA,cAAe,iBAAzG,CAAN;AACH;;AACD,WAAO,KAAP;AACH;;AACD6C,EAAAA,cAAc,CAACpC,YAAD,EAAezB,SAAf,EAA0B;AACpC,QAAI,kBAAyB,YAA7B,EAA2C;AACvC,YAAM;AAAEgB,QAAAA;AAAF,UAAqB,IAA3B;AACA,YAAM,IAAI8C,KAAJ,CAAW,wDAAuD9C,cAAe,OAAMA,cAAe,2BAAtG,CAAN;AACH;AACJ;;AACDrB,EAAAA,iBAAiB,CAAC8B,YAAD,EAAe;AAC5B,QAAI,kBAAyB,YAA7B,EAA2C;AACvC,YAAM;AAAET,QAAAA;AAAF,UAAqB,IAA3B;AACA,YAAM,IAAI8C,KAAJ,CAAW,iDAAgD9C,cAAe,OAAMA,cAAe,gBAA/F,CAAN;AACH;;AACD,WAAO,KAAP;AACH;;AACD7B,EAAAA,cAAc,CAACsC,YAAD,EAAerP,GAAf,EAAoB8O,UAApB,EAAgC;AAC1C,QAAI,kBAAyB,YAA7B,EAA2C;AACvC,YAAM;AAAEF,QAAAA;AAAF,UAAqB,IAA3B;AACA,YAAM,IAAI8C,KAAJ,CAAW,4CAA2C1R,GAAG,CAAC8N,QAAJ,EAAe,SAAQc,cAAe,OAAMA,cAAe,iBAAjH,CAAN;AACH;;AACD,WAAO,KAAP;AACH;;AAjE0C;;AAoE/C,SAASmD,OAAT,CAAiBC,aAAjB,EAAgC;AAC5B,MAAI5O,OAAO,CAAC4O,aAAD,CAAX,EAA4B;AACxB,WAAOA,aAAa,CAAC3V,GAAd,CAAmB4H,IAAD,IAAU;AAC/B,YAAMgO,QAAQ,GAAG1D,MAAM,CAACtK,IAAD,CAAvB;;AACA,UAAIgO,QAAQ,KAAKhO,IAAjB,EAAuB;AACnB,eAAO8N,OAAO,CAACE,QAAD,CAAd;AACH;;AACD,aAAOhO,IAAP;AACH,KANM,CAAP;AAOH;;AACD,QAAM8J,GAAG,GAAGjB,YAAY,CAACxR,cAAc,CAAC0W,aAAD,CAAf,CAAxB;AACA,QAAME,KAAK,GAAG7E,mBAAmB,CAAC2E,aAAD,CAAjC;AACA,SAAOtE,WAAW,CAAC1S,IAAZ,CAAiBkX,KAAjB,EAAwB5E,qBAAqB,CAAC0E,aAAD,CAA7C,EACFG,MADE,CACK,CAACC,IAAD,EAAOpS,GAAP,KAAe;AACvB,UAAMiE,IAAI,GAAG+N,aAAa,CAAChS,GAAD,CAA1B;AACA,UAAMiS,QAAQ,GAAG1D,MAAM,CAACtK,IAAD,CAAvB;;AACA,QAAIgO,QAAQ,KAAKhO,IAAjB,EAAuB;AACnBmO,MAAAA,IAAI,CAACpS,GAAD,CAAJ,GAAY+R,OAAO,CAACE,QAAD,CAAnB;AACH,KAFD,MAGK;AACDG,MAAAA,IAAI,CAACpS,GAAD,CAAJ,GAAYiE,IAAZ;AACH;;AACD,WAAOmO,IAAP;AACH,GAXM,EAWJrE,GAXI,CAAP;AAYH;;AACD,MAAMsE,SAAS,GAAG;AACdC,EAAAA,MAAM,EAAGC,YAAD,IAAkB;AACtB,UAAM3D,cAAc,GAAGL,MAAM,CAACgE,YAAD,CAA7B,CADsB,CAEtB;;AACA,QAAI,CAAC3D,cAAD,IAAmBA,cAAc,KAAK2D,YAA1C,EAAwD;AACpD,aAAO,IAAP;AACH;;AACD,UAAMxE,GAAG,GAAGgE,OAAO,CAACQ,YAAD,CAAnB;AACA,WAAO,CAAC,QAAD,EAAW;AAAEC,MAAAA,MAAM,EAAEzE;AAAV,KAAX,CAAP;AACH,GATa;AAUd0E,EAAAA,OAAO,EAAE,MAAM;AACX,WAAO,KAAP;AACH,GAZa;AAadjJ,EAAAA,IAAI,EAAE,MAAM;AACR,WAAO,IAAP;AACH;AAfa,CAAlB,EAiBA;AACA;;AACA,SAASkJ,SAAT,GAAqB;AACjB;AACA;AACA,MAAI,OAAOC,UAAP,KAAsB,WAA1B,EAAuC;AACnC,WAAOA,UAAP;AACH;;AACD,MAAI,OAAOtH,IAAP,KAAgB,WAApB,EAAiC;AAC7B,WAAOA,IAAP;AACH;;AACD,MAAI,OAAO9B,MAAP,KAAkB,WAAtB,EAAmC;AAC/B,WAAOA,MAAP;AACH;;AACD,MAAI,OAAOqJ,MAAP,KAAkB,WAAtB,EAAmC;AAC/B,WAAOA,MAAP;AACH,GAdgB,CAejB;;;AACA,SAAO,EAAP;AACH;;AACD,SAASC,IAAT,GAAgB;AACZ,MAAI,kBAAyB,YAA7B,EAA2C;AACvC;AACA,UAAM,IAAIC,cAAJ,EAAN;AACH;;AACD,QAAMF,MAAM,GAAGF,SAAS,EAAxB,CALY,CAMZ;AACA;AACA;AACA;;AACA,QAAMK,kBAAkB,GAAGH,MAAM,CAACG,kBAAP,IAA6B,EAAxD;AACAtF,EAAAA,SAAS,CAACzS,IAAV,CAAe+X,kBAAf,EAAmCV,SAAnC;AACAO,EAAAA,MAAM,CAACG,kBAAP,GAA4BA,kBAA5B;AACH;;AAED,IAAI,kBAAyB,YAA7B,EAA2C;AACvCF,EAAAA,IAAI;AACP;;AACD,MAAMG,kBAAkB,GAAG1Y,MAAM,CAACsT,SAAlC;;AACA,SAASqF,wBAAT,CAAkCvY,KAAlC,EAAyC;AACrC;AACA,MAAIA,KAAK,KAAK,IAAd,EAAoB;AAChB,WAAO,KAAP;AACH,GAJoC,CAKrC;;;AACA,MAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC3B,WAAO,KAAP;AACH;;AACD,MAAI0I,OAAO,CAAC1I,KAAD,CAAX,EAAoB;AAChB,WAAO,IAAP;AACH;;AACD,QAAMwY,KAAK,GAAG5X,cAAc,CAACZ,KAAD,CAA5B;AACA,SAAQwY,KAAK,KAAKF,kBAAV,IAAgCE,KAAK,KAAK,IAA1C,IAAkD5X,cAAc,CAAC4X,KAAD,CAAd,KAA0B,IAApF;AACH;;AACD,MAAMC,oBAAoB,GAAG,CAACpF,GAAD,EAAM/N,GAAN,KAAc;AACvC;AACH,CAFD;;AAGA,MAAMoT,mBAAmB,GAAG,CAACrF,GAAD,EAAM/N,GAAN,KAAc;AACtC;AACH,CAFD;;AAGA,MAAMqT,sBAAsB,GAAI3Y,KAAD,IAAWA,KAA1C;;AACA,SAAS4Y,kBAAT,CAA4B5Y,KAA5B,EAAmC;AAC/B,SAAO0I,OAAO,CAAC1I,KAAD,CAAP,GAAiB,EAAjB,GAAsB,EAA7B;AACH;;AACD,MAAM6Y,gBAAN,CAAuB;AACnBhY,EAAAA,WAAW,CAAC6L,OAAD,EAAU;AACjB,SAAKoM,eAAL,GAAuBH,sBAAvB;AACA,SAAK/B,YAAL,GAAoB8B,mBAApB;AACA,SAAKrD,aAAL,GAAqBoD,oBAArB;AACA,SAAKM,iBAAL,GAAyBR,wBAAzB;AACA,SAAKS,WAAL,GAAmB,IAAIvF,OAAJ,EAAnB;;AACA,QAAI,CAACH,WAAW,CAAC5G,OAAD,CAAhB,EAA2B;AACvB,YAAM;AAAEoM,QAAAA,eAAF;AAAmBlC,QAAAA,YAAnB;AAAiCvB,QAAAA,aAAjC;AAAgD0D,QAAAA,iBAAhD;AAAmE/D,QAAAA;AAAnE,UAAsFtI,OAA5F;AACA,WAAKoM,eAAL,GAAuBvF,UAAU,CAACuF,eAAD,CAAV,GAA8BA,eAA9B,GAAgDH,sBAAvE;AACA,WAAK/B,YAAL,GAAoBrD,UAAU,CAACqD,YAAD,CAAV,GAA2BA,YAA3B,GAA0C8B,mBAA9D;AACA,WAAKrD,aAAL,GAAqB9B,UAAU,CAAC8B,aAAD,CAAV,GAA4BA,aAA5B,GAA4CoD,oBAAjE;AACA,WAAKM,iBAAL,GAAyBxF,UAAU,CAACwF,iBAAD,CAAV,GAAgCA,iBAAhC,GAAoDR,wBAA7E;AACA,WAAKvD,cAAL,GAAsBA,cAAtB;AACH;AACJ;;AACDiB,EAAAA,QAAQ,CAACjW,KAAD,EAAQ;AACZ,UAAMiZ,cAAc,GAAGpF,MAAM,CAAC7T,KAAD,CAA7B;AACA,UAAMkZ,SAAS,GAAG,KAAKJ,eAAL,CAAqBG,cAArB,CAAlB;;AACA,QAAI,KAAKF,iBAAL,CAAuBG,SAAvB,CAAJ,EAAuC;AACnC,YAAMC,CAAC,GAAG,KAAKC,gBAAL,CAAsBH,cAAtB,EAAsCC,SAAtC,CAAV,CADmC,CAEnC;AACA;;AACA,aAAOC,CAAC,CAACE,QAAF,KAAerZ,KAAf,GAAuBA,KAAvB,GAA+BmZ,CAAC,CAACG,QAAxC;AACH;;AACD,WAAOJ,SAAP;AACH;;AACD9B,EAAAA,gBAAgB,CAACpX,KAAD,EAAQ;AACpBA,IAAAA,KAAK,GAAG6T,MAAM,CAAC7T,KAAD,CAAd;AACA,UAAMkZ,SAAS,GAAG,KAAKJ,eAAL,CAAqB9Y,KAArB,CAAlB;;AACA,QAAI,KAAK+Y,iBAAL,CAAuBG,SAAvB,CAAJ,EAAuC;AACnC,aAAO,KAAKE,gBAAL,CAAsBpZ,KAAtB,EAA6BkZ,SAA7B,EAAwCG,QAA/C;AACH;;AACD,WAAOH,SAAP;AACH;;AACDK,EAAAA,WAAW,CAACC,CAAD,EAAI;AACX,WAAO3F,MAAM,CAAC2F,CAAD,CAAb;AACH;;AACDJ,EAAAA,gBAAgB,CAACpZ,KAAD,EAAQyZ,cAAR,EAAwB;AACpC,UAAM;AAAET,MAAAA;AAAF,QAAmB,IAAzB;AACA,QAAIU,aAAa,GAAGV,WAAW,CAACjF,GAAZ,CAAgB0F,cAAhB,CAApB;;AACA,QAAIC,aAAJ,EAAmB;AACf,aAAOA,aAAP;AACH;;AACD,UAAMzF,QAAQ,GAAG,IAAjB;AACAyF,IAAAA,aAAa,GAAG;AACZ,UAAIJ,QAAJ,GAAe;AACX,cAAMK,eAAe,GAAG,IAAI3D,oBAAJ,CAAyB/B,QAAzB,EAAmCwF,cAAnC,CAAxB,CADW,CAEX;;AACA,cAAM9F,KAAK,GAAG,IAAIiG,KAAJ,CAAUhB,kBAAkB,CAACa,cAAD,CAA5B,EAA8CE,eAA9C,CAAd;AACAjG,QAAAA,aAAa,CAACC,KAAD,EAAQ3T,KAAR,CAAb;AACAsS,QAAAA,oBAAoB,CAAC,IAAD,EAAO,UAAP,EAAmB;AAAEtS,UAAAA,KAAK,EAAE2T;AAAT,SAAnB,CAApB;AACA,eAAOA,KAAP;AACH,OARW;;AASZ,UAAI0F,QAAJ,GAAe;AACX,cAAMQ,eAAe,GAAG,IAAI1C,eAAJ,CAAoBlD,QAApB,EAA8BwF,cAA9B,CAAxB,CADW,CAEX;;AACA,cAAM9F,KAAK,GAAG,IAAIiG,KAAJ,CAAUhB,kBAAkB,CAACa,cAAD,CAA5B,EAA8CI,eAA9C,CAAd;AACAnG,QAAAA,aAAa,CAACC,KAAD,EAAQ3T,KAAR,CAAb;AACAsS,QAAAA,oBAAoB,CAAC,IAAD,EAAO,UAAP,EAAmB;AAAEtS,UAAAA,KAAK,EAAE2T;AAAT,SAAnB,CAApB;AACA,eAAOA,KAAP;AACH;;AAhBW,KAAhB;AAkBAqF,IAAAA,WAAW,CAACpF,GAAZ,CAAgB6F,cAAhB,EAAgCC,aAAhC;AACA,WAAOA,aAAP;AACH;;AAjEkB;;eAoERb;AACf;;;;;;;;;;;;AClhBA;;;;AAEO,SAASiB,IAAT,CAAcC,IAAd,EAAoBC,gBAApB,EAAsC;AACzC;AACA;;AACA;AAGA,MAAI/F,QAAQ,GAAG,IAAIgG,2BAAJ,CAAuB;AAClCrD,IAAAA,YAAY,CAACpI,MAAD,EAASlJ,GAAT,EAAc;AACtB0U,MAAAA,gBAAgB,CAACxL,MAAD,EAASlJ,GAAT,CAAhB;AACH;;AAHiC,GAAvB,CAAf;AAMA,SAAO;AACHyU,IAAAA,IAAI,EAAE9F,QAAQ,CAACgC,QAAT,CAAkB8D,IAAlB,CADH;AAEH9F,IAAAA,QAAQ,EAAEA;AAFP,GAAP;AAIH;;AAEM,SAASJ,MAAT,CAAgBI,QAAhB,EAA0BiG,UAA1B,EAAsC;AACzC,MAAIC,aAAa,GAAGlG,QAAQ,CAACsF,WAAT,CAAqBW,UAArB,CAApB;AACA,MAAIE,IAAI,GAAG,EAAX;AAEAxa,EAAAA,MAAM,CAACY,IAAP,CAAY2Z,aAAZ,EAA2B7Q,OAA3B,CAAmChE,GAAG,IAAI;AACtC,QAAI,CAAC,KAAD,EAAQ,OAAR,EAAiB,WAAjB,EAA8B,QAA9B,EAAwC,MAAxC,EAAgDjI,QAAhD,CAAyDiI,GAAzD,CAAJ,EAAmE;AAEnE8U,IAAAA,IAAI,CAAC9U,GAAD,CAAJ,GAAY6U,aAAa,CAAC7U,GAAD,CAAzB;AACH,GAJD;AAMA,SAAO8U,IAAP;AACH,EAED;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;ACpFA;AACA,IAAIC,OAAO,GAAGC,MAAM,CAACC,OAAP,GAAiB,EAA/B,EAEA;AACA;AACA;AACA;;AAEA,IAAIC,gBAAJ;AACA,IAAIC,kBAAJ;;AAEA,SAASC,gBAAT,GAA4B;AACxB,QAAM,IAAI1D,KAAJ,CAAU,iCAAV,CAAN;AACH;;AACD,SAAS2D,mBAAT,GAAgC;AAC5B,QAAM,IAAI3D,KAAJ,CAAU,mCAAV,CAAN;AACH;;AACA,aAAY;AACT,MAAI;AACA,QAAI,OAAOxX,UAAP,KAAsB,UAA1B,EAAsC;AAClCgb,MAAAA,gBAAgB,GAAGhb,UAAnB;AACH,KAFD,MAEO;AACHgb,MAAAA,gBAAgB,GAAGE,gBAAnB;AACH;AACJ,GAND,CAME,OAAOxa,CAAP,EAAU;AACRsa,IAAAA,gBAAgB,GAAGE,gBAAnB;AACH;;AACD,MAAI;AACA,QAAI,OAAOnb,YAAP,KAAwB,UAA5B,EAAwC;AACpCkb,MAAAA,kBAAkB,GAAGlb,YAArB;AACH,KAFD,MAEO;AACHkb,MAAAA,kBAAkB,GAAGE,mBAArB;AACH;AACJ,GAND,CAME,OAAOza,CAAP,EAAU;AACRua,IAAAA,kBAAkB,GAAGE,mBAArB;AACH;AACJ,CAnBA,GAAD;;AAoBA,SAASC,UAAT,CAAoBC,GAApB,EAAyB;AACrB,MAAIL,gBAAgB,KAAKhb,UAAzB,EAAqC;AACjC;AACA,WAAOA,UAAU,CAACqb,GAAD,EAAM,CAAN,CAAjB;AACH,GAJoB,CAKrB;;;AACA,MAAI,CAACL,gBAAgB,KAAKE,gBAArB,IAAyC,CAACF,gBAA3C,KAAgEhb,UAApE,EAAgF;AAC5Egb,IAAAA,gBAAgB,GAAGhb,UAAnB;AACA,WAAOA,UAAU,CAACqb,GAAD,EAAM,CAAN,CAAjB;AACH;;AACD,MAAI;AACA;AACA,WAAOL,gBAAgB,CAACK,GAAD,EAAM,CAAN,CAAvB;AACH,GAHD,CAGE,OAAM3a,CAAN,EAAQ;AACN,QAAI;AACA;AACA,aAAOsa,gBAAgB,CAACla,IAAjB,CAAsB,IAAtB,EAA4Bua,GAA5B,EAAiC,CAAjC,CAAP;AACH,KAHD,CAGE,OAAM3a,CAAN,EAAQ;AACN;AACA,aAAOsa,gBAAgB,CAACla,IAAjB,CAAsB,IAAtB,EAA4Bua,GAA5B,EAAiC,CAAjC,CAAP;AACH;AACJ;AAGJ;;AACD,SAASC,eAAT,CAAyBC,MAAzB,EAAiC;AAC7B,MAAIN,kBAAkB,KAAKlb,YAA3B,EAAyC;AACrC;AACA,WAAOA,YAAY,CAACwb,MAAD,CAAnB;AACH,GAJ4B,CAK7B;;;AACA,MAAI,CAACN,kBAAkB,KAAKE,mBAAvB,IAA8C,CAACF,kBAAhD,KAAuElb,YAA3E,EAAyF;AACrFkb,IAAAA,kBAAkB,GAAGlb,YAArB;AACA,WAAOA,YAAY,CAACwb,MAAD,CAAnB;AACH;;AACD,MAAI;AACA;AACA,WAAON,kBAAkB,CAACM,MAAD,CAAzB;AACH,GAHD,CAGE,OAAO7a,CAAP,EAAS;AACP,QAAI;AACA;AACA,aAAOua,kBAAkB,CAACna,IAAnB,CAAwB,IAAxB,EAA8Bya,MAA9B,CAAP;AACH,KAHD,CAGE,OAAO7a,CAAP,EAAS;AACP;AACA;AACA,aAAOua,kBAAkB,CAACna,IAAnB,CAAwB,IAAxB,EAA8Bya,MAA9B,CAAP;AACH;AACJ;AAIJ;;AACD,IAAIC,KAAK,GAAG,EAAZ;AACA,IAAIC,QAAQ,GAAG,KAAf;AACA,IAAIC,YAAJ;AACA,IAAIC,UAAU,GAAG,CAAC,CAAlB;;AAEA,SAASC,eAAT,GAA2B;AACvB,MAAI,CAACH,QAAD,IAAa,CAACC,YAAlB,EAAgC;AAC5B;AACH;;AACDD,EAAAA,QAAQ,GAAG,KAAX;;AACA,MAAIC,YAAY,CAAC5N,MAAjB,EAAyB;AACrB0N,IAAAA,KAAK,GAAGE,YAAY,CAAClZ,MAAb,CAAoBgZ,KAApB,CAAR;AACH,GAFD,MAEO;AACHG,IAAAA,UAAU,GAAG,CAAC,CAAd;AACH;;AACD,MAAIH,KAAK,CAAC1N,MAAV,EAAkB;AACd+N,IAAAA,UAAU;AACb;AACJ;;AAED,SAASA,UAAT,GAAsB;AAClB,MAAIJ,QAAJ,EAAc;AACV;AACH;;AACD,MAAIhc,OAAO,GAAG2b,UAAU,CAACQ,eAAD,CAAxB;AACAH,EAAAA,QAAQ,GAAG,IAAX;AAEA,MAAIK,GAAG,GAAGN,KAAK,CAAC1N,MAAhB;;AACA,SAAMgO,GAAN,EAAW;AACPJ,IAAAA,YAAY,GAAGF,KAAf;AACAA,IAAAA,KAAK,GAAG,EAAR;;AACA,WAAO,EAAEG,UAAF,GAAeG,GAAtB,EAA2B;AACvB,UAAIJ,YAAJ,EAAkB;AACdA,QAAAA,YAAY,CAACC,UAAD,CAAZ,CAAyBI,GAAzB;AACH;AACJ;;AACDJ,IAAAA,UAAU,GAAG,CAAC,CAAd;AACAG,IAAAA,GAAG,GAAGN,KAAK,CAAC1N,MAAZ;AACH;;AACD4N,EAAAA,YAAY,GAAG,IAAf;AACAD,EAAAA,QAAQ,GAAG,KAAX;AACAH,EAAAA,eAAe,CAAC7b,OAAD,CAAf;AACH;;AAEDob,OAAO,CAACmB,QAAR,GAAmB,UAAUX,GAAV,EAAe;AAC9B,MAAI1b,IAAI,GAAG,IAAIpC,KAAJ,CAAUqC,SAAS,CAACkO,MAAV,GAAmB,CAA7B,CAAX;;AACA,MAAIlO,SAAS,CAACkO,MAAV,GAAmB,CAAvB,EAA0B;AACtB,SAAK,IAAIpL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG9C,SAAS,CAACkO,MAA9B,EAAsCpL,CAAC,EAAvC,EAA2C;AACvC/C,MAAAA,IAAI,CAAC+C,CAAC,GAAG,CAAL,CAAJ,GAAc9C,SAAS,CAAC8C,CAAD,CAAvB;AACH;AACJ;;AACD8Y,EAAAA,KAAK,CAACnN,IAAN,CAAW,IAAI4N,IAAJ,CAASZ,GAAT,EAAc1b,IAAd,CAAX;;AACA,MAAI6b,KAAK,CAAC1N,MAAN,KAAiB,CAAjB,IAAsB,CAAC2N,QAA3B,EAAqC;AACjCL,IAAAA,UAAU,CAACS,UAAD,CAAV;AACH;AACJ,CAXD,EAaA;;;AACA,SAASI,IAAT,CAAcZ,GAAd,EAAmB/d,KAAnB,EAA0B;AACtB,OAAK+d,GAAL,GAAWA,GAAX;AACA,OAAK/d,KAAL,GAAaA,KAAb;AACH;;AACD2e,IAAI,CAACvI,SAAL,CAAeqI,GAAf,GAAqB,YAAY;AAC7B,OAAKV,GAAL,CAASvb,KAAT,CAAe,IAAf,EAAqB,KAAKxC,KAA1B;AACH,CAFD;;AAGAud,OAAO,CAACqB,KAAR,GAAgB,SAAhB;AAEArB,OAAO,CAACsB,GAAR,GAAc,EAAd;AACAtB,OAAO,CAACuB,IAAR,GAAe,EAAf;AACAvB,OAAO,CAACwB,OAAR,GAAkB,EAAlB,EAAsB;;AACtBxB,OAAO,CAACyB,QAAR,GAAmB,EAAnB;;AAEA,SAASC,IAAT,GAAgB,CAAE;;AAElB1B,OAAO,CAAC2B,EAAR,GAAaD,IAAb;AACA1B,OAAO,CAAC4B,WAAR,GAAsBF,IAAtB;AACA1B,OAAO,CAAClS,IAAR,GAAe4T,IAAf;AACA1B,OAAO,CAAC6B,GAAR,GAAcH,IAAd;AACA1B,OAAO,CAAC8B,cAAR,GAAyBJ,IAAzB;AACA1B,OAAO,CAAC+B,kBAAR,GAA6BL,IAA7B;AACA1B,OAAO,CAACgC,IAAR,GAAeN,IAAf;AACA1B,OAAO,CAACiC,eAAR,GAA0BP,IAA1B;AACA1B,OAAO,CAACkC,mBAAR,GAA8BR,IAA9B;;AAEA1B,OAAO,CAACmC,SAAR,GAAoB,UAAUtb,IAAV,EAAgB;AAAE,SAAO,EAAP;AAAW,CAAjD;;AAEAmZ,OAAO,CAACoC,OAAR,GAAkB,UAAUvb,IAAV,EAAgB;AAC9B,QAAM,IAAI8V,KAAJ,CAAU,kCAAV,CAAN;AACH,CAFD;;AAIAqD,OAAO,CAACqC,GAAR,GAAc,YAAY;AAAE,SAAO,GAAP;AAAY,CAAxC;;AACArC,OAAO,CAACsC,KAAR,GAAgB,UAAUC,GAAV,EAAe;AAC3B,QAAM,IAAI5F,KAAJ,CAAU,gCAAV,CAAN;AACH,CAFD;;AAGAqD,OAAO,CAACwC,KAAR,GAAgB,YAAW;AAAE,SAAO,CAAP;AAAW,CAAxC;;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AC9SA;;AACe,MAAMC,GAAN,CAAU;AACvBjc,EAAAA,WAAW,CAACkc,WAAD,EAAcC,QAAd,EAAwB;AACjC,SAAKD,WAAL,GAAmBA,WAAnB;AACA,SAAKC,QAAL,GAAgBA,QAAhB;AACA,SAAK1N,aAAL,GAAqB,KAArB;AACD;;AACDhP,EAAAA,IAAI,CAAC2c,UAAD,EAAa,GAAGC,MAAhB,EAAwB;AAC1B,SAAK5N,aAAL,GAAqB,IAArB;AAEA,QAAI6N,MAAM,GAAG,EAAb;AACA,QAAIhe,IAA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","file":"jembe.js","sourceRoot":"../../src/js","sourcesContent":["\n// Thanks @stimulus:\n// https://github.com/stimulusjs/stimulus/blob/master/packages/%40stimulus/core/src/application.ts\nexport function domReady() {\n    return new Promise(resolve => {\n        if (document.readyState == \"loading\") {\n            document.addEventListener(\"DOMContentLoaded\", resolve)\n        } else {\n            resolve()\n        }\n    })\n}\n\nexport function arrayUnique(array) {\n    return Array.from(new Set(array))\n}\n\nexport function isTesting() {\n    return navigator.userAgent, navigator.userAgent.includes(\"Node.js\")\n        || navigator.userAgent.includes(\"jsdom\")\n}\n\nexport function checkedAttrLooseCompare(valueA, valueB) {\n    return valueA == valueB\n}\n\nexport function warnIfMalformedTemplate(el, directive) {\n    if (el.tagName.toLowerCase() !== 'template') {\n        console.warn(`Alpine: [${directive}] directive should only be added to <template> tags. See https://github.com/alpinejs/alpine#${directive}`)\n    } else if (el.content.childElementCount !== 1) {\n        console.warn(`Alpine: <template> tag with [${directive}] encountered with an unexpected number of root elements. Make sure <template> has a single root element. `)\n    }\n}\n\nexport function kebabCase(subject) {\n    return subject.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[_\\s]/, '-').toLowerCase()\n}\n\nexport function camelCase(subject) {\n    return subject.toLowerCase().replace(/-(\\w)/g, (match, char) => char.toUpperCase())\n}\n\nexport function walk(el, callback) {\n    if (callback(el) === false) return\n\n    let node = el.firstElementChild\n\n    while (node) {\n        walk(node, callback)\n\n        node = node.nextElementSibling\n    }\n}\n\nexport function debounce(func, wait) {\n    var timeout\n    return function () {\n        var context = this, args = arguments\n        var later = function () {\n            timeout = null\n            func.apply(context, args)\n        }\n        clearTimeout(timeout)\n        timeout = setTimeout(later, wait)\n    }\n}\n\nconst handleError = (el, expression, error) => {\n    console.warn(`Jembe Error: \"${error}\"\\n\\nExpression: \"${expression}\"\\nElement:`, el);\n\n    if (! isTesting()) {\n        Object.assign(error, { el, expression })\n        throw error;\n    }\n}\n\nfunction tryCatch(cb, { el, expression }) {\n    try {\n        const value = cb();\n        return value instanceof Promise\n            ? value.catch((e) => handleError(el, expression, e))\n            : value;\n    } catch (e) {\n        handleError(el, expression, e)\n    }\n}\n\nexport function saferEval(el, expression, dataContext, additionalHelperVariables = {}) {\n    return tryCatch(() => {\n        if (typeof expression === 'function') {\n            return expression.call(dataContext)\n        }\n\n        return (new Function(['$data', ...Object.keys(additionalHelperVariables)], `var __alpine_result; with($data) { __alpine_result = ${expression} }; return __alpine_result`))(\n            dataContext, ...Object.values(additionalHelperVariables)\n        )\n    }, { el, expression })\n}\n\nexport function saferEvalNoReturn(el, expression, dataContext, additionalHelperVariables = {}) {\n    return tryCatch(() => {\n        if (typeof expression === 'function') {\n            return Promise.resolve(expression.call(dataContext, additionalHelperVariables['$event']))\n        }\n\n        let AsyncFunction = Function\n\n        /* MODERN-ONLY:START */\n            AsyncFunction = Object.getPrototypeOf(async function(){}).constructor\n        /* MODERN-ONLY:END */\n\n        // For the cases when users pass only a function reference to the caller: `jmb-on:click=\"foo\"`\n        // Where \"foo\" is a function. Also, we'll pass the function the event instance when we call it.\n        if (Object.keys(dataContext).includes(expression)) {\n            let methodReference = (new Function(['dataContext', ...Object.keys(additionalHelperVariables)], `with(dataContext) { return ${expression} }`))(\n                dataContext, ...Object.values(additionalHelperVariables)\n            )\n\n            if (typeof methodReference === 'function') {\n                return Promise.resolve(methodReference.call(dataContext, additionalHelperVariables['$event']))\n            } else {\n                return Promise.resolve()\n            }\n        }\n\n        return Promise.resolve((new AsyncFunction(['dataContext', ...Object.keys(additionalHelperVariables)], `with(dataContext) { ${expression} }`))(\n            dataContext, ...Object.values(additionalHelperVariables)\n        ))\n    }, { el, expression })\n}\n\nconst xAttrRE = /^jmb-(on|bind|data|text|html|model|if|for|show|cloak|transition|ref|spread)\\b/\n\nexport function isXAttr(attr) {\n    const name = replaceAtAndColonWithStandardSyntax(attr.name)\n\n    return xAttrRE.test(name)\n}\n\nexport function getXAttrs(el, component, type) {\n    let directives = Array.from(el.attributes).filter(isXAttr).map(parseHtmlAttribute)\n\n    // Get an object of directives from jmb-spread.\n    let spreadDirective = directives.filter(directive => directive.type === 'spread')[0]\n\n    if (spreadDirective) {\n        let spreadObject = saferEval(el, spreadDirective.expression, component.$data)\n\n        // Add jmb-spread directives to the pile of existing directives.\n        directives = directives.concat(Object.entries(spreadObject).map(([name, value]) => parseHtmlAttribute({ name, value })))\n    }\n\n    if (type) return directives.filter(i => i.type === type)\n\n    return sortDirectives(directives)\n}\n\nfunction sortDirectives(directives) {\n    let directiveOrder = ['bind', 'model', 'show', 'catch-all']\n\n    return directives.sort((a, b) => {\n        let typeA = directiveOrder.indexOf(a.type) === -1 ? 'catch-all' : a.type\n        let typeB = directiveOrder.indexOf(b.type) === -1 ? 'catch-all' : b.type\n\n        return directiveOrder.indexOf(typeA) - directiveOrder.indexOf(typeB)\n    })\n}\n\nexport function parseHtmlAttribute({ name, value }) {\n    const normalizedName = replaceAtAndColonWithStandardSyntax(name)\n\n    const typeMatch = normalizedName.match(xAttrRE)\n    const valueMatch = normalizedName.match(/:([a-zA-Z0-9\\-:]+)/)\n    const modifiers = normalizedName.match(/\\.[^.\\]]+(?=[^\\]]*$)/g) || []\n\n    return {\n        type: typeMatch ? typeMatch[1] : null,\n        value: valueMatch ? valueMatch[1] : null,\n        modifiers: modifiers.map(i => i.replace('.', '')),\n        expression: value,\n    }\n}\n\nexport function isBooleanAttr(attrName) {\n    // As per HTML spec table https://html.spec.whatwg.org/multipage/indices.html#attributes-3:boolean-attribute\n    // Array roughly ordered by estimated usage\n    const booleanAttributes = [\n        'disabled','checked','required','readonly','hidden','open', 'selected',\n        'autofocus', 'itemscope', 'multiple', 'novalidate','allowfullscreen',\n        'allowpaymentrequest', 'formnovalidate', 'autoplay', 'controls', 'loop',\n        'muted', 'playsinline', 'default', 'ismap', 'reversed', 'async', 'defer',\n        'nomodule'\n    ]\n\n    return booleanAttributes.includes(attrName)\n}\n\nexport function replaceAtAndColonWithStandardSyntax(name) {\n    if (name.startsWith('@')) {\n        return name.replace('@', 'jmb-on:')\n    } else if (name.startsWith(':')) {\n        return name.replace(':', 'jmb-bind:')\n    }\n\n    return name\n}\n\nexport function convertClassStringToArray(classList, filterFn = Boolean) {\n    return classList.split(' ').filter(filterFn)\n}\n\nexport const TRANSITION_TYPE_IN = 'in'\nexport const TRANSITION_TYPE_OUT = 'out'\nexport const TRANSITION_CANCELLED = 'cancelled'\n\nexport function transitionIn(el, show, reject, component, forceSkip = false) {\n    // We don't want to transition on the initial page load.\n    if (forceSkip) return show()\n\n    if (el.__jmb_transition && el.__jmb_transition.type === TRANSITION_TYPE_IN) {\n        // there is already a similar transition going on, this was probably triggered by\n        // a change in a different property, let's just leave the previous one doing its job\n        return\n    }\n\n    const attrs = getXAttrs(el, component, 'transition')\n    const showAttr = getXAttrs(el, component, 'show')[0]\n\n    // If this is triggered by a jmb-show.transition.\n    if (showAttr && showAttr.modifiers.includes('transition')) {\n        let modifiers = showAttr.modifiers\n\n        // If jmb-show.transition.out, we'll skip the \"in\" transition.\n        if (modifiers.includes('out') && ! modifiers.includes('in')) return show()\n\n        const settingBothSidesOfTransition = modifiers.includes('in') && modifiers.includes('out')\n\n        // If jmb-show.transition.in...out... only use \"in\" related modifiers for this transition.\n        modifiers = settingBothSidesOfTransition\n            ? modifiers.filter((i, index) => index < modifiers.indexOf('out')) : modifiers\n\n        transitionHelperIn(el, modifiers, show, reject)\n    // Otherwise, we can assume jmb-transition:enter.\n    } else if (attrs.some(attr => ['enter', 'enter-start', 'enter-end'].includes(attr.value))) {\n        transitionClassesIn(el, component, attrs, show, reject)\n    } else {\n    // If neither, just show that damn thing.\n        show()\n    }\n}\n\nexport function transitionOut(el, hide, reject, component, forceSkip = false) {\n    // We don't want to transition on the initial page load.\n    if (forceSkip) return hide()\n\n    if (el.__jmb_transition && el.__jmb_transition.type === TRANSITION_TYPE_OUT) {\n        // there is already a similar transition going on, this was probably triggered by\n        // a change in a different property, let's just leave the previous one doing its job\n        return\n    }\n\n    const attrs = getXAttrs(el, component, 'transition')\n    const showAttr = getXAttrs(el, component, 'show')[0]\n\n    if (showAttr && showAttr.modifiers.includes('transition')) {\n        let modifiers = showAttr.modifiers\n\n        if (modifiers.includes('in') && ! modifiers.includes('out')) return hide()\n\n        const settingBothSidesOfTransition = modifiers.includes('in') && modifiers.includes('out')\n\n        modifiers = settingBothSidesOfTransition\n            ? modifiers.filter((i, index) => index > modifiers.indexOf('out')) : modifiers\n\n        transitionHelperOut(el, modifiers, settingBothSidesOfTransition, hide, reject)\n    } else if (attrs.some(attr => ['leave', 'leave-start', 'leave-end'].includes(attr.value))) {\n        transitionClassesOut(el, component, attrs, hide, reject)\n    } else {\n        hide()\n    }\n}\n\nexport function transitionHelperIn(el, modifiers, showCallback, reject) {\n    // Default values inspired by: https://material.io/design/motion/speed.html#duration\n    const styleValues = {\n        duration: modifierValue(modifiers, 'duration', 150),\n        origin: modifierValue(modifiers, 'origin', 'center'),\n        first: {\n            opacity: 0,\n            scale: modifierValue(modifiers, 'scale', 95),\n        },\n        second: {\n            opacity: 1,\n            scale: 100,\n        },\n    }\n\n    transitionHelper(el, modifiers, showCallback, () => {}, reject, styleValues, TRANSITION_TYPE_IN)\n}\n\nexport function transitionHelperOut(el, modifiers, settingBothSidesOfTransition, hideCallback, reject) {\n    // Make the \"out\" transition .5x slower than the \"in\". (Visually better)\n    // HOWEVER, if they explicitly set a duration for the \"out\" transition,\n    // use that.\n    const duration = settingBothSidesOfTransition\n        ? modifierValue(modifiers, 'duration', 150)\n        : modifierValue(modifiers, 'duration', 150) / 2\n\n    const styleValues = {\n        duration: duration,\n        origin: modifierValue(modifiers, 'origin', 'center'),\n        first: {\n            opacity: 1,\n            scale: 100,\n        },\n        second: {\n            opacity: 0,\n            scale: modifierValue(modifiers, 'scale', 95),\n        },\n    }\n\n    transitionHelper(el, modifiers, () => {}, hideCallback, reject, styleValues, TRANSITION_TYPE_OUT)\n}\n\nfunction modifierValue(modifiers, key, fallback) {\n    // If the modifier isn't present, use the default.\n    if (modifiers.indexOf(key) === -1) return fallback\n\n    // If it IS present, grab the value after it: jmb-show.transition.duration.500ms\n    const rawValue = modifiers[modifiers.indexOf(key) + 1]\n\n    if (! rawValue) return fallback\n\n    if (key === 'scale') {\n        // Check if the very next value is NOT a number and return the fallback.\n        // If jmb-show.transition.scale, we'll use the default scale value.\n        // That is how a user opts out of the opacity transition.\n        if (! isNumeric(rawValue)) return fallback\n    }\n\n    if (key === 'duration') {\n        // Support jmb-show.transition.duration.500ms && duration.500\n        let match = rawValue.match(/([0-9]+)ms/)\n        if (match) return match[1]\n    }\n\n    if (key === 'origin') {\n        // Support chaining origin directions: jmb-show.transition.top.right\n        if (['top', 'right', 'left', 'center', 'bottom'].includes(modifiers[modifiers.indexOf(key) + 2])) {\n            return [rawValue, modifiers[modifiers.indexOf(key) + 2]].join(' ')\n        }\n    }\n\n    return rawValue\n}\n\nexport function transitionHelper(el, modifiers, hook1, hook2, reject, styleValues, type) {\n    // clear the previous transition if exists to avoid caching the wrong styles\n    if (el.__jmb_transition) {\n        el.__jmb_transition.cancel && el.__jmb_transition.cancel()\n    }\n\n    // If the user set these style values, we'll put them back when we're done with them.\n    const opacityCache = el.style.opacity\n    const transformCache = el.style.transform\n    const transformOriginCache = el.style.transformOrigin\n\n    // If no modifiers are present: jmb-show.transition, we'll default to both opacity and scale.\n    const noModifiers = ! modifiers.includes('opacity') && ! modifiers.includes('scale')\n    const transitionOpacity = noModifiers || modifiers.includes('opacity')\n    const transitionScale = noModifiers || modifiers.includes('scale')\n\n    // These are the explicit stages of a transition (same stages for in and for out).\n    // This way you can get a birds eye view of the hooks, and the differences\n    // between them.\n    const stages = {\n        start() {\n            if (transitionOpacity) el.style.opacity = styleValues.first.opacity\n            if (transitionScale) el.style.transform = `scale(${styleValues.first.scale / 100})`\n        },\n        during() {\n            if (transitionScale) el.style.transformOrigin = styleValues.origin\n            el.style.transitionProperty = [(transitionOpacity ? `opacity` : ``), (transitionScale ? `transform` : ``)].join(' ').trim()\n            el.style.transitionDuration = `${styleValues.duration / 1000}s`\n            el.style.transitionTimingFunction = `cubic-bezier(0.4, 0.0, 0.2, 1)`\n        },\n        show() {\n            hook1()\n        },\n        end() {\n            if (transitionOpacity) el.style.opacity = styleValues.second.opacity\n            if (transitionScale) el.style.transform = `scale(${styleValues.second.scale / 100})`\n        },\n        hide() {\n            hook2()\n        },\n        cleanup() {\n            if (transitionOpacity) el.style.opacity = opacityCache\n            if (transitionScale) el.style.transform = transformCache\n            if (transitionScale) el.style.transformOrigin = transformOriginCache\n            el.style.transitionProperty = null\n            el.style.transitionDuration = null\n            el.style.transitionTimingFunction = null\n        },\n    }\n\n    transition(el, stages, type, reject)\n}\n\nconst ensureStringExpression = (expression, el, component) => {\n    return typeof expression === 'function'\n        ? component.evaluateReturnExpression(el, expression)\n        : expression\n}\n\nexport function transitionClassesIn(el, component, directives, showCallback, reject) {\n    const enter = convertClassStringToArray(ensureStringExpression((directives.find(i => i.value === 'enter') || { expression: '' }).expression, el, component))\n    const enterStart = convertClassStringToArray(ensureStringExpression((directives.find(i => i.value === 'enter-start') || { expression: '' }).expression, el, component))\n    const enterEnd = convertClassStringToArray(ensureStringExpression((directives.find(i => i.value === 'enter-end') || { expression: '' }).expression, el, component))\n\n    transitionClasses(el, enter, enterStart, enterEnd, showCallback, () => {}, TRANSITION_TYPE_IN, reject)\n}\n\nexport function transitionClassesOut(el, component, directives, hideCallback, reject) {\n    const leave = convertClassStringToArray(ensureStringExpression((directives.find(i => i.value === 'leave') || { expression: '' }).expression, el, component))\n    const leaveStart = convertClassStringToArray(ensureStringExpression((directives.find(i => i.value === 'leave-start') || { expression: '' }).expression, el, component))\n    const leaveEnd = convertClassStringToArray(ensureStringExpression((directives.find(i => i.value === 'leave-end') || { expression: '' }).expression, el, component))\n\n    transitionClasses(el, leave, leaveStart, leaveEnd, () => {}, hideCallback, TRANSITION_TYPE_OUT, reject)\n}\n\nexport function transitionClasses(el, classesDuring, classesStart, classesEnd, hook1, hook2, type, reject) {\n    // clear the previous transition if exists to avoid caching the wrong classes\n    if (el.__jmb_transition) {\n        el.__jmb_transition.cancel && el.__jmb_transition.cancel()\n    }\n\n    const originalClasses = el.__jmb_original_classes || []\n\n    const stages = {\n        start() {\n            el.classList.add(...classesStart)\n        },\n        during() {\n            el.classList.add(...classesDuring)\n        },\n        show() {\n            hook1()\n        },\n        end() {\n            // Don't remove classes that were in the original class attribute.\n            el.classList.remove(...classesStart.filter(i => !originalClasses.includes(i)))\n            el.classList.add(...classesEnd)\n        },\n        hide() {\n            hook2()\n        },\n        cleanup() {\n            el.classList.remove(...classesDuring.filter(i => !originalClasses.includes(i)))\n            el.classList.remove(...classesEnd.filter(i => !originalClasses.includes(i)))\n        },\n    }\n\n    transition(el, stages, type, reject)\n}\n\nexport function transition(el, stages, type, reject) {\n    const finish = once(() => {\n        stages.hide()\n\n        // Adding an \"isConnected\" check, in case the callback\n        // removed the element from the DOM.\n        if (el.isConnected) {\n            stages.cleanup()\n        }\n\n        delete el.__jmb_transition\n    })\n\n    el.__jmb_transition = {\n        // Set transition type so we can avoid clearing transition if the direction is the same\n       type: type,\n        // create a callback for the last stages of the transition so we can call it\n        // from different point and early terminate it. Once will ensure that function\n        // is only called one time.\n        cancel: once(() => {\n            reject(TRANSITION_CANCELLED)\n\n            finish()\n        }),\n        finish,\n        // This store the next animation frame so we can cancel it\n        nextFrame: null\n    }\n\n    stages.start()\n    stages.during()\n\n    el.__jmb_transition.nextFrame = requestAnimationFrame(() => {\n        // Note: Safari's transitionDuration property will list out comma separated transition durations\n        // for every single transition property. Let's grab the first one and call it a day.\n        let duration = Number(getComputedStyle(el).transitionDuration.replace(/,.*/, '').replace('s', '')) * 1000\n\n        if (duration === 0) {\n            duration = Number(getComputedStyle(el).animationDuration.replace('s', '')) * 1000\n        }\n\n        stages.show()\n\n        el.__jmb_transition.nextFrame = requestAnimationFrame(() => {\n            stages.end()\n\n            setTimeout(el.__jmb_transition.finish, duration)\n        })\n    });\n}\n\nexport function isNumeric(subject){\n    return ! Array.isArray(subject) && ! isNaN(subject)\n}\n\n// Thanks @vuejs\n// https://github.com/vuejs/vue/blob/4de4649d9637262a9b007720b59f80ac72a5620c/src/shared/util.js\nexport function once(callback) {\n    let called = false\n\n    return function () {\n        if (! called) {\n            called = true\n            callback.apply(this, arguments)\n        }\n    }\n}\n","import { transitionIn, transitionOut, getXAttrs, warnIfMalformedTemplate, isNumeric } from '../utils'\n\nexport function handleForDirective(component, templateEl, expression, initialUpdate, extraVars) {\n    warnIfMalformedTemplate(templateEl, 'jmb-for')\n\n    let iteratorNames = typeof expression === 'function'\n        ? parseForExpression(component.evaluateReturnExpression(templateEl, expression))\n        : parseForExpression(expression)\n\n    let items = evaluateItemsAndReturnEmptyIfXIfIsPresentAndFalseOnElement(component, templateEl, iteratorNames, extraVars)\n\n    // As we walk the array, we'll also walk the DOM (updating/creating as we go).\n    let currentEl = templateEl\n    items.forEach((item, index) => {\n        let iterationScopeVariables = getIterationScopeVariables(iteratorNames, item, index, items, extraVars())\n        let currentKey = generateKeyForIteration(component, templateEl, index, iterationScopeVariables)\n        let nextEl = lookAheadForMatchingKeyedElementAndMoveItIfFound(currentEl.nextElementSibling, currentKey)\n\n        // If we haven't found a matching key, insert the element at the current position.\n        if (! nextEl) {\n            nextEl = addElementInLoopAfterCurrentEl(templateEl, currentEl)\n\n            // And transition it in if it's not the first page load.\n            transitionIn(nextEl, () => {}, () => {}, component, initialUpdate)\n\n            nextEl.__jmb_for = iterationScopeVariables\n            component.initializeElements(nextEl, () => nextEl.__jmb_for)\n        // Otherwise update the element we found.\n        } else {\n            // Temporarily remove the key indicator to allow the normal \"updateElements\" to work.\n            delete nextEl.__jmb_for_key\n\n            nextEl.__jmb_for = iterationScopeVariables\n            component.updateElements(nextEl, () => nextEl.__jmb_for)\n        }\n\n        currentEl = nextEl\n        currentEl.__jmb_for_key = currentKey\n    })\n\n    removeAnyLeftOverElementsFromPreviousUpdate(currentEl, component)\n}\n\n// This was taken from VueJS 2.* core. Thanks Vue!\nfunction parseForExpression(expression) {\n    let forIteratorRE = /,([^,\\}\\]]*)(?:,([^,\\}\\]]*))?$/\n    let stripParensRE = /^\\(|\\)$/g\n    let forAliasRE = /([\\s\\S]*?)\\s+(?:in|of)\\s+([\\s\\S]*)/\n    let inMatch = String(expression).match(forAliasRE)\n    if (! inMatch) return\n    let res = {}\n    res.items = inMatch[2].trim()\n    let item = inMatch[1].trim().replace(stripParensRE, '')\n    let iteratorMatch = item.match(forIteratorRE)\n\n    if (iteratorMatch) {\n        res.item = item.replace(forIteratorRE, '').trim()\n        res.index = iteratorMatch[1].trim()\n\n        if (iteratorMatch[2]) {\n            res.collection = iteratorMatch[2].trim()\n        }\n    } else {\n        res.item = item\n    }\n    return res\n}\n\nfunction getIterationScopeVariables(iteratorNames, item, index, items, extraVars) {\n    // We must create a new object, so each iteration has a new scope\n    let scopeVariables = extraVars ? {...extraVars} : {}\n    scopeVariables[iteratorNames.item] = item\n    if (iteratorNames.index) scopeVariables[iteratorNames.index] = index\n    if (iteratorNames.collection) scopeVariables[iteratorNames.collection] = items\n\n    return scopeVariables\n}\n\nfunction generateKeyForIteration(component, el, index, iterationScopeVariables) {\n    let bindKeyAttribute = getXAttrs(el, component, 'bind').filter(attr => attr.value === 'key')[0]\n\n    // If the dev hasn't specified a key, just return the index of the iteration.\n    if (! bindKeyAttribute) return index\n\n    return component.evaluateReturnExpression(el, bindKeyAttribute.expression, () => iterationScopeVariables)\n}\n\nfunction evaluateItemsAndReturnEmptyIfXIfIsPresentAndFalseOnElement(component, el, iteratorNames, extraVars) {\n    let ifAttribute = getXAttrs(el, component, 'if')[0]\n\n    if (ifAttribute && ! component.evaluateReturnExpression(el, ifAttribute.expression)) {\n        return []\n    }\n\n    let items = component.evaluateReturnExpression(el, iteratorNames.items, extraVars)\n\n    // This adds support for the `i in n` syntax.\n    if (isNumeric(items) && items >= 0) {\n        items = Array.from(Array(items).keys(), i => i + 1)\n    }\n\n    return items\n}\n\nfunction addElementInLoopAfterCurrentEl(templateEl, currentEl) {\n    let clone = document.importNode(templateEl.content, true  )\n\n    currentEl.parentElement.insertBefore(clone, currentEl.nextElementSibling)\n\n    return currentEl.nextElementSibling\n}\n\nfunction lookAheadForMatchingKeyedElementAndMoveItIfFound(nextEl, currentKey) {\n    if (! nextEl) return\n\n    // If we are already past the jmb-for generated elements, we don't need to look ahead.\n    if (nextEl.__jmb_for_key === undefined) return\n\n    // If the the key's DO match, no need to look ahead.\n    if (nextEl.__jmb_for_key === currentKey) return nextEl\n\n    // If they don't, we'll look ahead for a match.\n    // If we find it, we'll move it to the current position in the loop.\n    let tmpNextEl = nextEl\n\n    while(tmpNextEl) {\n        if (tmpNextEl.__jmb_for_key === currentKey) {\n            return tmpNextEl.parentElement.insertBefore(tmpNextEl, nextEl)\n        }\n\n        tmpNextEl = (tmpNextEl.nextElementSibling && tmpNextEl.nextElementSibling.__jmb_for_key !== undefined) ? tmpNextEl.nextElementSibling : false\n    }\n}\n\nfunction removeAnyLeftOverElementsFromPreviousUpdate(currentEl, component) {\n    var nextElementFromOldLoop = (currentEl.nextElementSibling && currentEl.nextElementSibling.__jmb_for_key !== undefined) ? currentEl.nextElementSibling : false\n\n    while (nextElementFromOldLoop) {\n        let nextElementFromOldLoopImmutable = nextElementFromOldLoop\n        let nextSibling = nextElementFromOldLoop.nextElementSibling\n        transitionOut(nextElementFromOldLoop, () => {\n            nextElementFromOldLoopImmutable.remove()\n        }, () => {}, component)\n        nextElementFromOldLoop = (nextSibling && nextSibling.__jmb_for_key !== undefined) ? nextSibling : false\n    }\n}\n","import { arrayUnique, checkedAttrLooseCompare, isBooleanAttr, convertClassStringToArray, camelCase } from '../utils'\nimport Alpine from '../index'\n\nexport function handleAttributeBindingDirective(component, el, attrName, expression, extraVars, attrType, modifiers) {\n    var value = component.evaluateReturnExpression(el, expression, extraVars)\n\n    if (attrName === 'value') {\n        if (Alpine.ignoreFocusedForValueBinding && document.activeElement.isSameNode(el)) return\n\n        // If nested model key is undefined, set the default value to empty string.\n        if (value === undefined && String(expression).match(/\\./)) {\n            value = ''\n        }\n\n        if (el.type === 'radio') {\n            // Set radio value from jmb-bind:value, if no \"value\" attribute exists.\n            // If there are any initial state values, radio will have a correct\n            // \"checked\" value since jmb-bind:value is processed before jmb-model.\n            if (el.attributes.value === undefined && attrType === 'bind') {\n                el.value = value\n            } else if (attrType !== 'bind') {\n                el.checked = checkedAttrLooseCompare(el.value, value)\n            }\n        } else if (el.type === 'checkbox') {\n            // If we are explicitly binding a string to the :value, set the string,\n            // If the value is a boolean, leave it alone, it will be set to \"on\"\n            // automatically.\n            if (typeof value !== 'boolean' && ! [null, undefined].includes(value) && attrType === 'bind') {\n                el.value = String(value)\n            } else if (attrType !== 'bind') {\n                if (Array.isArray(value)) {\n                    // I'm purposely not using Array.includes here because it's\n                    // strict, and because of Numeric/String mis-casting, I\n                    // want the \"includes\" to be \"fuzzy\".\n                    el.checked = value.some(val => checkedAttrLooseCompare(val, el.value))\n                } else {\n                    el.checked = !!value\n                }\n            }\n        } else if (el.tagName === 'SELECT') {\n            updateSelect(el, value)\n        } else {\n            if (el.value === value) return\n\n            el.value = value\n        }\n    } else if (attrName === 'class') {\n        if (Array.isArray(value)) {\n            const originalClasses = el.__jmb_original_classes || []\n            el.setAttribute('class', arrayUnique(originalClasses.concat(value)).join(' '))\n        } else if (typeof value === 'object') {\n            // Sorting the keys / class names by their boolean value will ensure that\n            // anything that evaluates to `false` and needs to remove classes is run first.\n            const keysSortedByBooleanValue = Object.keys(value).sort((a, b) => value[a] - value[b]);\n\n            keysSortedByBooleanValue.forEach(classNames => {\n                if (value[classNames]) {\n                    convertClassStringToArray(classNames).forEach(className => el.classList.add(className))\n                } else {\n                    convertClassStringToArray(classNames).forEach(className => el.classList.remove(className))\n                }\n            })\n        } else {\n            const originalClasses = el.__jmb_original_classes || []\n            const newClasses = value ? convertClassStringToArray(value) : []\n            el.setAttribute('class', arrayUnique(originalClasses.concat(newClasses)).join(' '))\n        }\n    } else {\n        attrName = modifiers.includes('camel') ? camelCase(attrName) : attrName\n\n        // If an attribute's bound value is null, undefined or false, remove the attribute\n        if ([null, undefined, false].includes(value)) {\n            el.removeAttribute(attrName)\n        } else {\n            isBooleanAttr(attrName) ? setIfChanged(el, attrName, attrName) : setIfChanged(el, attrName, value)\n        }\n    }\n}\n\nfunction setIfChanged(el, attrName, value) {\n    if (el.getAttribute(attrName) != value) {\n        el.setAttribute(attrName, value)\n    }\n}\n\nfunction updateSelect(el, value) {\n    const arrayWrappedValue = [].concat(value).map(value => { return value + '' })\n\n    Array.from(el.options).forEach(option => {\n        option.selected = arrayWrappedValue.includes(option.value || option.text)\n    })\n}\n","export function handleTextDirective(el, output, expression) {\n    // If nested model key is undefined, set the default value to empty string.\n    if (output === undefined && String(expression).match(/\\./)) {\n        output = ''\n    }\n\n    el.textContent = output\n}\n","export function handleHtmlDirective(component, el, expression, extraVars) {\n    el.innerHTML = component.evaluateReturnExpression(el, expression, extraVars)\n}\n","import { transitionIn, transitionOut } from '../utils'\n\nexport function handleShowDirective(component, el, value, modifiers, initialUpdate = false) {\n    const hide = () => {\n        el.style.display = 'none'\n        el.__jmb_is_shown = false\n    }\n\n    const show = () => {\n        if (el.style.length === 1 && el.style.display === 'none') {\n            el.removeAttribute('style')\n        } else {\n            el.style.removeProperty('display')\n        }\n\n        el.__jmb_is_shown = true\n    }\n\n    if (initialUpdate === true) {\n        if (value) {\n            show()\n        } else {\n            hide()\n        }\n        return\n    }\n\n    const handle = (resolve, reject) => {\n        if (value) {\n            if (el.style.display === 'none' || el.__jmb_transition) {\n                transitionIn(el, () => {\n                    show()\n                }, reject, component)\n            }\n            resolve(() => {})\n        } else {\n            if (el.style.display !== 'none') {\n                transitionOut(el, () => {\n                    resolve(() => {\n                        hide()\n                    })\n                }, reject, component)\n            } else {\n                resolve(() => {})\n            }\n        }\n    }\n\n    // The working of jmb-show is a bit complex because we need to\n    // wait for any child transitions to finish before hiding\n    // some element. Also, this has to be done recursively.\n\n    // If jmb-show.immediate, foregoe the waiting.\n    if (modifiers.includes('immediate')) {\n        handle(finish => finish(), () => {})\n        return\n    }\n\n    // jmb-show is encountered during a DOM tree walk. If an element\n    // we encounter is NOT a child of another jmb-show element we\n    // can execute the previous jmb-show stack (if one exists).\n    if (component.showDirectiveLastElement && ! component.showDirectiveLastElement.contains(el)) {\n        component.executeAndClearRemainingShowDirectiveStack()\n    }\n\n    component.showDirectiveStack.push(handle)\n\n    component.showDirectiveLastElement = el\n}\n","import { transitionIn, transitionOut, warnIfMalformedTemplate } from '../utils'\n\nexport function handleIfDirective(component, el, expressionResult, initialUpdate, extraVars) {\n    warnIfMalformedTemplate(el, 'jmb-if')\n\n    const elementHasAlreadyBeenAdded = el.nextElementSibling && el.nextElementSibling.__jmb_inserted_me === true\n\n    if (expressionResult && (! elementHasAlreadyBeenAdded || el.__jmb_transition)) {\n        const clone = document.importNode(el.content, true);\n\n        el.parentElement.insertBefore(clone, el.nextElementSibling)\n\n        transitionIn(el.nextElementSibling, () => {}, () => {}, component, initialUpdate)\n\n        component.initializeElements(el.nextElementSibling, extraVars)\n\n        el.nextElementSibling.__jmb_inserted_me = true\n    } else if (! expressionResult && elementHasAlreadyBeenAdded) {\n        transitionOut(el.nextElementSibling, () => {\n            el.nextElementSibling.remove()\n        }, () => {}, component, initialUpdate)\n    }\n}\n","import { kebabCase, camelCase, debounce, isNumeric } from '../utils'\n\nexport function registerListener(component, el, event, modifiers, expression, extraVars = () => { }, mutated=false) {\n    const options = {\n        passive: modifiers.includes('passive'),\n    };\n\n    if (modifiers.includes('camel')) {\n        event = camelCase(event);\n    }\n\n    let handler, listenerTarget\n\n    if (modifiers.includes('away')) {\n        listenerTarget = document\n\n        handler = e => {\n            // Don't do anything if the click came from the element or within it.\n            if (el.contains(e.target)) return\n\n            // Don't do anything if this element isn't currently visible.\n            if (el.offsetWidth < 1 && el.offsetHeight < 1) return\n\n            // Now that we are sure the element is visible, AND the click\n            // is from outside it, let's run the expression.\n            runListenerHandler(component, expression, e, extraVars, el)\n\n            if (modifiers.includes('once')) {\n                document.removeEventListener(event, handler, options)\n            }\n        }\n    } else {\n        listenerTarget = modifiers.includes('window')\n            ? window : (modifiers.includes('document') ? document : el)\n\n        handler = e => {\n            // Remove this global event handler if the element that declared it\n            // has been removed. It's now stale.\n            if (listenerTarget === window || listenerTarget === document) {\n                if (!document.body.contains(el)) {\n                    listenerTarget.removeEventListener(event, handler, options)\n                    return\n                }\n            }\n\n            if (isKeyEvent(event)) {\n                if (isListeningForASpecificKeyThatHasntBeenPressed(e, modifiers)) {\n                    return\n                }\n            }\n\n            if (modifiers.includes('prevent')) e.preventDefault()\n            if (modifiers.includes('stop')) e.stopPropagation()\n\n            // If the .self modifier isn't present, or if it is present and\n            // the target element matches the element we are registering the\n            // event on, run the handler\n            if (!modifiers.includes('self') || e.target === el) {\n                const returnValue = runListenerHandler(component, expression, e, extraVars, el)\n\n                returnValue.then(value => {\n                    if (value === false) {\n                        e.preventDefault()\n                    } else {\n                        if (modifiers.includes('once')) {\n                            listenerTarget.removeEventListener(event, handler, options)\n                        }\n                    }\n                })\n            }\n        }\n    }\n\n    // if expression adds commands to jembeClient\n    // then execute jembeClient comands and refresh page\n    if (!modifiers.includes('defer')) {\n        handler = ((component, func) => {\n            return e => {\n                component.$jmb.callsCommands = false\n                func(e)\n                if (component.$jmb.callsCommands === true) {\n                    component.$jmb.executeCommands(!modifiers.includes('nonblocking'))\n                }\n            }\n        })(component, handler)\n    }\n\n    if (modifiers.includes('debounce')) {\n        let nextModifier = modifiers[modifiers.indexOf('debounce') + 1] || 'invalid-wait'\n        let wait = isNumeric(nextModifier.split('ms')[0]) ? Number(nextModifier.split('ms')[0]) : 250\n        handler = debounce(handler, wait, this)\n    }\n    const delayModifier = modifiers.find(m => m.startsWith('delay'))\n    if (delayModifier !== undefined) {\n        const delayId = delayModifier.split('-', 2)[1]\n        let delayTime = modifiers[modifiers.indexOf(delayModifier) + 1]\n        delayTime = delayTime !== undefined && delayTime.endsWith('ms') ? parseInt(delayTime.substr(0, delayTime.length - 2)) : 250\n        if (delayId === undefined) {\n            handler = ((comp, func) => {\n                return (e) => {\n                    var timerId = window.setTimeout(function () { func(e) }, delayTime);\n                    comp.unnamedTimers.push(timerId)\n\n                }\n            })(component, handler)\n        } else {\n            let start = new Date().getTime()\n            if (component.originalComponentNamedTimers[delayId] !== undefined) {\n                start = component.originalComponentNamedTimers[delayId].start\n                delayTime = delayTime - ((new Date().getTime()) - start)\n            }\n\n            if (delayTime > 0) {\n                handler = ((comp, func) => {\n                    return (e) => {\n                        var timerId = window.setTimeout(function () {\n                            func(e);\n                            delete comp.namedTimers[delayId]\n                        }, delayTime);\n                        comp.namedTimers[delayId] = {\n                            id: timerId,\n                            start: start\n                        }\n                    }\n                })(component, handler)\n            } else {\n                //run emidiatly like on:ready\n                component.nextTickStack.push(() => {\n                    handler(new Event('ready', { target: el }))\n                })\n                return // dont register listener nor \n            }\n        }\n    }\n\n    if (event === 'ready') {\n        if (! mutated) {\n            component.nextTickStack.push(() => {\n                handler(new Event('ready', { target: el }))\n            })\n        }\n    } else {\n        // register listener so it can be removed when morphing dom\n        if (el.__jmb_listeners === undefined) {\n            el.__jmb_listeners = []\n        }\n        el.__jmb_listeners.push([listenerTarget, event, handler, options])\n        listenerTarget.addEventListener(event, handler, options)\n    }\n}\n\nfunction runListenerHandler(component, expression, e, extraVars, self) {\n    return component.evaluateCommandExpression(e.target, expression, () => {\n        return { ...extraVars(), '$event': e, '$self': self }\n    })\n}\n\nfunction isKeyEvent(event) {\n    return ['keydown', 'keyup'].includes(event)\n}\n\nfunction isListeningForASpecificKeyThatHasntBeenPressed(e, modifiers) {\n    let keyModifiers = modifiers.filter(i => {\n        return !['window', 'document', 'prevent', 'stop'].includes(i)\n    })\n\n    if (keyModifiers.includes('debounce')) {\n        let debounceIndex = keyModifiers.indexOf('debounce')\n        keyModifiers.splice(debounceIndex, isNumeric((keyModifiers[debounceIndex + 1] || 'invalid-wait').split('ms')[0]) ? 2 : 1)\n    }\n\n    // If no modifier is specified, we'll call it a press.\n    if (keyModifiers.length === 0) return false\n\n    // If one is passed, AND it matches the key pressed, we'll call it a press.\n    if (keyModifiers.length === 1 && keyModifiers[0] === keyToModifier(e.key)) return false\n\n    // The user is listening for key combinations.\n    const systemKeyModifiers = ['ctrl', 'shift', 'alt', 'meta', 'cmd', 'super']\n    const selectedSystemKeyModifiers = systemKeyModifiers.filter(modifier => keyModifiers.includes(modifier))\n\n    keyModifiers = keyModifiers.filter(i => !selectedSystemKeyModifiers.includes(i))\n\n    if (selectedSystemKeyModifiers.length > 0) {\n        const activelyPressedKeyModifiers = selectedSystemKeyModifiers.filter(modifier => {\n            // Alias \"cmd\" and \"super\" to \"meta\"\n            if (modifier === 'cmd' || modifier === 'super') modifier = 'meta'\n\n            return e[`${modifier}Key`]\n        })\n\n        // If all the modifiers selected are pressed, ...\n        if (activelyPressedKeyModifiers.length === selectedSystemKeyModifiers.length) {\n            // AND the remaining key is pressed as well. It's a press.\n            if (keyModifiers[0] === keyToModifier(e.key)) return false\n        }\n    }\n\n    // We'll call it NOT a valid keypress.\n    return true\n}\n\nfunction keyToModifier(key) {\n    switch (key) {\n        case '/':\n            return 'slash'\n        case ' ':\n        case 'Spacebar':\n            return 'space'\n        default:\n            return key && kebabCase(key)\n    }\n}\n","import { registerListener } from './on'\nimport { isNumeric, checkedAttrLooseCompare } from '../utils'\n\nexport function registerModelListener(component, el, modifiers, expression, extraVars) {\n    // If the element we are binding to is a select, a radio, or checkbox\n    // we'll listen for the change event instead of the \"input\" event.\n    var event = (el.tagName.toLowerCase() === 'select')\n        || ['checkbox', 'radio'].includes(el.type)\n        || modifiers.includes('lazy')\n        ? 'change' : 'input'\n\n    const listenerExpression = `${expression} = rightSideOfExpression($event, ${expression})`\n\n    registerListener(component, el, event, modifiers, listenerExpression, () => {\n        return {\n            ...extraVars(),\n            rightSideOfExpression: generateModelAssignmentFunction(el, modifiers, expression),\n        }\n    })\n}\n\nfunction generateModelAssignmentFunction(el, modifiers, expression) {\n    if (el.type === 'radio') {\n        // Radio buttons only work properly when they share a name attribute.\n        // People might assume we take care of that for them, because\n        // they already set a shared \"jmb-model\" attribute.\n        if (! el.hasAttribute('name')) el.setAttribute('name', expression)\n    }\n\n    return (event, currentValue) => {\n        // Check for event.detail due to an issue where IE11 handles other events as a CustomEvent.\n        if (event instanceof CustomEvent && event.detail) {\n            return event.detail\n        } else if (el.type === 'checkbox') {\n            // If the data we are binding to is an array, toggle its value inside the array.\n            if (Array.isArray(currentValue)) {\n                const newValue = modifiers.includes('number') ? safeParseNumber(event.target.value) : event.target.value\n                return event.target.checked ? currentValue.concat([newValue]) : currentValue.filter(el => !checkedAttrLooseCompare(el, newValue))\n            } else {\n                return event.target.checked\n            }\n        } else if (el.tagName.toLowerCase() === 'select' && el.multiple) {\n            return modifiers.includes('number')\n                ? Array.from(event.target.selectedOptions).map(option => {\n                    const rawValue = option.value || option.text\n                    return safeParseNumber(rawValue)\n                })\n                : Array.from(event.target.selectedOptions).map(option => {\n                    return option.value || option.text\n                })\n        } else {\n            const rawValue = event.target.value\n            return modifiers.includes('number')\n                ? safeParseNumber(rawValue)\n                : (modifiers.includes('trim') ? rawValue.trim() : rawValue)\n        }\n    }\n}\n\nfunction safeParseNumber(rawValue) {\n    const number = rawValue ? parseFloat(rawValue) : null\n    return isNumeric(number) ? number : rawValue\n}\n","/**\n * Copyright (C) 2017 salesforce.com, inc.\n */\nconst { isArray } = Array;\nconst { getPrototypeOf, create: ObjectCreate, defineProperty: ObjectDefineProperty, defineProperties: ObjectDefineProperties, isExtensible, getOwnPropertyDescriptor, getOwnPropertyNames, getOwnPropertySymbols, preventExtensions, hasOwnProperty, } = Object;\nconst { push: ArrayPush, concat: ArrayConcat, map: ArrayMap, } = Array.prototype;\nconst OtS = {}.toString;\nfunction toString(obj) {\n    if (obj && obj.toString) {\n        return obj.toString();\n    }\n    else if (typeof obj === 'object') {\n        return OtS.call(obj);\n    }\n    else {\n        return obj + '';\n    }\n}\nfunction isUndefined(obj) {\n    return obj === undefined;\n}\nfunction isFunction(obj) {\n    return typeof obj === 'function';\n}\nconst proxyToValueMap = new WeakMap();\nfunction registerProxy(proxy, value) {\n    proxyToValueMap.set(proxy, value);\n}\nconst unwrap = (replicaOrAny) => proxyToValueMap.get(replicaOrAny) || replicaOrAny;\n\nclass BaseProxyHandler {\n    constructor(membrane, value) {\n        this.originalTarget = value;\n        this.membrane = membrane;\n    }\n    // Shared utility methods\n    wrapDescriptor(descriptor) {\n        if (hasOwnProperty.call(descriptor, 'value')) {\n            descriptor.value = this.wrapValue(descriptor.value);\n        }\n        else {\n            const { set: originalSet, get: originalGet } = descriptor;\n            if (!isUndefined(originalGet)) {\n                descriptor.get = this.wrapGetter(originalGet);\n            }\n            if (!isUndefined(originalSet)) {\n                descriptor.set = this.wrapSetter(originalSet);\n            }\n        }\n        return descriptor;\n    }\n    copyDescriptorIntoShadowTarget(shadowTarget, key) {\n        const { originalTarget } = this;\n        // Note: a property might get defined multiple times in the shadowTarget\n        //       but it will always be compatible with the previous descriptor\n        //       to preserve the object invariants, which makes these lines safe.\n        const originalDescriptor = getOwnPropertyDescriptor(originalTarget, key);\n        if (!isUndefined(originalDescriptor)) {\n            const wrappedDesc = this.wrapDescriptor(originalDescriptor);\n            ObjectDefineProperty(shadowTarget, key, wrappedDesc);\n        }\n    }\n    lockShadowTarget(shadowTarget) {\n        const { originalTarget } = this;\n        const targetKeys = ArrayConcat.call(getOwnPropertyNames(originalTarget), getOwnPropertySymbols(originalTarget));\n        targetKeys.forEach((key) => {\n            this.copyDescriptorIntoShadowTarget(shadowTarget, key);\n        });\n        const { membrane: { tagPropertyKey } } = this;\n        if (!isUndefined(tagPropertyKey) && !hasOwnProperty.call(shadowTarget, tagPropertyKey)) {\n            ObjectDefineProperty(shadowTarget, tagPropertyKey, ObjectCreate(null));\n        }\n        preventExtensions(shadowTarget);\n    }\n    // Shared Traps\n    apply(shadowTarget, thisArg, argArray) {\n        /* No op */\n    }\n    construct(shadowTarget, argArray, newTarget) {\n        /* No op */\n    }\n    get(shadowTarget, key) {\n        const { originalTarget, membrane: { valueObserved } } = this;\n        const value = originalTarget[key];\n        valueObserved(originalTarget, key);\n        return this.wrapValue(value);\n    }\n    has(shadowTarget, key) {\n        const { originalTarget, membrane: { tagPropertyKey, valueObserved } } = this;\n        valueObserved(originalTarget, key);\n        // since key is never going to be undefined, and tagPropertyKey might be undefined\n        // we can simply compare them as the second part of the condition.\n        return key in originalTarget || key === tagPropertyKey;\n    }\n    ownKeys(shadowTarget) {\n        const { originalTarget, membrane: { tagPropertyKey } } = this;\n        // if the membrane tag key exists and it is not in the original target, we add it to the keys.\n        const keys = isUndefined(tagPropertyKey) || hasOwnProperty.call(originalTarget, tagPropertyKey) ? [] : [tagPropertyKey];\n        // small perf optimization using push instead of concat to avoid creating an extra array\n        ArrayPush.apply(keys, getOwnPropertyNames(originalTarget));\n        ArrayPush.apply(keys, getOwnPropertySymbols(originalTarget));\n        return keys;\n    }\n    isExtensible(shadowTarget) {\n        const { originalTarget } = this;\n        // optimization to avoid attempting to lock down the shadowTarget multiple times\n        if (!isExtensible(shadowTarget)) {\n            return false; // was already locked down\n        }\n        if (!isExtensible(originalTarget)) {\n            this.lockShadowTarget(shadowTarget);\n            return false;\n        }\n        return true;\n    }\n    getPrototypeOf(shadowTarget) {\n        const { originalTarget } = this;\n        return getPrototypeOf(originalTarget);\n    }\n    getOwnPropertyDescriptor(shadowTarget, key) {\n        const { originalTarget, membrane: { valueObserved, tagPropertyKey } } = this;\n        // keys looked up via getOwnPropertyDescriptor need to be reactive\n        valueObserved(originalTarget, key);\n        let desc = getOwnPropertyDescriptor(originalTarget, key);\n        if (isUndefined(desc)) {\n            if (key !== tagPropertyKey) {\n                return undefined;\n            }\n            // if the key is the membrane tag key, and is not in the original target,\n            // we produce a synthetic descriptor and install it on the shadow target\n            desc = { value: undefined, writable: false, configurable: false, enumerable: false };\n            ObjectDefineProperty(shadowTarget, tagPropertyKey, desc);\n            return desc;\n        }\n        if (desc.configurable === false) {\n            // updating the descriptor to non-configurable on the shadow\n            this.copyDescriptorIntoShadowTarget(shadowTarget, key);\n        }\n        // Note: by accessing the descriptor, the key is marked as observed\n        // but access to the value, setter or getter (if available) cannot observe\n        // mutations, just like regular methods, in which case we just do nothing.\n        return this.wrapDescriptor(desc);\n    }\n}\n\nconst getterMap = new WeakMap();\nconst setterMap = new WeakMap();\nconst reverseGetterMap = new WeakMap();\nconst reverseSetterMap = new WeakMap();\nclass ReactiveProxyHandler extends BaseProxyHandler {\n    wrapValue(value) {\n        return this.membrane.getProxy(value);\n    }\n    wrapGetter(originalGet) {\n        const wrappedGetter = getterMap.get(originalGet);\n        if (!isUndefined(wrappedGetter)) {\n            return wrappedGetter;\n        }\n        const handler = this;\n        const get = function () {\n            // invoking the original getter with the original target\n            return handler.wrapValue(originalGet.call(unwrap(this)));\n        };\n        getterMap.set(originalGet, get);\n        reverseGetterMap.set(get, originalGet);\n        return get;\n    }\n    wrapSetter(originalSet) {\n        const wrappedSetter = setterMap.get(originalSet);\n        if (!isUndefined(wrappedSetter)) {\n            return wrappedSetter;\n        }\n        const set = function (v) {\n            // invoking the original setter with the original target\n            originalSet.call(unwrap(this), unwrap(v));\n        };\n        setterMap.set(originalSet, set);\n        reverseSetterMap.set(set, originalSet);\n        return set;\n    }\n    unwrapDescriptor(descriptor) {\n        if (hasOwnProperty.call(descriptor, 'value')) {\n            // dealing with a data descriptor\n            descriptor.value = unwrap(descriptor.value);\n        }\n        else {\n            const { set, get } = descriptor;\n            if (!isUndefined(get)) {\n                descriptor.get = this.unwrapGetter(get);\n            }\n            if (!isUndefined(set)) {\n                descriptor.set = this.unwrapSetter(set);\n            }\n        }\n        return descriptor;\n    }\n    unwrapGetter(redGet) {\n        const reverseGetter = reverseGetterMap.get(redGet);\n        if (!isUndefined(reverseGetter)) {\n            return reverseGetter;\n        }\n        const handler = this;\n        const get = function () {\n            // invoking the red getter with the proxy of this\n            return unwrap(redGet.call(handler.wrapValue(this)));\n        };\n        getterMap.set(get, redGet);\n        reverseGetterMap.set(redGet, get);\n        return get;\n    }\n    unwrapSetter(redSet) {\n        const reverseSetter = reverseSetterMap.get(redSet);\n        if (!isUndefined(reverseSetter)) {\n            return reverseSetter;\n        }\n        const handler = this;\n        const set = function (v) {\n            // invoking the red setter with the proxy of this\n            redSet.call(handler.wrapValue(this), handler.wrapValue(v));\n        };\n        setterMap.set(set, redSet);\n        reverseSetterMap.set(redSet, set);\n        return set;\n    }\n    set(shadowTarget, key, value) {\n        const { originalTarget, membrane: { valueMutated } } = this;\n        const oldValue = originalTarget[key];\n        if (oldValue !== value) {\n            originalTarget[key] = value;\n            valueMutated(originalTarget, key);\n        }\n        else if (key === 'length' && isArray(originalTarget)) {\n            // fix for issue #236: push will add the new index, and by the time length\n            // is updated, the internal length is already equal to the new length value\n            // therefore, the oldValue is equal to the value. This is the forking logic\n            // to support this use case.\n            valueMutated(originalTarget, key);\n        }\n        return true;\n    }\n    deleteProperty(shadowTarget, key) {\n        const { originalTarget, membrane: { valueMutated } } = this;\n        delete originalTarget[key];\n        valueMutated(originalTarget, key);\n        return true;\n    }\n    setPrototypeOf(shadowTarget, prototype) {\n        if (process.env.NODE_ENV !== 'production') {\n            throw new Error(`Invalid setPrototypeOf invocation for reactive proxy ${toString(this.originalTarget)}. Prototype of reactive objects cannot be changed.`);\n        }\n    }\n    preventExtensions(shadowTarget) {\n        if (isExtensible(shadowTarget)) {\n            const { originalTarget } = this;\n            preventExtensions(originalTarget);\n            // if the originalTarget is a proxy itself, it might reject\n            // the preventExtension call, in which case we should not attempt to lock down\n            // the shadow target.\n            if (isExtensible(originalTarget)) {\n                return false;\n            }\n            this.lockShadowTarget(shadowTarget);\n        }\n        return true;\n    }\n    defineProperty(shadowTarget, key, descriptor) {\n        const { originalTarget, membrane: { valueMutated, tagPropertyKey } } = this;\n        if (key === tagPropertyKey && !hasOwnProperty.call(originalTarget, key)) {\n            // To avoid leaking the membrane tag property into the original target, we must\n            // be sure that the original target doesn't have yet.\n            // NOTE: we do not return false here because Object.freeze and equivalent operations\n            // will attempt to set the descriptor to the same value, and expect no to throw. This\n            // is an small compromise for the sake of not having to diff the descriptors.\n            return true;\n        }\n        ObjectDefineProperty(originalTarget, key, this.unwrapDescriptor(descriptor));\n        // intentionally testing if false since it could be undefined as well\n        if (descriptor.configurable === false) {\n            this.copyDescriptorIntoShadowTarget(shadowTarget, key);\n        }\n        valueMutated(originalTarget, key);\n        return true;\n    }\n}\n\nconst getterMap$1 = new WeakMap();\nconst setterMap$1 = new WeakMap();\nclass ReadOnlyHandler extends BaseProxyHandler {\n    wrapValue(value) {\n        return this.membrane.getReadOnlyProxy(value);\n    }\n    wrapGetter(originalGet) {\n        const wrappedGetter = getterMap$1.get(originalGet);\n        if (!isUndefined(wrappedGetter)) {\n            return wrappedGetter;\n        }\n        const handler = this;\n        const get = function () {\n            // invoking the original getter with the original target\n            return handler.wrapValue(originalGet.call(unwrap(this)));\n        };\n        getterMap$1.set(originalGet, get);\n        return get;\n    }\n    wrapSetter(originalSet) {\n        const wrappedSetter = setterMap$1.get(originalSet);\n        if (!isUndefined(wrappedSetter)) {\n            return wrappedSetter;\n        }\n        const handler = this;\n        const set = function (v) {\n            if (process.env.NODE_ENV !== 'production') {\n                const { originalTarget } = handler;\n                throw new Error(`Invalid mutation: Cannot invoke a setter on \"${originalTarget}\". \"${originalTarget}\" is read-only.`);\n            }\n        };\n        setterMap$1.set(originalSet, set);\n        return set;\n    }\n    set(shadowTarget, key, value) {\n        if (process.env.NODE_ENV !== 'production') {\n            const { originalTarget } = this;\n            throw new Error(`Invalid mutation: Cannot set \"${key.toString()}\" on \"${originalTarget}\". \"${originalTarget}\" is read-only.`);\n        }\n        return false;\n    }\n    deleteProperty(shadowTarget, key) {\n        if (process.env.NODE_ENV !== 'production') {\n            const { originalTarget } = this;\n            throw new Error(`Invalid mutation: Cannot delete \"${key.toString()}\" on \"${originalTarget}\". \"${originalTarget}\" is read-only.`);\n        }\n        return false;\n    }\n    setPrototypeOf(shadowTarget, prototype) {\n        if (process.env.NODE_ENV !== 'production') {\n            const { originalTarget } = this;\n            throw new Error(`Invalid prototype mutation: Cannot set prototype on \"${originalTarget}\". \"${originalTarget}\" prototype is read-only.`);\n        }\n    }\n    preventExtensions(shadowTarget) {\n        if (process.env.NODE_ENV !== 'production') {\n            const { originalTarget } = this;\n            throw new Error(`Invalid mutation: Cannot preventExtensions on ${originalTarget}\". \"${originalTarget} is read-only.`);\n        }\n        return false;\n    }\n    defineProperty(shadowTarget, key, descriptor) {\n        if (process.env.NODE_ENV !== 'production') {\n            const { originalTarget } = this;\n            throw new Error(`Invalid mutation: Cannot defineProperty \"${key.toString()}\" on \"${originalTarget}\". \"${originalTarget}\" is read-only.`);\n        }\n        return false;\n    }\n}\n\nfunction extract(objectOrArray) {\n    if (isArray(objectOrArray)) {\n        return objectOrArray.map((item) => {\n            const original = unwrap(item);\n            if (original !== item) {\n                return extract(original);\n            }\n            return item;\n        });\n    }\n    const obj = ObjectCreate(getPrototypeOf(objectOrArray));\n    const names = getOwnPropertyNames(objectOrArray);\n    return ArrayConcat.call(names, getOwnPropertySymbols(objectOrArray))\n        .reduce((seed, key) => {\n        const item = objectOrArray[key];\n        const original = unwrap(item);\n        if (original !== item) {\n            seed[key] = extract(original);\n        }\n        else {\n            seed[key] = item;\n        }\n        return seed;\n    }, obj);\n}\nconst formatter = {\n    header: (plainOrProxy) => {\n        const originalTarget = unwrap(plainOrProxy);\n        // if originalTarget is falsy or not unwrappable, exit\n        if (!originalTarget || originalTarget === plainOrProxy) {\n            return null;\n        }\n        const obj = extract(plainOrProxy);\n        return ['object', { object: obj }];\n    },\n    hasBody: () => {\n        return false;\n    },\n    body: () => {\n        return null;\n    }\n};\n// Inspired from paulmillr/es6-shim\n// https://github.com/paulmillr/es6-shim/blob/master/es6-shim.js#L176-L185\nfunction getGlobal() {\n    // the only reliable means to get the global object is `Function('return this')()`\n    // However, this causes CSP violations in Chrome apps.\n    if (typeof globalThis !== 'undefined') {\n        return globalThis;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    // Gracefully degrade if not able to locate the global object\n    return {};\n}\nfunction init() {\n    if (process.env.NODE_ENV === 'production') {\n        // this method should never leak to prod\n        throw new ReferenceError();\n    }\n    const global = getGlobal();\n    // Custom Formatter for Dev Tools. To enable this, open Chrome Dev Tools\n    //  - Go to Settings,\n    //  - Under console, select \"Enable custom formatters\"\n    // For more information, https://docs.google.com/document/d/1FTascZXT9cxfetuPRT2eXPQKXui4nWFivUnS_335T3U/preview\n    const devtoolsFormatters = global.devtoolsFormatters || [];\n    ArrayPush.call(devtoolsFormatters, formatter);\n    global.devtoolsFormatters = devtoolsFormatters;\n}\n\nif (process.env.NODE_ENV !== 'production') {\n    init();\n}\nconst ObjectDotPrototype = Object.prototype;\nfunction defaultValueIsObservable(value) {\n    // intentionally checking for null\n    if (value === null) {\n        return false;\n    }\n    // treat all non-object types, including undefined, as non-observable values\n    if (typeof value !== 'object') {\n        return false;\n    }\n    if (isArray(value)) {\n        return true;\n    }\n    const proto = getPrototypeOf(value);\n    return (proto === ObjectDotPrototype || proto === null || getPrototypeOf(proto) === null);\n}\nconst defaultValueObserved = (obj, key) => {\n    /* do nothing */\n};\nconst defaultValueMutated = (obj, key) => {\n    /* do nothing */\n};\nconst defaultValueDistortion = (value) => value;\nfunction createShadowTarget(value) {\n    return isArray(value) ? [] : {};\n}\nclass ReactiveMembrane {\n    constructor(options) {\n        this.valueDistortion = defaultValueDistortion;\n        this.valueMutated = defaultValueMutated;\n        this.valueObserved = defaultValueObserved;\n        this.valueIsObservable = defaultValueIsObservable;\n        this.objectGraph = new WeakMap();\n        if (!isUndefined(options)) {\n            const { valueDistortion, valueMutated, valueObserved, valueIsObservable, tagPropertyKey } = options;\n            this.valueDistortion = isFunction(valueDistortion) ? valueDistortion : defaultValueDistortion;\n            this.valueMutated = isFunction(valueMutated) ? valueMutated : defaultValueMutated;\n            this.valueObserved = isFunction(valueObserved) ? valueObserved : defaultValueObserved;\n            this.valueIsObservable = isFunction(valueIsObservable) ? valueIsObservable : defaultValueIsObservable;\n            this.tagPropertyKey = tagPropertyKey;\n        }\n    }\n    getProxy(value) {\n        const unwrappedValue = unwrap(value);\n        const distorted = this.valueDistortion(unwrappedValue);\n        if (this.valueIsObservable(distorted)) {\n            const o = this.getReactiveState(unwrappedValue, distorted);\n            // when trying to extract the writable version of a readonly\n            // we return the readonly.\n            return o.readOnly === value ? value : o.reactive;\n        }\n        return distorted;\n    }\n    getReadOnlyProxy(value) {\n        value = unwrap(value);\n        const distorted = this.valueDistortion(value);\n        if (this.valueIsObservable(distorted)) {\n            return this.getReactiveState(value, distorted).readOnly;\n        }\n        return distorted;\n    }\n    unwrapProxy(p) {\n        return unwrap(p);\n    }\n    getReactiveState(value, distortedValue) {\n        const { objectGraph, } = this;\n        let reactiveState = objectGraph.get(distortedValue);\n        if (reactiveState) {\n            return reactiveState;\n        }\n        const membrane = this;\n        reactiveState = {\n            get reactive() {\n                const reactiveHandler = new ReactiveProxyHandler(membrane, distortedValue);\n                // caching the reactive proxy after the first time it is accessed\n                const proxy = new Proxy(createShadowTarget(distortedValue), reactiveHandler);\n                registerProxy(proxy, value);\n                ObjectDefineProperty(this, 'reactive', { value: proxy });\n                return proxy;\n            },\n            get readOnly() {\n                const readOnlyHandler = new ReadOnlyHandler(membrane, distortedValue);\n                // caching the readOnly proxy after the first time it is accessed\n                const proxy = new Proxy(createShadowTarget(distortedValue), readOnlyHandler);\n                registerProxy(proxy, value);\n                ObjectDefineProperty(this, 'readOnly', { value: proxy });\n                return proxy;\n            }\n        };\n        objectGraph.set(distortedValue, reactiveState);\n        return reactiveState;\n    }\n}\n\nexport default ReactiveMembrane;\n/** version: 1.0.0 */\n","import ObservableMembrane from 'observable-membrane'\n\nexport function wrap(data, mutationCallback) {\n    /* IE11-ONLY:START */\n    // return wrapForIe11(data, mutationCallback)\n    /* IE11-ONLY:END */\n\n\n    let membrane = new ObservableMembrane({\n        valueMutated(target, key) {\n            mutationCallback(target, key)\n        },\n    })\n\n    return {\n        data: membrane.getProxy(data),\n        membrane: membrane,\n    }\n}\n\nexport function unwrap(membrane, observable) {\n    let unwrappedData = membrane.unwrapProxy(observable)\n    let copy = {}\n\n    Object.keys(unwrappedData).forEach(key => {\n        if (['$el', '$refs', '$nextTick', '$watch', '$jmb'].includes(key)) return\n\n        copy[key] = unwrappedData[key]\n    })\n\n    return copy\n}\n\n// function wrapForIe11(data, mutationCallback) {\n//     const proxyHandler = {\n//         set(target, key, value) {\n//             // Set the value converting it to a \"Deep Proxy\" when required\n//             // Note that if a project is not a valid object, it won't be converted to a proxy\n//             const setWasSuccessful = Reflect.set(target, key, deepProxy(value, proxyHandler))\n\n//             mutationCallback(target, key)\n\n//             return setWasSuccessful\n//         },\n//         get(target, key) {\n//             // Provide a way to determine if this object is an Alpine proxy or not.\n//             if (key === \"$isAlpineProxy\") return true\n\n//             // Just return the flippin' value. Gawsh.\n//             return target[key]\n//         }\n//     }\n\n//     return {\n//         data: deepProxy(data, proxyHandler),\n//         membrane: {\n//             unwrapProxy(proxy) {\n//                 return proxy\n//             }\n//         },\n//     }\n// }\n\n// function deepProxy(target, proxyHandler) {\n//     // If target is null, return it.\n//     if (target === null) return target;\n\n//     // If target is not an object, return it.\n//     if (typeof target !== 'object') return target;\n\n//     // If target is a DOM node (like in the case of this.$el), return it.\n//     if (target instanceof Node) return target\n\n//     // If target is already an Alpine proxy, return it.\n//     if (target['$isAlpineProxy']) return target;\n\n//     // Otherwise proxy the properties recursively.\n//     // This enables reactivity on setting nested data.\n//     // Note that if a project is not a valid object, it won't be converted to a proxy\n//     for (let property in target) {\n//         target[property] = deepProxy(target[property], proxyHandler)\n//     }\n\n//     return new Proxy(target, proxyHandler)\n// }\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","import { isAbsolute, join } from \"path\";\nexport default class JMB {\n  constructor(jembeClient, execName) {\n    this.jembeClient = jembeClient\n    this.execName = execName\n    this.callsCommands = false\n  }\n  call(actionName, ...params) {\n    this.callsCommands = true\n\n    let kwargs = {}\n    let args = []\n    if (params.length === 1 && params[0].constructor == Object) {\n      kwargs = params[0]\n    } else {\n      args = params\n    }\n    this.jembeClient.addCallCommand(\n      this.execName,\n      actionName,\n      args,\n      kwargs\n    )\n  }\n  display() {\n    this.call(\"display\")\n  }\n  /**\n   *  Change state param of current component,\n   *  by addig initialise command with only state param \n   *  defined by stateName changed to newlly provided value\n   * stateName can use dots (.) to set attribure of object\n   * Examples: \"someObject.paramName\" \n   * @param {string} stateName \n   * @param {*} value \n   */\n  set(stateName, value) {\n    this.callsCommands = true\n    if (value instanceof FileList || value instanceof File) {\n      this.jembeClient.addFilesForUpload(this.execName, stateName, value)\n    } else {\n      let params = {}\n      params[stateName] = value\n      this.jembeClient.addInitialiseCommand(\n        this.execName,\n        params\n      )\n    }\n  }\n  emit(eventName, kwargs = {}, to = null) {\n    this.callsCommands = true\n    this.jembeClient.addEmitCommand(\n      this.execName,\n      eventName,\n      kwargs,\n      to\n    )\n  }\n  component(relativeExecName, kwargs = {}, mergeExistingParams = true) {\n    this.callsCommands = true\n\n    let execName = relativeExecName\n    if (!isAbsolute(relativeExecName)) {\n      execName = join(this.execName, relativeExecName)\n    }\n    let componentNames = []\n    let startWith = []\n    let index = 0\n    let equalSoFar = true\n    let execNameSplit = execName.split(\"/\")\n    let thisExecNameSplit = this.execName.split(\"/\")\n    while (index < execNameSplit.length) {\n      if (equalSoFar === true &&\n        (\n          // if execName is different (including key) we need to genereate init command\n          execNameSplit[index] !== thisExecNameSplit[index] ||\n          // alsy if kwargs are specified for last component we need do generate init command\n          (index === execNameSplit.length - 1 && kwargs !== {})\n        )\n      ) {\n        equalSoFar = false\n      }\n      if (!equalSoFar) {\n        componentNames.push(execNameSplit[index])\n      } else {\n        startWith.push(execNameSplit[index])\n      }\n      index++\n    }\n\n    index = 0\n    while (index < componentNames.length) {\n      this.jembeClient.addInitialiseCommand(\n        [\n          startWith.join(\"/\"),\n          componentNames.slice(0, index + 1).join(\"/\")\n        ].join(\"/\"),\n        index == componentNames.length - 1 ? kwargs : {},\n        mergeExistingParams\n      )\n      index++\n    }\n    return new JMB(this.jembeClient, execName)\n  }\n  component_reset(relativeExecName, kwargs = {}) {\n    return this.component(relativeExecName, kwargs, false)\n  }\n  executeCommands(disableInputs=true) {\n    this.jembeClient.consolidateCommands()\n    this.jembeClient.executeCommands(disableInputs)\n  }\n  componentsOnPage(filter) {\n    if (filter === undefined) {\n      return Object.keys(this.jembeClient.components)\n    } else {\n      return Object.values(this.jembeClient.components).filter(filter).map(c => c.execName)\n    }\n  }\n}","/**\n * Havily modified alpine.js 2.8.1 to:\n *  - user 'jmb-' instead 'x-' as prefix\n *  - jembe component becomes alpine component\n *  - jembe compoenent state params and actions becomes alpine x-data params and actions\n *  - when jembe state params are changed or action is called in x-data,\n *     call appropriate function on jembeclient\n *  - support local variables accessible only in alpine componetn with jmb-local,\n *    jmb-init, jmb-update directives\n *  - alpine/copmonentapi local variables are accessible with $local prefix\n *  - $node references current node on witch action is executed (jmb-on etc.)\n *  - add $jmb magic variable to reference jembeClient.component(this) to access set, cal display emit and init commands\n *  - when componentApi action changes any state variable are call any jembe action jembeClient.executeCommands() will be called\n *    if there is not defer modifier\n *  \n * modification are enclosed with @jembeModification\n */\nimport { walk, saferEval, saferEvalNoReturn, getXAttrs, debounce, convertClassStringToArray, TRANSITION_CANCELLED } from './utils'\nimport { handleForDirective } from './directives/for'\nimport { handleAttributeBindingDirective } from './directives/bind'\nimport { handleTextDirective } from './directives/text'\nimport { handleHtmlDirective } from './directives/html'\nimport { handleShowDirective } from './directives/show'\nimport { handleIfDirective } from './directives/if'\nimport { registerModelListener } from './directives/model'\nimport { registerListener } from './directives/on'\nimport { unwrap, wrap } from './observable'\n// import Alpine from './index'\nimport JMB from './magic/jmb'\n\nexport default class Component {\n    // @jembeModification\n    // constructor is separated in constructor + mount and havily modified to support\n    // jembeComponents\n    // mount do actual initialisation of component cunstructor don't do anything\n    constructor(el) {\n        this.$el = el\n\n        this.mounted = false\n        this.jembeClient = undefined\n        this.execName = undefined\n        this.state = undefined\n        this.actions = undefined\n        this.unnamedTimers = []\n        this.namedTimers = {}\n        this.originalComponentNamedTimers = {}\n    }\n    /**\n     * @param {Component} originalComponent \n     */\n    mount(jembeClient, execName, state, actions, originalComponent = undefined) {\n        if (this.mounted\n            && (\n                this.jembeClient !== jembeClient\n                || this.execName !== execName\n            )) {\n            throw (`Mounting ComponetApi for new component: ${this.execName} -> ${execName}`)\n        } else {\n            this.mounted = true\n\n            this.jembeClient = jembeClient\n            this.execName = execName\n            this.$jmb = new JMB(this.jembeClient, this.execName)\n        }\n        if (originalComponent !== undefined) {\n            this.originalComponentNamedTimers = originalComponent.namedTimers\n        }\n\n        this.state = JSON.parse(JSON.stringify(state));\n        this.actions = actions\n\n        for (const stateName of Object.keys(this.state)) {\n            if (Object.keys(this.actions).includes(stateName)) {\n                console.warn(`state param '${stateName}' overrides action with same name in component ${this.execName}!`)\n            }\n        }\n\n        const localAttr = this.$el.getAttribute('jmb-local')\n        const localExpression = (localAttr === '' || localAttr === null) ? '{}' : localAttr\n        const initAttr = this.$el.getAttribute('jmb-init')\n        const initExpression = (initAttr === '' || initAttr === null) ? '{}' : initAttr\n        const updateAttr = this.$el.getAttribute('jmb-update')\n        const updateExpression = (updateAttr === '' || updateAttr === null) ? '{}' : updateAttr\n        let dataExtras = {\n            $el: this.$el,\n            $jmb: this.$jmb\n        }\n\n        let canonicalComponentElementReference = this.$el\n\n        // Object.entries(Alpine.magicProperties).forEach(([name, callback]) => {\n        //     Object.defineProperty(dataExtras, `$${name}`, { get: function () { return callback(canonicalComponentElementReference) } });\n        // })\n\n        this.unobservedData = {\n            $local: (originalComponent === undefined)\n                ? saferEval(this.$el, localExpression, dataExtras)\n                : originalComponent.getUnobservedData()['$local']\n        }\n        // add actions\n        Object.entries(this.actions).forEach(([actionName, actionEnabled]) => {\n            Object.defineProperty(\n                this.unobservedData,\n                `${actionName}`,\n                { get: function () { return (...params) => { this.$jmb.call(actionName, ...params) } } }\n            )\n        })\n        // add states\n        Object.entries(this.state).forEach(([name, value]) => {\n            this.unobservedData[name] = value\n        })\n        // TODO add watcher to state data and fire init commands accoringly\n\n        /* IE11-ONLY:START */\n        // For IE11, add our magic properties to the original data for access.\n        // The Proxy polyfill does not allow properties to be added after creation.\n        // this.unobservedData.$el = null\n        // this.unobservedData.$refs = null\n        // this.unobservedData.$nextTick = null\n        // this.unobservedData.$watch = null\n        // this.unobservedData.$jmb = null\n        // The IE build uses a proxy polyfill which doesn't allow properties\n        // to be defined after the proxy object is created so,\n        // for IE only, we need to define our helpers earlier.\n        // Object.entries(Alpine.magicProperties).forEach(([name, callback]) => {\n        //     Object.defineProperty(this.unobservedData, `$${name}`, { get: function () { return callback(canonicalComponentElementReference, this.$el) } });\n        // })\n        /* IE11-ONLY:END */\n\n        // Construct a Proxy-based observable. This will be used to handle reactivity.\n        let { membrane, data } = this.wrapDataInObservable(this.unobservedData)\n        this.$data = data\n        this.membrane = membrane\n\n        // After making user-supplied data methods reactive, we can now add\n        // our magic properties to the original data for access.\n        this.unobservedData.$el = this.$el\n        this.unobservedData.$refs = this.getRefsProxy()\n        this.unobservedData.$jmb = this.$jmb\n\n        this.nextTickStack = []\n        this.unobservedData.$nextTick = (callback) => {\n            this.nextTickStack.push(callback)\n        }\n\n        this.watchers = {}\n        this.unobservedData.$watch = (property, callback) => {\n            if (!this.watchers[property]) this.watchers[property] = []\n            this.watchers[property].push(callback)\n        }\n\n\n        /* MODERN-ONLY:START */\n        // We remove this piece of code from the legacy build.\n        // In IE11, we have already defined our helpers at this point.\n\n        // Register custom magic properties.\n        // Object.entries(Alpine.magicProperties).forEach(([name, callback]) => {\n        //     Object.defineProperty(this.unobservedData, `$${name}`, { get: function () { return callback(canonicalComponentElementReference, this.$el) } });\n        // })\n        /* MODERN-ONLY:END */\n\n        this.showDirectiveStack = []\n        this.showDirectiveLastElement\n\n        // Alpine.onBeforeComponentInitializeds.forEach(callback => callback(this))\n\n        var initReturnedCallback\n        // If jmb-init is present AND we aren't cloning (skip jmb-init on clone)\n        if (originalComponent === undefined && initExpression) {\n            // We want to allow data manipulation, but not trigger DOM updates just yet.\n            // We haven't even initialized the elements with their Alpine bindings. I mean c'mon.\n            this.pauseReactivity = true\n            initReturnedCallback = this.evaluateReturnExpression(this.$el, initExpression)\n            this.pauseReactivity = false\n        } else if (originalComponent !== undefined && updateExpression) {\n            this.pauseReactivity = true\n            initReturnedCallback = this.evaluateReturnExpression(this.$el, updateExpression)\n            this.pauseReactivity = false\n        }\n\n        // Register all our listeners and set all our attribute bindings.\n        // If we're cloning a component, the third parameter ensures no duplicate\n        // event listeners are registered (the mutation observer will take care of them)\n        // this.initializeElements(this.$el, () => { }, originalComponent === undefined)\n        this.initializeElements(this.$el, () => { })\n\n        // Use mutation observer to detect new elements being added within this component at run-time.\n        // Alpine's just so darn flexible amirite?\n        this.listenForNewElementsToInitialize()\n\n        if (typeof initReturnedCallback === 'function') {\n            // Run the callback returned from the \"jmb-init\" hook to allow the user to do stuff after\n            // Alpine's got it's grubby little paws all over everything.\n            initReturnedCallback.call(this.$data)\n        }\n\n        // setTimeout(() => {\n        //     Alpine.onComponentInitializeds.forEach(callback => callback(this))\n        // }, 0)\n    }\n    unmount() {\n        for (const timerId of this.unnamedTimers) {\n            window.clearTimeout(timerId)\n        }\n        for (const [timerName, timerInfo] of Object.entries(this.namedTimers)) {\n            window.clearTimeout(timerInfo.id)\n        }\n    }\n    getUnobservedData() {\n        return unwrap(this.membrane, this.$data)\n    }\n\n    findTargetPathInData(tree, target, key = \"\", level = 0) {\n        if (Object.is(tree, target)) {\n            return key\n        }\n        const treeIsArray = Array.isArray(tree)\n        for (const [name, value] of Object.entries(tree)) {\n            if (!((level === 0 && name.startsWith('$')) || (treeIsArray && name === 'length')) && typeof value === \"object\") {\n                const subpath = this.findTargetPathInData(value, target, name, level + 1)\n                if (subpath !== undefined) {\n                    return key !== \"\" ? `${key}.${subpath}` : subpath\n                }\n            }\n        }\n    }\n    wrapDataInObservable(data) {\n        var self = this\n\n        let updateDom = debounce(function () {\n            self.updateElements(self.$el)\n        }, 0)\n\n        return wrap(data, (target, key) => {\n            // check if is state variable by compoaring target\n            let path = this.findTargetPathInData(this.unobservedData, target)\n            if (path !== undefined) {\n                this.$jmb.set(path === \"\" ? key : `${path}.${key}`, target[key])\n            }\n            if (Object.is(target, this.unobservedData) && Object.keys(this.state).includes(key)) {\n                this.$jmb.set(key, target[key])\n            }\n            if (self.watchers[key]) {\n                // If there's a watcher for this specific key, run it.\n                self.watchers[key].forEach(callback => callback(target[key]))\n            } else if (Array.isArray(target)) {\n                // Arrays are special cases, if any of the items change, we consider the array as mutated.\n                Object.keys(self.watchers)\n                    .forEach(fullDotNotationKey => {\n                        let dotNotationParts = fullDotNotationKey.split('.')\n\n                        // Ignore length mutations since they would result in duplicate calls.\n                        // For example, when calling push, we would get a mutation for the item's key\n                        // and a second mutation for the length property.\n                        if (key === 'length') return\n\n                        dotNotationParts.reduce((comparisonData, part) => {\n                            if (Object.is(target, comparisonData[part])) {\n                                self.watchers[fullDotNotationKey].forEach(callback => callback(target))\n                            }\n\n                            return comparisonData[part]\n                        }, self.unobservedData)\n                    })\n            } else {\n                // Let's walk through the watchers with \"dot-notation\" (foo.bar) and see\n                // if this mutation fits any of them.\n                Object.keys(self.watchers)\n                    .filter(i => i.includes('.'))\n                    .forEach(fullDotNotationKey => {\n                        let dotNotationParts = fullDotNotationKey.split('.')\n\n                        // If this dot-notation watcher's last \"part\" doesn't match the current\n                        // key, then skip it early for performance reasons.\n                        if (key !== dotNotationParts[dotNotationParts.length - 1]) return\n\n                        // Now, walk through the dot-notation \"parts\" recursively to find\n                        // a match, and call the watcher if one's found.\n                        dotNotationParts.reduce((comparisonData, part) => {\n                            if (Object.is(target, comparisonData)) {\n                                // Run the watchers.\n                                self.watchers[fullDotNotationKey].forEach(callback => callback(target[key]))\n                            }\n\n                            return comparisonData[part]\n                        }, self.unobservedData)\n                    })\n            }\n\n            // Don't react to data changes for cases like the `jmb-created` hook.\n            if (self.pauseReactivity) return\n\n            updateDom()\n        })\n    }\n\n    walkAndSkipNestedComponents(el, callback, initializeComponentCallback = () => { }) {\n        walk(el, el => {\n            // We've hit a component.\n            if (el.hasAttribute('jmb-name') || el.hasAttribute('jmb-placeholder')) {\n                // If it's not the current one.\n                if (!el.isSameNode(this.$el)) {\n                    // Initialize it if it's not.\n                    if (!el.__jmb) initializeComponentCallback(el)\n\n                    // Now we'll let that sub-component deal with itself.\n                    return false\n                }\n            }\n\n            return callback(el)\n        })\n    }\n\n    initializeElements(rootEl, extraVars = () => { }) {\n        this.walkAndSkipNestedComponents(rootEl, el => {\n            // Don't touch spawns from for loop\n            if (el.__jmb_for_key !== undefined) return false\n\n            // Don't touch spawns from if directives\n            if (el.__jmb_inserted_me !== undefined) return false\n\n            this.initializeElement(el, extraVars)\n        }, el => {\n            el.__jmb = new Component(el)\n        })\n\n        this.executeAndClearRemainingShowDirectiveStack()\n\n        this.executeAndClearNextTickStack(rootEl)\n    }\n\n    initializeElement(el, extraVars, mutated=false) {\n        // To support class attribute merging, we have to know what the element's\n        // original class attribute looked like for reference.\n        if (el.hasAttribute('class') && getXAttrs(el, this).length > 0) {\n            el.__jmb_original_classes = convertClassStringToArray(el.getAttribute('class'))\n        }\n        // remove all existing listeners\n        if (el.__jmb_listeners !== undefined) {\n            for (const [ltarget, event, handler, options] of el.__jmb_listeners) {\n                ltarget.removeEventListener(event, handler, options)\n            }\n            el.__jmb_listeners = undefined\n        }\n        this.registerListeners(el, extraVars, mutated)\n        this.resolveBoundAttributes(el, true, extraVars)\n    }\n\n    updateElements(rootEl, extraVars = () => { }) {\n        this.walkAndSkipNestedComponents(rootEl, el => {\n            // Don't touch spawns from for loop (and check if the root is actually a for loop in a parent, don't skip it.)\n            if (el.__jmb_for_key !== undefined && !el.isSameNode(this.$el)) return false\n\n            this.updateElement(el, extraVars)\n        }, el => {\n            el.__jmb = new Component(el)\n        })\n\n        this.executeAndClearRemainingShowDirectiveStack()\n\n        this.executeAndClearNextTickStack(rootEl)\n    }\n\n    executeAndClearNextTickStack(el) {\n        // Skip spawns from alpine directives\n        if (el === this.$el && this.nextTickStack.length > 0) {\n            // We run the tick stack after the next frame to allow any\n            // running transitions to pass the initial show stage.\n            requestAnimationFrame(() => {\n                while (this.nextTickStack.length > 0) {\n                    this.nextTickStack.shift()()\n                }\n            })\n        }\n    }\n\n    executeAndClearRemainingShowDirectiveStack() {\n        // The goal here is to start all the jmb-show transitions\n        // and build a nested promise chain so that elements\n        // only hide when the children are finished hiding.\n        this.showDirectiveStack.reverse().map(handler => {\n            return new Promise((resolve, reject) => {\n                handler(resolve, reject)\n            })\n        }).reduce((promiseChain, promise) => {\n            return promiseChain.then(() => {\n                return promise.then(finishElement => {\n                    finishElement()\n                })\n            })\n        }, Promise.resolve(() => { })).catch(e => {\n            if (e !== TRANSITION_CANCELLED) throw e\n        })\n\n        // We've processed the handler stack. let's clear it.\n        this.showDirectiveStack = []\n        this.showDirectiveLastElement = undefined\n    }\n\n    updateElement(el, extraVars) {\n        this.resolveBoundAttributes(el, false, extraVars)\n    }\n\n    registerListeners(el, extraVars, mutated) {\n        getXAttrs(el, this).forEach(({ type, value, modifiers, expression }) => {\n            switch (type) {\n                case 'on':\n                    registerListener(this, el, value, modifiers, expression, extraVars, mutated)\n                    break;\n\n                case 'model':\n                    registerModelListener(this, el, modifiers, expression, extraVars)\n                    break;\n                default:\n                    break;\n            }\n        })\n    }\n\n    resolveBoundAttributes(el, initialUpdate = false, extraVars) {\n        let attrs = getXAttrs(el, this)\n        attrs.forEach(({ type, value, modifiers, expression }) => {\n            switch (type) {\n                case 'model':\n                    handleAttributeBindingDirective(this, el, 'value', expression, extraVars, type, modifiers)\n                    break;\n\n                case 'bind':\n                    // The :key binding on an jmb-for is special, ignore it.\n                    if (el.tagName.toLowerCase() === 'template' && value === 'key') return\n\n                    handleAttributeBindingDirective(this, el, value, expression, extraVars, type, modifiers)\n                    break;\n\n                case 'text':\n                    var output = this.evaluateReturnExpression(el, expression, extraVars);\n\n                    handleTextDirective(el, output, expression)\n                    break;\n\n                case 'html':\n                    handleHtmlDirective(this, el, expression, extraVars)\n                    break;\n\n                case 'show':\n                    var output = this.evaluateReturnExpression(el, expression, extraVars)\n\n                    handleShowDirective(this, el, output, modifiers, initialUpdate)\n                    break;\n\n                case 'if':\n                    // If this element also has jmb-for on it, don't process jmb-if.\n                    // We will let the \"jmb-for\" directive handle the \"if\"ing.\n                    if (attrs.some(i => i.type === 'for')) return\n\n                    var output = this.evaluateReturnExpression(el, expression, extraVars)\n\n                    handleIfDirective(this, el, output, initialUpdate, extraVars)\n                    break;\n\n                case 'for':\n                    handleForDirective(this, el, expression, initialUpdate, extraVars)\n                    break;\n\n                case 'cloak':\n                    el.removeAttribute('jmb-cloak')\n                    break;\n\n                default:\n                    break;\n            }\n        })\n    }\n\n    evaluateReturnExpression(el, expression, extraVars = () => { }) {\n        return saferEval(el, expression, this.$data, {\n            ...extraVars(),\n            $dispatch: this.getDispatchFunction(el),\n        })\n    }\n\n    evaluateCommandExpression(el, expression, extraVars = () => { }) {\n        return saferEvalNoReturn(el, expression, this.$data, {\n            ...extraVars(),\n            $dispatch: this.getDispatchFunction(el),\n        })\n    }\n\n    getDispatchFunction(el) {\n        return (event, detail = {}) => {\n            el.dispatchEvent(new CustomEvent(event, {\n                detail,\n                bubbles: true,\n            }))\n        }\n    }\n\n    listenForNewElementsToInitialize() {\n        const targetNode = this.$el\n\n        const observerOptions = {\n            childList: true,\n            attributes: true,\n            subtree: true,\n        }\n\n        const observer = new MutationObserver((mutations) => {\n            for (let i = 0; i < mutations.length; i++) {\n                // Filter out mutations triggered from child components.\n                const closestParentComponent = mutations[i].target.closest('[jmb-name]')\n\n                if (!(closestParentComponent && closestParentComponent.isSameNode(this.$el))) continue\n\n                if (mutations[i].type === 'attributes' && mutations[i].attributeName === 'jmb-local') {\n                    // @jembeModification\n                    // do nothing jmb-local on subsequent update should be ignore and jmb-update shold be used\n                    // const xAttr = mutations[i].target.getAttribute('jmb-local') || '{}';\n                    // const rawData = saferEval(this.$el, xAttr, { $el: this.$el })\n\n                    // Object.keys(rawData).forEach(key => {\n                    //     if (this.$data[key] !== rawData[key]) {\n                    //         this.$data[key] = rawData[key]\n                    //     }\n                    // })\n                }\n\n                if (mutations[i].addedNodes.length > 0) {\n                    mutations[i].addedNodes.forEach(node => {\n                        if (node.nodeType !== 1 || node.__jmb_inserted_me) return\n                        if ((node.hasAttribute('jmb-name') && node.getAttribute('jmb-name') !== this.execName) || node.hasAttribute('jmb-placeholder')) return\n\n                        // @jembeModification\n                        // can only create component for jembe component it ignores jmb-local on\n                        // other components\n                        // if (node.matches('[jmb-local]') && !node.__jmb) {\n                        //     node.__jmb = new Component(node)\n                        //     return\n                        // }\n\n                        this.initializeElement(node, () => {}, true)\n                    })\n                }\n            }\n        })\n\n        observer.observe(targetNode, observerOptions);\n    }\n\n    getRefsProxy() {\n        var self = this\n\n        var refObj = {}\n\n        /* IE11-ONLY:START */\n        // // Add any properties up-front that might be necessary for the Proxy polyfill.\n        // refObj.$isRefsProxy = false;\n        // refObj.$isAlpineProxy = false;\n\n        // // If we are in IE, since the polyfill needs all properties to be defined before building the proxy,\n        // // we just loop on the element, look for any jmb-ref and create a tmp property on a fake object.\n        // this.walkAndSkipNestedComponents(self.$el, el => {\n        //     if (el.hasAttribute('jmb-ref')) {\n        //         refObj[el.getAttribute('jmb-ref')] = true\n        //     }\n        // })\n        /* IE11-ONLY:END */\n\n        // One of the goals of this is to not hold elements in memory, but rather re-evaluate\n        // the DOM when the system needs something from it. This way, the framework is flexible and\n        // friendly to outside DOM changes from libraries like Vue/Livewire.\n        // For this reason, I'm using an \"on-demand\" proxy to fake a \"$refs\" object.\n        return new Proxy(refObj, {\n            get(object, property) {\n                if (property === '$isAlpineProxy') return true\n\n                var ref\n\n                // We can't just query the DOM because it's hard to filter out refs in\n                // nested components.\n                self.walkAndSkipNestedComponents(self.$el, el => {\n                    if (el.hasAttribute('jmb-ref') && el.getAttribute('jmb-ref') === property) {\n                        ref = el\n                    }\n                })\n\n                return ref\n            }\n        })\n    }\n}\n","import Component from './component'\nimport { domReady, isTesting } from './utils'\n\nclass ComponentAPI extends Component {\n  /**\n   * @param {ComponentRef} componentRef \n   */\n  constructor(componentRef) {\n    super(componentRef.dom)\n    this.jembeClient = componentRef.jembeClient\n    this.componentRef = componentRef\n    this.execName = componentRef.execName\n  }\n  /**\n   * @param {ComponentRef} originalComponentRef \n   */\n  mount(originalComponentRef) {\n    super.mount(\n      this.componentRef.jembeClient,\n      this.componentRef.execName,\n      this.componentRef.state,\n      this.componentRef.actions,\n      (originalComponentRef !== undefined \n        && originalComponentRef.api !== null\n        // TODO handle page component with diferent execName`s\n        && originalComponentRef.execName === this.execName)\n        ? originalComponentRef.api\n        : undefined)\n  }\n  unmount() { \n    super.unmount()\n  }\n}\nexport default ComponentAPI\n\n// const Alpine = {\n//     version: process.env.PKG_VERSION,\n\n//     pauseMutationObserver: false,\n\n//     magicProperties: {},\n\n//     onComponentInitializeds: [],\n\n//     onBeforeComponentInitializeds: [],\n\n//     ignoreFocusedForValueBinding: false,\n\n//     start: async function () {\n//         if (! isTesting()) {\n//             await domReady()\n//         }\n\n//         this.discoverComponents(el => {\n//             this.initializeComponent(el)\n//         })\n\n//         // It's easier and more performant to just support Turbolinks than listen\n//         // to MutationObserver mutations at the document level.\n//         document.addEventListener(\"turbolinks:load\", () => {\n//             this.discoverUninitializedComponents(el => {\n//                 this.initializeComponent(el)\n//             })\n//         })\n\n//         this.listenForNewUninitializedComponentsAtRunTime()\n//     },\n\n//     discoverComponents: function (callback) {\n//         const rootEls = document.querySelectorAll('[x-data]');\n\n//         rootEls.forEach(rootEl => {\n//             callback(rootEl)\n//         })\n//     },\n\n//     discoverUninitializedComponents: function (callback, el = null) {\n//         const rootEls = (el || document).querySelectorAll('[jmb-data]');\n\n//         Array.from(rootEls)\n//             .filter(el => el.__jmb === undefined)\n//             .forEach(rootEl => {\n//                 callback(rootEl)\n//             })\n//     },\n\n//     listenForNewUninitializedComponentsAtRunTime: function () {\n//         const targetNode = document.querySelector('body');\n\n//         const observerOptions = {\n//             childList: true,\n//             attributes: true,\n//             subtree: true,\n//         }\n\n//         const observer = new MutationObserver((mutations) => {\n//             if (this.pauseMutationObserver) return;\n\n//             for (let i=0; i < mutations.length; i++){\n//                 if (mutations[i].addedNodes.length > 0) {\n//                     mutations[i].addedNodes.forEach(node => {\n//                         // Discard non-element nodes (like line-breaks)\n//                         if (node.nodeType !== 1) return\n\n//                         // Discard any changes happening within an existing component.\n//                         // They will take care of themselves.\n//                         if (node.parentElement && node.parentElement.closest('[x-data]')) return\n\n//                         this.discoverUninitializedComponents((el) => {\n//                             this.initializeComponent(el)\n//                         }, node.parentElement)\n//                     })\n//                 }\n//               }\n//         })\n\n//         observer.observe(targetNode, observerOptions)\n//     },\n\n//     initializeComponent: function (el) {\n//         if (! el.__jmb) {\n//             // Wrap in a try/catch so that we don't prevent other components\n//             // from initializing when one component contains an error.\n//             try {\n//                 el.__jmb = new Component(el)\n//             } catch (error) {\n//                 setTimeout(() => {\n//                     throw error\n//                 }, 0)\n//             }\n//         }\n//     },\n\n//     clone: function (component, newEl) {\n//         if (! newEl.__jmb) {\n//             newEl.__jmb = new Component(newEl, component)\n//         }\n//     },\n\n//     addMagicProperty: function (name, callback) {\n//         this.magicProperties[name] = callback\n//     },\n\n//     onComponentInitialized: function (callback) {\n//         this.onComponentInitializeds.push(callback)\n//     },\n\n//     onBeforeComponentInitialized: function (callback) {\n//         this.onBeforeComponentInitializeds.push(callback)\n//     }\n// }\n\n// if (! isTesting()) {\n//     window.Alpine = Alpine\n\n//     if (window.deferLoadingAlpine) {\n//         window.deferLoadingAlpine(function () {\n//             window.Alpine.start()\n//         })\n//    } else {\n//         window.Alpine.start()\n//    }\n// }\n\n// export default Alpine\n","/**\n * Return null or the execName of the component \n * @param {Element} el \n */\nfunction elIsNewComponent(el) {\n  if (el.hasAttribute('jmb-name')) {\n    return el.getAttribute('jmb-name')\n  } else if (el.hasAttribute('jmb-placeholder')) {\n    return el.getAttribute('jmb-placeholder')\n  } else {\n    return null\n  }\n}\n\nfunction walkComponentDom(el, callback, callbackOnNewComponent, myExecName) {\n  if (myExecName === undefined) {\n    myExecName = el.getAttribute('jmb-name')\n  }\n  let componentExecName = elIsNewComponent(el)\n  if (componentExecName !== null && componentExecName !== myExecName) {\n    callbackOnNewComponent(el, componentExecName)\n  } else {\n    if (callback !== undefined) {\n      callback(el)\n    }\n    el = el.firstElementChild\n    while (el) {\n      walkComponentDom(el, callback, callbackOnNewComponent, myExecName)\n      el = el.nextElementSibling\n    }\n  }\n}\n\nlet AsyncFunction = Object.getPrototypeOf(async function () { }).constructor\n\n\nfunction deepCopy(inObject) {\n  let outObject, value, key\n\n  if (typeof inObject !== \"object\" || inObject === null) {\n    return inObject // Return the value if inObject is not an object\n  }\n\n  // Create an array or object to hold the values\n  outObject = Array.isArray(inObject) ? [] : {}\n\n  for (key in inObject) {\n    value = inObject[key]\n\n    // Recursively (deep) copy for nested objects, including arrays\n    outObject[key] = deepCopy(value)\n  }\n\n  return outObject\n}\n/**\n * https://docs.djangoproject.com/en/dev/ref/csrf/#ajax\n */\nfunction getCookie(name) {\n    let cookieValue = null;\n    if (document.cookie && document.cookie !== '') {\n        const cookies = document.cookie.split(';');\n        for (let i = 0; i < cookies.length; i++) {\n            const cookie = cookies[i].trim();\n            // Does this cookie string begin with the name we want?\n            if (cookie.substring(0, name.length + 1) === (name + '=')) {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}\nexport { walkComponentDom, AsyncFunction, deepCopy, getCookie }","var DOCUMENT_FRAGMENT_NODE = 11;\n\nexport default function morphAttrs(fromNode, toNode) {\n    var toNodeAttrs = toNode.attributes;\n    var attr;\n    var attrName;\n    var attrNamespaceURI;\n    var attrValue;\n    var fromValue;\n\n    // document-fragments dont have attributes so lets not do anything\n    if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE || fromNode.nodeType === DOCUMENT_FRAGMENT_NODE) {\n      return;\n    }\n\n    // update attributes on original DOM element\n    for (var i = toNodeAttrs.length - 1; i >= 0; i--) {\n        attr = toNodeAttrs[i];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n        attrValue = attr.value;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n            fromValue = fromNode.getAttributeNS(attrNamespaceURI, attrName);\n\n            if (fromValue !== attrValue) {\n                if (attr.prefix === 'xmlns'){\n                    attrName = attr.name; // It's not allowed to set an attribute with the XMLNS namespace without specifying the `xmlns` prefix\n                }\n                fromNode.setAttributeNS(attrNamespaceURI, attrName, attrValue);\n            }\n        } else {\n            fromValue = fromNode.getAttribute(attrName);\n\n            if (fromValue !== attrValue) {\n                fromNode.setAttribute(attrName, attrValue);\n            }\n        }\n    }\n\n    // Remove any extra attributes found on the original DOM element that\n    // weren't found on the target element.\n    var fromNodeAttrs = fromNode.attributes;\n\n    for (var d = fromNodeAttrs.length - 1; d >= 0; d--) {\n        attr = fromNodeAttrs[d];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n\n            if (!toNode.hasAttributeNS(attrNamespaceURI, attrName)) {\n                fromNode.removeAttributeNS(attrNamespaceURI, attrName);\n            }\n        } else {\n            if (!toNode.hasAttribute(attrName)) {\n                fromNode.removeAttribute(attrName);\n            }\n        }\n    }\n}\n","var range; // Create a range object for efficently rendering strings to elements.\nvar NS_XHTML = 'http://www.w3.org/1999/xhtml';\n\nexport var doc = typeof document === 'undefined' ? undefined : document;\nvar HAS_TEMPLATE_SUPPORT = !!doc && 'content' in doc.createElement('template');\nvar HAS_RANGE_SUPPORT = !!doc && doc.createRange && 'createContextualFragment' in doc.createRange();\n\nfunction createFragmentFromTemplate(str) {\n    var template = doc.createElement('template');\n    template.innerHTML = str;\n    return template.content.childNodes[0];\n}\n\nfunction createFragmentFromRange(str) {\n    if (!range) {\n        range = doc.createRange();\n        range.selectNode(doc.body);\n    }\n\n    var fragment = range.createContextualFragment(str);\n    return fragment.childNodes[0];\n}\n\nfunction createFragmentFromWrap(str) {\n    var fragment = doc.createElement('body');\n    fragment.innerHTML = str;\n    return fragment.childNodes[0];\n}\n\n/**\n * This is about the same\n * var html = new DOMParser().parseFromString(str, 'text/html');\n * return html.body.firstChild;\n *\n * @method toElement\n * @param {String} str\n */\nexport function toElement(str) {\n    str = str.trim();\n    if (HAS_TEMPLATE_SUPPORT) {\n      // avoid restrictions on content for things like `<tr><th>Hi</th></tr>` which\n      // createContextualFragment doesn't support\n      // <template> support not available in IE\n      return createFragmentFromTemplate(str);\n    } else if (HAS_RANGE_SUPPORT) {\n      return createFragmentFromRange(str);\n    }\n\n    return createFragmentFromWrap(str);\n}\n\n/**\n * Returns true if two node's names are the same.\n *\n * NOTE: We don't bother checking `namespaceURI` because you will never find two HTML elements with the same\n *       nodeName and different namespace URIs.\n *\n * @param {Element} a\n * @param {Element} b The target element\n * @return {boolean}\n */\nexport function compareNodeNames(fromEl, toEl) {\n    var fromNodeName = fromEl.nodeName;\n    var toNodeName = toEl.nodeName;\n    var fromCodeStart, toCodeStart;\n\n    if (fromNodeName === toNodeName) {\n        return true;\n    }\n\n    fromCodeStart = fromNodeName.charCodeAt(0);\n    toCodeStart = toNodeName.charCodeAt(0);\n\n    // If the target element is a virtual DOM node or SVG node then we may\n    // need to normalize the tag name before comparing. Normal HTML elements that are\n    // in the \"http://www.w3.org/1999/xhtml\"\n    // are converted to upper case\n    if (fromCodeStart <= 90 && toCodeStart >= 97) { // from is upper and to is lower\n        return fromNodeName === toNodeName.toUpperCase();\n    } else if (toCodeStart <= 90 && fromCodeStart >= 97) { // to is upper and from is lower\n        return toNodeName === fromNodeName.toUpperCase();\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create an element, optionally with a known namespace URI.\n *\n * @param {string} name the element name, e.g. 'div' or 'svg'\n * @param {string} [namespaceURI] the element's namespace URI, i.e. the value of\n * its `xmlns` attribute or its inferred namespace.\n *\n * @return {Element}\n */\nexport function createElementNS(name, namespaceURI) {\n    return !namespaceURI || namespaceURI === NS_XHTML ?\n        doc.createElement(name) :\n        doc.createElementNS(namespaceURI, name);\n}\n\n/**\n * Copies the children of one DOM element to another DOM element\n */\nexport function moveChildren(fromEl, toEl) {\n    var curChild = fromEl.firstChild;\n    while (curChild) {\n        var nextChild = curChild.nextSibling;\n        toEl.appendChild(curChild);\n        curChild = nextChild;\n    }\n    return toEl;\n}\n","function syncBooleanAttrProp(fromEl, toEl, name) {\n    if (fromEl[name] !== toEl[name]) {\n        fromEl[name] = toEl[name];\n        if (fromEl[name]) {\n            fromEl.setAttribute(name, '');\n        } else {\n            fromEl.removeAttribute(name);\n        }\n    }\n}\n\nexport default {\n    OPTION: function(fromEl, toEl) {\n        var parentNode = fromEl.parentNode;\n        if (parentNode) {\n            var parentName = parentNode.nodeName.toUpperCase();\n            if (parentName === 'OPTGROUP') {\n                parentNode = parentNode.parentNode;\n                parentName = parentNode && parentNode.nodeName.toUpperCase();\n            }\n            if (parentName === 'SELECT' && !parentNode.hasAttribute('multiple')) {\n                if (fromEl.hasAttribute('selected') && !toEl.selected) {\n                    // Workaround for MS Edge bug where the 'selected' attribute can only be\n                    // removed if set to a non-empty value:\n                    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12087679/\n                    fromEl.setAttribute('selected', 'selected');\n                    fromEl.removeAttribute('selected');\n                }\n                // We have to reset select element's selectedIndex to -1, otherwise setting\n                // fromEl.selected using the syncBooleanAttrProp below has no effect.\n                // The correct selectedIndex will be set in the SELECT special handler below.\n                parentNode.selectedIndex = -1;\n            }\n        }\n        syncBooleanAttrProp(fromEl, toEl, 'selected');\n    },\n    /**\n     * The \"value\" attribute is special for the <input> element since it sets\n     * the initial value. Changing the \"value\" attribute without changing the\n     * \"value\" property will have no effect since it is only used to the set the\n     * initial value.  Similar for the \"checked\" attribute, and \"disabled\".\n     */\n    INPUT: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'checked');\n        syncBooleanAttrProp(fromEl, toEl, 'disabled');\n\n        if (fromEl.value !== toEl.value) {\n            fromEl.value = toEl.value;\n        }\n\n        if (!toEl.hasAttribute('value')) {\n            fromEl.removeAttribute('value');\n        }\n    },\n\n    TEXTAREA: function(fromEl, toEl) {\n        var newValue = toEl.value;\n        if (fromEl.value !== newValue) {\n            fromEl.value = newValue;\n        }\n\n        var firstChild = fromEl.firstChild;\n        if (firstChild) {\n            // Needed for IE. Apparently IE sets the placeholder as the\n            // node value and vise versa. This ignores an empty update.\n            var oldValue = firstChild.nodeValue;\n\n            if (oldValue == newValue || (!newValue && oldValue == fromEl.placeholder)) {\n                return;\n            }\n\n            firstChild.nodeValue = newValue;\n        }\n    },\n    SELECT: function(fromEl, toEl) {\n        if (!toEl.hasAttribute('multiple')) {\n            var selectedIndex = -1;\n            var i = 0;\n            // We have to loop through children of fromEl, not toEl since nodes can be moved\n            // from toEl to fromEl directly when morphing.\n            // At the time this special handler is invoked, all children have already been morphed\n            // and appended to / removed from fromEl, so using fromEl here is safe and correct.\n            var curChild = fromEl.firstChild;\n            var optgroup;\n            var nodeName;\n            while(curChild) {\n                nodeName = curChild.nodeName && curChild.nodeName.toUpperCase();\n                if (nodeName === 'OPTGROUP') {\n                    optgroup = curChild;\n                    curChild = optgroup.firstChild;\n                } else {\n                    if (nodeName === 'OPTION') {\n                        if (curChild.hasAttribute('selected')) {\n                            selectedIndex = i;\n                            break;\n                        }\n                        i++;\n                    }\n                    curChild = curChild.nextSibling;\n                    if (!curChild && optgroup) {\n                        curChild = optgroup.nextSibling;\n                        optgroup = null;\n                    }\n                }\n            }\n\n            fromEl.selectedIndex = selectedIndex;\n        }\n    }\n};\n","'use strict';\n/**\n * Changes taged with @jembeModification\n * \n */\n\nimport { compareNodeNames, toElement, moveChildren, createElementNS, doc } from './util';\nimport specialElHandlers from './specialElHandlers';\n\nvar ELEMENT_NODE = 1;\nvar DOCUMENT_FRAGMENT_NODE = 11;\nvar TEXT_NODE = 3;\nvar COMMENT_NODE = 8;\n\nfunction noop() {}\n\nfunction defaultGetNodeKey(node) {\n  if (node) {\n      return (node.getAttribute && node.getAttribute('id')) || node.id;\n  }\n}\n\nexport default function morphdomFactory(morphAttrs) {\n\n    return function morphdom(fromNode, toNode, options) {\n        if (!options) {\n            options = {};\n        }\n\n        if (typeof toNode === 'string') {\n            if (fromNode.nodeName === '#document' || fromNode.nodeName === 'HTML' || fromNode.nodeName === 'BODY') {\n                var toNodeHtml = toNode;\n                toNode = doc.createElement('html');\n                toNode.innerHTML = toNodeHtml;\n            } else {\n                toNode = toElement(toNode);\n            }\n        } else if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE) {\n          toNode = toNode.firstElementChild;\n        }\n\n        var getNodeKey = options.getNodeKey || defaultGetNodeKey;\n        var onBeforeNodeAdded = options.onBeforeNodeAdded || noop;\n        var onNodeAdded = options.onNodeAdded || noop;\n        var onBeforeElUpdated = options.onBeforeElUpdated || noop;\n        var onElUpdated = options.onElUpdated || noop;\n        var onBeforeNodeDiscarded = options.onBeforeNodeDiscarded || noop;\n        var onNodeDiscarded = options.onNodeDiscarded || noop;\n        var onBeforeElChildrenUpdated = options.onBeforeElChildrenUpdated || noop;\n        var childrenOnly = options.childrenOnly === true;\n\n        // This object is used as a lookup to quickly find all keyed elements in the original DOM tree.\n        var fromNodesLookup = Object.create(null);\n        var keyedRemovalList = [];\n\n        function addKeyedRemoval(key) {\n            keyedRemovalList.push(key);\n        }\n\n        function walkDiscardedChildNodes(node, skipKeyedNodes) {\n            if (node.nodeType === ELEMENT_NODE) {\n                var curChild = node.firstChild;\n                while (curChild) {\n\n                    var key = undefined;\n\n                    if (skipKeyedNodes && (key = getNodeKey(curChild))) {\n                        // If we are skipping keyed nodes then we add the key\n                        // to a list so that it can be handled at the very end.\n                        addKeyedRemoval(key);\n                    } else {\n                        // Only report the node as discarded if it is not keyed. We do this because\n                        // at the end we loop through all keyed elements that were unmatched\n                        // and then discard them in one final pass.\n                        onNodeDiscarded(curChild);\n                        if (curChild.firstChild) {\n                            walkDiscardedChildNodes(curChild, skipKeyedNodes);\n                        }\n                    }\n\n                    curChild = curChild.nextSibling;\n                }\n            }\n        }\n\n        /**\n         * Removes a DOM node out of the original DOM\n         *\n         * @param  {Node} node The node to remove\n         * @param  {Node} parentNode The nodes parent\n         * @param  {Boolean} skipKeyedNodes If true then elements with keys will be skipped and not discarded.\n         * @return {undefined}\n         */\n        function removeNode(node, parentNode, skipKeyedNodes) {\n            if (onBeforeNodeDiscarded(node) === false) {\n                return;\n            }\n\n            if (parentNode) {\n                parentNode.removeChild(node);\n            }\n\n            onNodeDiscarded(node);\n            walkDiscardedChildNodes(node, skipKeyedNodes);\n        }\n\n        // // TreeWalker implementation is no faster, but keeping this around in case this changes in the future\n        // function indexTree(root) {\n        //     var treeWalker = document.createTreeWalker(\n        //         root,\n        //         NodeFilter.SHOW_ELEMENT);\n        //\n        //     var el;\n        //     while((el = treeWalker.nextNode())) {\n        //         var key = getNodeKey(el);\n        //         if (key) {\n        //             fromNodesLookup[key] = el;\n        //         }\n        //     }\n        // }\n\n        // // NodeIterator implementation is no faster, but keeping this around in case this changes in the future\n        //\n        // function indexTree(node) {\n        //     var nodeIterator = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT);\n        //     var el;\n        //     while((el = nodeIterator.nextNode())) {\n        //         var key = getNodeKey(el);\n        //         if (key) {\n        //             fromNodesLookup[key] = el;\n        //         }\n        //     }\n        // }\n\n        function indexTree(node) {\n            if (node.nodeType === ELEMENT_NODE || node.nodeType === DOCUMENT_FRAGMENT_NODE) {\n                var curChild = node.firstChild;\n                while (curChild) {\n                    var key = getNodeKey(curChild);\n                    if (key) {\n                        fromNodesLookup[key] = curChild;\n                    }\n\n                    // Walk recursively\n                    indexTree(curChild);\n\n                    curChild = curChild.nextSibling;\n                }\n            }\n        }\n\n        indexTree(fromNode);\n\n        function handleNodeAdded(el) {\n            onNodeAdded(el);\n\n            var curChild = el.firstChild;\n            while (curChild) {\n                var nextSibling = curChild.nextSibling;\n\n                var key = getNodeKey(curChild);\n                if (key) {\n                    var unmatchedFromEl = fromNodesLookup[key];\n                    // if we find a duplicate #id node in cache, replace `el` with cache value\n                    // and morph it to the child node.\n                    if (unmatchedFromEl && compareNodeNames(curChild, unmatchedFromEl)) {\n                        curChild.parentNode.replaceChild(unmatchedFromEl, curChild);\n                        morphEl(unmatchedFromEl, curChild);\n                    } else {\n                      handleNodeAdded(curChild);\n                    }\n                } else {\n                  // recursively call for curChild and it's children to see if we find something in\n                  // fromNodesLookup\n                  handleNodeAdded(curChild);\n                }\n\n                curChild = nextSibling;\n            }\n        }\n\n        function cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey) {\n            // We have processed all of the \"to nodes\". If curFromNodeChild is\n            // non-null then we still have some from nodes left over that need\n            // to be removed\n            while (curFromNodeChild) {\n                var fromNextSibling = curFromNodeChild.nextSibling;\n                if ((curFromNodeKey = getNodeKey(curFromNodeChild))) {\n                    // Since the node is keyed it might be matched up later so we defer\n                    // the actual removal to later\n                    addKeyedRemoval(curFromNodeKey);\n                } else {\n                    // NOTE: we skip nested keyed nodes from being removed since there is\n                    //       still a chance they will be matched up later\n                    removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                }\n                curFromNodeChild = fromNextSibling;\n            }\n        }\n\n        function morphEl(fromEl, toEl, childrenOnly) {\n            var toElKey = getNodeKey(toEl);\n\n            if (toElKey) {\n                // If an element with an ID is being morphed then it will be in the final\n                // DOM so clear it out of the saved elements collection\n                delete fromNodesLookup[toElKey];\n            }\n\n            if (!childrenOnly) {\n                // optional\n                if (onBeforeElUpdated(fromEl, toEl) === false) {\n                    return;\n                }\n\n                // update attributes on original DOM element first\n                morphAttrs(fromEl, toEl);\n                // optional\n                onElUpdated(fromEl);\n\n                if (onBeforeElChildrenUpdated(fromEl, toEl) === false) {\n                    return;\n                }\n            }\n\n            if (fromEl.nodeName !== 'TEXTAREA') {\n              morphChildren(fromEl, toEl);\n            } else {\n              specialElHandlers.TEXTAREA(fromEl, toEl);\n            }\n        }\n\n        function morphChildren(fromEl, toEl) {\n            var curToNodeChild = toEl.firstChild;\n            var curFromNodeChild = fromEl.firstChild;\n            var curToNodeKey;\n            var curFromNodeKey;\n\n            var fromNextSibling;\n            var toNextSibling;\n            var matchingFromEl;\n\n            // walk the children\n            outer: while (curToNodeChild) {\n                toNextSibling = curToNodeChild.nextSibling;\n                curToNodeKey = getNodeKey(curToNodeChild);\n\n                // walk the fromNode children all the way through\n                while (curFromNodeChild) {\n                    fromNextSibling = curFromNodeChild.nextSibling;\n\n                    if (curToNodeChild.isSameNode && curToNodeChild.isSameNode(curFromNodeChild)) {\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    curFromNodeKey = getNodeKey(curFromNodeChild);\n\n                    var curFromNodeType = curFromNodeChild.nodeType;\n\n                    // this means if the curFromNodeChild doesnt have a match with the curToNodeChild\n                    var isCompatible = undefined;\n\n                    if (curFromNodeType === curToNodeChild.nodeType) {\n                        if (curFromNodeType === ELEMENT_NODE) {\n                            // Both nodes being compared are Element nodes\n\n                            if (curToNodeKey) {\n                                // The target node has a key so we want to match it up with the correct element\n                                // in the original DOM tree\n                                if (curToNodeKey !== curFromNodeKey) {\n                                    // The current element in the original DOM tree does not have a matching key so\n                                    // let's check our lookup to see if there is a matching element in the original\n                                    // DOM tree\n                                    if ((matchingFromEl = fromNodesLookup[curToNodeKey])) {\n                                        if (fromNextSibling === matchingFromEl) {\n                                            // Special case for single element removals. To avoid removing the original\n                                            // DOM node out of the tree (since that can break CSS transitions, etc.),\n                                            // we will instead discard the current node and wait until the next\n                                            // iteration to properly match up the keyed target element with its matching\n                                            // element in the original tree\n                                            isCompatible = false;\n                                        } else {\n                                            // We found a matching keyed element somewhere in the original DOM tree.\n                                            // Let's move the original DOM node into the current position and morph\n                                            // it.\n\n                                            // NOTE: We use insertBefore instead of replaceChild because we want to go through\n                                            // the `removeNode()` function for the node that is being discarded so that\n                                            // all lifecycle hooks are correctly invoked\n                                            fromEl.insertBefore(matchingFromEl, curFromNodeChild);\n\n                                            // fromNextSibling = curFromNodeChild.nextSibling;\n\n                                            if (curFromNodeKey) {\n                                                // Since the node is keyed it might be matched up later so we defer\n                                                // the actual removal to later\n                                                addKeyedRemoval(curFromNodeKey);\n                                            } else {\n                                                // NOTE: we skip nested keyed nodes from being removed since there is\n                                                //       still a chance they will be matched up later\n                                                removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                                            }\n\n                                            curFromNodeChild = matchingFromEl;\n                                        }\n                                    } else {\n                                        // The nodes are not compatible since the \"to\" node has a key and there\n                                        // is no matching keyed node in the source tree\n                                        isCompatible = false;\n                                    }\n                                }\n                            } else if (curFromNodeKey) {\n                                // The original has a key\n                                isCompatible = false;\n                            }\n\n                            isCompatible = isCompatible !== false && compareNodeNames(curFromNodeChild, curToNodeChild);\n                            if (isCompatible) {\n                                // @jembeModification\n                                // If the two nodes are different, but the next element is an exact match,\n                                // we can assume that the new node is meant to be inserted, instead of\n                                // used as a morph target.\n                                // original at: https://github.com/livewire/livewire/blob/master/js/dom/morphdom/morphdom.js\n                                if (\n                                    ! curToNodeChild.isEqualNode(curFromNodeChild)\n                                    && curToNodeChild.nextElementSibling\n                                    && curToNodeChild.nextElementSibling.isEqualNode(curFromNodeChild)\n                                ) {\n                                    isCompatible = false\n                                } else {\n                                    // We found compatible DOM elements so transform\n                                    // the current \"from\" node to match the current\n                                    // target DOM node.\n                                    // MORPH\n                                    morphEl(curFromNodeChild, curToNodeChild);\n                                }\n                            }\n\n                        } else if (curFromNodeType === TEXT_NODE || curFromNodeType == COMMENT_NODE) {\n                            // Both nodes being compared are Text or Comment nodes\n                            isCompatible = true;\n                            // Simply update nodeValue on the original node to\n                            // change the text value\n                            if (curFromNodeChild.nodeValue !== curToNodeChild.nodeValue) {\n                                curFromNodeChild.nodeValue = curToNodeChild.nodeValue;\n                            }\n\n                        }\n                    }\n\n                    if (isCompatible) {\n                        // Advance both the \"to\" child and the \"from\" child since we found a match\n                        // Nothing else to do as we already recursively called morphChildren above\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    // @jembeModification\n                    // Before we just remove the original element, let's see if it's the very next\n                    // element in the \"to\" list. If it is, we can assume we can insert the new\n                    // element before the original one instead of removing it. This is kind of\n                    // a \"look-ahead\".\n                    // original at: https://github.com/livewire/livewire/blob/master/js/dom/morphdom/morphdom.js\n                    if (curToNodeChild.nextElementSibling && curToNodeChild.nextElementSibling.isEqualNode(curFromNodeChild)) {\n                        const nodeToBeAdded = curToNodeChild.cloneNode(true)\n                        fromEl.insertBefore(nodeToBeAdded, curFromNodeChild)\n                        handleNodeAdded(nodeToBeAdded)\n                        curToNodeChild = curToNodeChild.nextElementSibling.nextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    } else {\n                        // No compatible match so remove the old node from the DOM and continue trying to find a\n                        // match in the original DOM. However, we only do this if the from node is not keyed\n                        // since it is possible that a keyed node might match up with a node somewhere else in the\n                        // target tree and we don't want to discard it just yet since it still might find a\n                        // home in the final DOM tree. After everything is done we will remove any keyed nodes\n                        // that didn't find a home\n                        if (curFromNodeKey) {\n                            // Since the node is keyed it might be matched up later so we defer\n                            // the actual removal to later\n                            addKeyedRemoval(curFromNodeKey);\n                        } else {\n                            // NOTE: we skip nested keyed nodes from being removed since there is\n                            //       still a chance they will be matched up later\n                            removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                        }\n                    }\n                    curFromNodeChild = fromNextSibling;\n                } // END: while(curFromNodeChild) {}\n\n                // If we got this far then we did not find a candidate match for\n                // our \"to node\" and we exhausted all of the children \"from\"\n                // nodes. Therefore, we will just append the current \"to\" node\n                // to the end\n                if (curToNodeKey && (matchingFromEl = fromNodesLookup[curToNodeKey]) && compareNodeNames(matchingFromEl, curToNodeChild)) {\n                    fromEl.appendChild(matchingFromEl);\n                    // MORPH\n                    morphEl(matchingFromEl, curToNodeChild);\n                } else {\n                    var onBeforeNodeAddedResult = onBeforeNodeAdded(curToNodeChild);\n                    if (onBeforeNodeAddedResult !== false) {\n                        if (onBeforeNodeAddedResult) {\n                            curToNodeChild = onBeforeNodeAddedResult;\n                        }\n\n                        if (curToNodeChild.actualize) {\n                            curToNodeChild = curToNodeChild.actualize(fromEl.ownerDocument || doc);\n                        }\n                        fromEl.appendChild(curToNodeChild);\n                        handleNodeAdded(curToNodeChild);\n                    }\n                }\n\n                curToNodeChild = toNextSibling;\n                curFromNodeChild = fromNextSibling;\n            }\n\n            cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey);\n\n            var specialElHandler = specialElHandlers[fromEl.nodeName];\n            if (specialElHandler) {\n                specialElHandler(fromEl, toEl);\n            }\n        } // END: morphChildren(...)\n\n        var morphedNode = fromNode;\n        var morphedNodeType = morphedNode.nodeType;\n        var toNodeType = toNode.nodeType;\n\n        if (!childrenOnly) {\n            // Handle the case where we are given two DOM nodes that are not\n            // compatible (e.g. <div> --> <span> or <div> --> TEXT)\n            if (morphedNodeType === ELEMENT_NODE) {\n                if (toNodeType === ELEMENT_NODE) {\n                    if (!compareNodeNames(fromNode, toNode)) {\n                        onNodeDiscarded(fromNode);\n                        morphedNode = moveChildren(fromNode, createElementNS(toNode.nodeName, toNode.namespaceURI));\n                    }\n                } else {\n                    // Going from an element node to a text node\n                    morphedNode = toNode;\n                }\n            } else if (morphedNodeType === TEXT_NODE || morphedNodeType === COMMENT_NODE) { // Text or comment node\n                if (toNodeType === morphedNodeType) {\n                    if (morphedNode.nodeValue !== toNode.nodeValue) {\n                        morphedNode.nodeValue = toNode.nodeValue;\n                    }\n\n                    return morphedNode;\n                } else {\n                    // Text node to something else\n                    morphedNode = toNode;\n                }\n            }\n        }\n\n        if (morphedNode === toNode) {\n            // The \"to node\" was not compatible with the \"from node\" so we had to\n            // toss out the \"from node\" and use the \"to node\"\n            onNodeDiscarded(fromNode);\n        } else {\n            if (toNode.isSameNode && toNode.isSameNode(morphedNode)) {\n                return;\n            }\n\n            morphEl(morphedNode, toNode, childrenOnly);\n\n            // We now need to loop over any keyed nodes that might need to be\n            // removed. We only do the removal if we know that the keyed node\n            // never found a match. When a keyed node is matched up we remove\n            // it out of fromNodesLookup and we use fromNodesLookup to determine\n            // if a keyed node has been matched up or not\n            if (keyedRemovalList) {\n                for (var i=0, len=keyedRemovalList.length; i<len; i++) {\n                    var elToRemove = fromNodesLookup[keyedRemovalList[i]];\n                    if (elToRemove) {\n                        removeNode(elToRemove, elToRemove.parentNode, false);\n                    }\n                }\n            }\n        }\n\n        if (!childrenOnly && morphedNode !== fromNode && fromNode.parentNode) {\n            if (morphedNode.actualize) {\n                morphedNode = morphedNode.actualize(fromNode.ownerDocument || doc);\n            }\n            // If we had to swap out the from node with a new node because the old\n            // node was not compatible with the target node then we need to\n            // replace the old DOM node in the original DOM tree. This is only\n            // possible if the original DOM node was part of a DOM tree which\n            // we know is the case if it has a parent node.\n            fromNode.parentNode.replaceChild(morphedNode, fromNode);\n        }\n\n        return morphedNode;\n    };\n}\n","import morphAttrs from './morphAttrs';\nimport morphdomFactory from './morphdom';\n\nvar morphdom = morphdomFactory(morphAttrs);\n\nexport default morphdom;","import ComponentAPI from \"./componentApi/index.js\"\nimport { deepCopy, walkComponentDom, getCookie } from \"./utils.js\"\nimport morphdom from \"./morphdom/index.js\"\nimport { walk } from \"./componentApi/utils.js\"\nimport JMB from \"./componentApi/magic/jmb.js\"\n\n/**\n * Reference to component html with associated data\n */\nclass ComponentRef {\n\n  constructor(jembeClient, execName, data, dom, onDocument) {\n    this.jembeClient = jembeClient\n\n    this.execName = execName\n    this.hierarchyLevel = execName.split(\"/\").length\n    this.isPageComponent = this.hierarchyLevel === 2\n\n    this.state = data.state\n    this.url = data.url\n    this.changesUrl = data.changesUrl\n    this.actions = data.actions !== undefined ? data.actions : {}\n    this.dom = this._cleanDom(dom)\n    this.onDocument = onDocument\n\n    this.placeHolders = {}\n    this.api = null\n  }\n  mount(originalComponentRef = undefined) {\n    this._getPlaceHolders()\n    if (this.api === null) {\n      this.api = new ComponentAPI(this)\n    }\n    this.api.mount(originalComponentRef)\n  }\n  unmount() {\n    if (this.api !== null) {\n      this.api.unmount()\n    }\n    this.api = null\n    this.dom = null\n  }\n  toJsonRequest() {\n    return {\n      \"execName\": this.execName,\n      \"state\": this.state\n    }\n  }\n\n  merge(parentComponent, originalComponent) {\n    if (this.isPageComponent && this.onDocument) {\n      // if page component is already on document do nothing\n      // because it is already mounted and it's not changed\n      return\n    }\n    if (this.onDocument\n      && originalComponent !== undefined\n      && originalComponent.dom.isSameNode(this.dom)) {\n      // no need to unmount-merge-mount component that is already on document\n      if (!parentComponent.placeHolders[this.execName].isSameNode(this.dom)) {\n        // but if paramet is changed we need to update parent place holders\n        parentComponent.placeHolders[this.execName].replaceWith(this.dom)\n        parentComponent.placeHolders[this.execName] = this.dom\n      }\n      return\n    }\n\n    if (this.isPageComponent) {\n      let documentElement = this.jembeClient.document.documentElement\n      this.dom = documentElement = this._morphdom(documentElement, this.dom)\n      this.dom.setAttribute(\"jmb-name\", this.execName)\n    } else {\n      this.dom = this._morphdom(parentComponent.placeHolders[this.execName], this.dom)\n      parentComponent.placeHolders[this.execName] = this.dom\n    }\n\n    this.onDocument = true\n\n    this.mount(\n      originalComponent !== undefined && originalComponent.execName === this.execName\n        ? originalComponent\n        : undefined\n    )\n\n  }\n\n  _morphdom(from, to) {\n    return morphdom(\n      from,\n      to,\n      {\n        getNodeKey: node => {\n          return (node.nodeType === Node.ELEMENT_NODE && node.hasAttribute('jmb-name'))\n            ? node.getAttribute('jmb-name')\n            : node.id\n        },\n        onBeforeElUpdated: (fromEl, toEl) => {\n          // spec - https://dom.spec.whatwg.org/#concept-node-equals\n          if (fromEl.isEqualNode(toEl)) {\n            return false\n          }\n          // don't pass to next component or template\n          if (!this.isPageComponent\n            && fromEl.hasAttribute('jmb-name')\n            && fromEl.getAttribute('jmb-name') !== this.execName) return false\n          if (fromEl.hasAttribute('jmb-placeholder')\n            && fromEl.getAttribute('jmb-placeholder') !== this.execName) return false\n          if (fromEl.hasAttribute('jmb-ignore')) {\n            return false\n          }\n\n          return true\n        },\n        childrenOnly: this.isPageComponent\n      }\n    )\n  }\n  _getPlaceHolders() {\n    this.placeHolders = {}\n    walkComponentDom(\n      this.dom,\n      undefined,\n      (el, execName) => {\n        // populate placeHolders\n        this.placeHolders[execName] = el\n      }\n    )\n  }\n  _cleanDom(dom) {\n    // if html dom has only one child use that child to put jmb-name tag\n    // if not enclose html with div and put jmb-name into it\n    if (typeof dom === \"string\") {\n      let domString = dom.trim()\n      if (!this.isPageComponent) {\n\n        let template = this.jembeClient.document.createElement(\"template\")\n        template.innerHTML = domString\n        // check is it needed to add souranding DIV tag\n        if (template.content.childNodes.length > 1 ||\n          template.content.childNodes.length === 0 ||\n          template.content.firstChild.nodeType === Node.TEXT_NODE ||\n          (template.content.childNodes.length === 1 &&\n            (template.content.firstChild.hasAttribute(\"jmb-name\") ||\n              template.content.firstChild.hasAttribute(\"jmb-placeholder\")))) {\n          let div = this.jembeClient.document.createElement(\"div\")\n          let curChild = template.content.firstChild\n          while (curChild) {\n            let nextChild = curChild.nextSibling\n            div.appendChild(curChild)\n            curChild = nextChild\n          }\n          template.content.appendChild(div)\n        }\n        // add jmb-name tag\n        template.content.firstChild.setAttribute(\"jmb-name\", this.execName)\n        dom = template.content.firstChild\n      } else {\n        const doc = this.jembeClient.domParser.parseFromString(domString, \"text/html\")\n        doc.documentElement.setAttribute(\"jmb-name\", this.execName)\n        dom = doc.documentElement\n      }\n    }\n    dom.removeAttribute('jmb-data')\n    return dom\n  }\n}\n\n\nclass UploadedFile {\n  constructor(execName, paramName, fileUploadId, files) {\n    this.execName = execName\n    this.paramName = paramName\n    this.fileUploadId = fileUploadId\n    this.files = files\n    this.multipleFiles = files instanceof FileList || files instanceof Array\n  }\n  addToFormData(formData) {\n    if (this.multipleFiles) {\n      for (const file of this.files) {\n        formData.append(this.fileUploadId, file)\n      }\n    } else {\n      formData.append(this.fileUploadId, this.files)\n    }\n  }\n}\n/**\n * Handle all jembe logic on client side, primarly building, sending, processing \n * and refreshing page for/on x-jembe requests\n */\nclass JembeClient {\n  constructor(doc = document) {\n    this.document = doc\n    this.components = {}\n    this.getComponentsFromDocument()\n    this.updateLocation(true)\n    this.commands = []\n    this.filesForUpload = {}\n    this.domParser = new DOMParser()\n    this.xRequestUrl = null\n\n    this.xRequestsInProgress = 0\n    this.xRequestActiveElement = null\n    this.xRequestDisabledElements = []\n    this.disableInputBeforeRequestTimeoutId = null\n\n    window.onpopstate = this.onHistoryPopState\n\n    // support adding x-jembe request headers\n    this.xRequestHeadersGenerators = []\n  }\n  /**\n   * Finds all jmb-name and associate jmb-data tags in document \n   * and create ComponentRefs\n   */\n  getComponentsFromDocument() {\n    this.components = {}\n    let componentsNodes = this.document.querySelectorAll(\"[jmb-name][jmb-data]\")\n    for (const componentNode of componentsNodes) {\n      const componentRef = new ComponentRef(\n        this,\n        componentNode.getAttribute('jmb-name'),\n        eval(`(${componentNode.getAttribute('jmb-data')})`),\n        componentNode,\n        true\n      )\n      this.components[componentRef.execName] = componentRef\n      componentRef.mount()\n    }\n  }\n  /**\n   * Create dict of {execName:component} for all components find in\n   * x-jembe response\n   * @param {*} xJembeResponse \n   */\n  getComponentsFromXResponse(xJembeResponse) {\n    let components = {}\n    for (const xComp of xJembeResponse) {\n      const dom = xComp.dom\n      components[xComp.execName] = new ComponentRef(\n        this,\n        xComp.execName,\n        {\n          \"url\": xComp.url,\n          \"changesUrl\": xComp.changesUrl,\n          \"state\": xComp.state,\n          \"actions\": xComp.actions\n        },\n        xComp.dom,\n        false\n      )\n    }\n    return components\n  }\n  /**\n   * Update document with new components:dict\n   * @param {} components \n   */\n  updateDocument(components) {\n    // make list of all existing components that can be display on updated document\n    // list contains all from this.components merged with components where\n    // if there is components with same execname one from components is used\n    let currentComponents = {}\n    // add from this.components if not exist in components otherwise add from components\n    for (const [execName, compRef] of Object.entries(this.components)) {\n      if (components[execName] === undefined) {\n        currentComponents[execName] = compRef\n      } else {\n        currentComponents[execName] = components[execName]\n      }\n    }\n    // add from components if not already added\n    for (const [execName, compRef] of Object.entries(components)) {\n      if (currentComponents[execName] === undefined) {\n        currentComponents[execName] = compRef\n      }\n    }\n    //process current components one by one starting with root page\n    // all components gatthered from document but whitout its placeholder\n    // will be ignored.\n    // chose root/page component from compoents if it exist otherwise use\n    // one on the document\n    let pageExecNames = Object.values(currentComponents).filter(\n      c => c.isPageComponent\n    ).map(\n      c => c.execName\n    )\n    // execName of new pageComponent \n    let pageExecName = pageExecNames[0]\n    if (pageExecNames.length > 1) {\n      for (const pen of pageExecNames) {\n        if (!currentComponents[pen].onDocument) {\n          pageExecName = pen\n        }\n      }\n    }\n    let processingExecNames = [pageExecName]\n    let newComponents = {}\n    while (processingExecNames.length > 0) {\n      const currentComponent = currentComponents[\n        processingExecNames.shift()\n      ]\n      let orignalComponent = this.components[currentComponent.execName]\n      let parentComponent = Object.values(newComponents).find(\n        c => Object.keys(c.placeHolders).includes(currentComponent.execName)\n      )\n      currentComponent.merge(parentComponent, orignalComponent)\n      newComponents[currentComponent.execName] = currentComponent\n      for (const placeHolderName of Object.keys(currentComponent.placeHolders)) {\n        processingExecNames.push(placeHolderName)\n      }\n    }\n    // unmount components that will be removed\n    for (const [execName, component] of Object.entries(this.components)) {\n      if (!Object.keys(newComponents).includes(execName)\n        || newComponents[execName] !== component) {\n        component.unmount()\n      }\n    }\n\n    this.components = newComponents\n  }\n\n  addInitialiseCommand(execName, initParams, mergeExistingParams = true) {\n    const exisitingInitCommands = this.commands.filter(\n      x => x.type === \"init\" && x.componentExecName === execName\n    )\n    if (mergeExistingParams === true && exisitingInitCommands.length > 0) {\n      const existingCmd = exisitingInitCommands[0]\n      for (const [paramName, paramValue] of Object.entries(initParams)) {\n        existingCmd.initParams = this._updateParam(\n          existingCmd.initParams, paramName, paramValue\n        )\n      }\n\n    } else {\n      if (mergeExistingParams === true\n        && Object.keys(initParams).length === 0 &&\n        this.components[execName] !== undefined) {\n        // dont add init command for existing components if no params are changed\n        return\n      }\n      let params = (mergeExistingParams === true && this.components[execName] !== undefined) ? deepCopy(this.components[execName].state) : {}\n      for (const [paramName, paramValue] of Object.entries(initParams)) {\n        params = this._updateParam(params, paramName, paramValue)\n      }\n      if (mergeExistingParams === false && exisitingInitCommands > 0) {\n        const existingCmd = exisitingInitCommands[0]\n        existingCmd.initParams = params\n        existingCmd.mergeExistingParams = mergeExistingParams\n      } else {\n        this.commands.push(\n          {\n            \"type\": \"init\",\n            \"componentExecName\": execName,\n            \"initParams\": params,\n            \"mergeExistingParams\": mergeExistingParams\n          }\n        )\n\n      }\n    }\n  }\n  /**\n   * Update params with [paramName] =  paramValue\n   * paramName can contain dots (.) to separate object attributes\n   * @param {dict} params \n   * @param {string} paramName \n   * @param {*} paramValue \n   */\n  _updateParam(params, paramName, paramValue) {\n    if (paramName.startsWith('.') || paramName.endsWith(\".\")) {\n      throw \"paramName cant start or end in dot (.)\"\n    }\n    return this._updateParamR(params, paramName.split(\".\"), paramValue)\n  }\n  _updateParamR(params, paramNames, paramValue) {\n    let pName = paramNames[0]\n    if (paramNames.length === 1) {\n      // last element\n      params[pName] = paramValue\n    } else if (params[pName] === undefined) {\n      params[pName] = this._updateParamR({}, paramNames.slice(1), paramValue)\n    } else {\n      params[pName] = this._updateParamR(params[pName], paramNames.slice(1), paramValue)\n    }\n    return params\n  }\n\n  addCallCommand(execName, actionName, args = [], kwargs = {}) {\n    this.commands.push(\n      {\n        \"type\": \"call\",\n        \"componentExecName\": execName,\n        \"actionName\": actionName,\n        \"args\": args,\n        \"kwargs\": kwargs\n      }\n    )\n  }\n  addEmitCommand(execName, eventName, kwargs = {}, to = null) {\n    this.commands.push(\n      {\n        \"type\": \"emit\",\n        \"componentExecName\": execName,\n        \"eventName\": eventName,\n        \"params\": kwargs,\n        \"to\": to\n      }\n    )\n\n  }\n  addFilesForUpload(execName, paramName, files) {\n    // remove existing files for same param name\n    let existingFileId = null\n    for (const uf of Object.values(this.filesForUpload)) {\n      if (uf.execName === execName && uf.paramName === paramName) {\n        existingFileId = uf.fileUploadId\n      }\n    }\n    if (existingFileId !== null) {\n      delete this.filesForUpload[existingFileId]\n    }\n\n    if (((files instanceof FileList || files instanceof Array) && files.length > 0)\n      || (files instanceof File)) {\n      // add files to paramName\n      let fileId = null\n      while (fileId == null || Object.keys(this.filesForUpload).includes(fileId)) {\n        fileId = Math.random().toString(36).substring(7)\n      }\n      this.filesForUpload[fileId] = new UploadedFile(\n        execName, paramName, fileId, files\n      )\n      // add init command if not exist\n      this.addInitialiseCommand(execName, {\n        [paramName]: fileId\n      })\n    } else {\n      // remove init command if only containt file init param\n      let initCommandIndex = this.commands.findIndex(cmd =>\n      (cmd.componentExecName === execName\n        && cmd.type === \"init\"\n        && Object.keys(cmd.initParams).includes(paramName)\n        && Object.keys(cmd.initParams).length === 1\n      )\n      )\n      if (initCommandIndex >= 0) {\n        this.commands.splice(initCommandIndex, 1)\n      }\n    }\n  }\n  getXUploadRequestFormData() {\n    if (Object.keys(this.filesForUpload).length === 0) {\n      // no files for uplaod\n      return null\n    }\n    let fd = new FormData()\n    for (const uf of Object.values(this.filesForUpload)) {\n      uf.addToFormData(fd)\n    }\n    return fd\n  }\n  getXRequestJson() {\n    return JSON.stringify({\n      \"components\": Object.values(this.components).map(x => x.toJsonRequest()),\n      \"commands\": this.commands\n    })\n  }\n  setXRequestUrl(url) {\n    this.xRequestUrl = url\n  }\n  executeUpload() {\n    const url = \"/jembe/upload_files\"\n    const uploadFormData = this.getXUploadRequestFormData()\n    if (uploadFormData === null) {\n      return new Promise((resolve, reject) => {\n        resolve(null)\n      })\n    }\n    const headers = this.xRequestHeadersGenerators.length === 0 ? {} : this.calculateXRequestHeaders()\n    headers['X-JEMBE'] = 'upload'\n    return window.fetch(url, {\n      method: \"POST\",\n      cache: \"no-cache\",\n      credentials: \"same-origin\",\n      redirect: \"follow\",\n      referrer: \"no-referrer\",\n      headers: headers,\n      body: uploadFormData\n    }).then(response => {\n      if (!response.ok) {\n        this.dispatchUpdatePageErrorEvent(response, null, false)\n        throw Error(\"errorInJembeResponse\")\n      }\n      return response.json()\n    }).then(json => {\n      // fileupload returns files = dict(fileUploadId, [{storage=storage_name, path=file_path}]) and unique fileUplaodResponseId\n      for (const fileUploadId of Object.keys(json.files)) {\n        // replace all uploaded files init params with \n        //(storage=storage_name, path=file_path) returned from x-jembe=fileupload request\n        const ufiles = json.files[fileUploadId]\n        const fu = this.filesForUpload[fileUploadId]\n        this.addInitialiseCommand(\n          fu.execName, {\n          [fu.paramName]: fu.multipleFiles ? ufiles : ufiles[0]\n        }\n        )\n      }\n\n      this.filesForUpload = {}\n      return json.fileUploadResponseId\n    })\n  }\n  executeCommands(disableInputs = true, updateLocation = true) {\n    const url = this.xRequestUrl !== null ? this.xRequestUrl : window.location.href\n    this.dispatchStartUpdatePageEvent(true, disableInputs)\n    this.executeUpload().then(\n      fileUploadResponseId => {\n        const requestBody = this.getXRequestJson()\n        // reset commads since we create request body from it\n        this.commands = []\n        const headers = this.xRequestHeadersGenerators.length === 0 ? {} : this.calculateXRequestHeaders()\n        headers['X-JEMBE'] = 'commands'\n        if (fileUploadResponseId !== null) {\n          headers['X-JEMBE-RELATED-UPLOAD'] = fileUploadResponseId\n        }\n        // fetch request and process response\n        window.fetch(url, {\n          method: \"POST\",\n          cache: \"no-cache\",\n          credentials: \"same-origin\",\n          redirect: \"follow\",\n          referrer: \"no-referrer\",\n          headers: headers,\n          body: requestBody\n        }).then(response => {\n          if (!response.ok) {\n            if (disableInputs) {\n              this.xRequestsInProgress -= 1\n              this.enableInputsAfterResponse()\n            }\n            console.info('Error x-jembe response', response)\n            this.dispatchUpdatePageErrorEvent(response, null, disableInputs)\n            throw Error(\"errorInJembeResponse\")\n          }\n          return response.json()\n        }).then(\n          json => this.getComponentsFromXResponse(json)\n        ).then(\n          components => {\n            this.updateDocument(components)\n            if (updateLocation && disableInputs) {\n              this.updateLocation()\n            }\n            if (disableInputs) {\n              this.xRequestsInProgress -= 1\n              this.enableInputsAfterResponse()\n            }\n            this.dispatchUpdatePageEvent(true, disableInputs, components)\n          }).catch(error => {\n            if (disableInputs) {\n              this.xRequestsInProgress -= 1\n              this.enableInputsAfterResponse()\n            }\n            console.info('Error x-jembe request', error)\n            this.dispatchUpdatePageErrorEvent(null, error, disableInputs)\n          })\n      }\n    ).catch(error => {\n      console.info('Error x-jembe request', error)\n      this.dispatchUpdatePageErrorEvent(null, error, disableInputs)\n    })\n  }\n  consolidateCommands() {\n    let initCommandsExecNames = this.commands.filter(\n      c => c.type === 'init'\n    ).map(\n      c => c.componentExecName\n    )\n    let callCommandsExecNames = this.commands.filter(\n      c => c.type === 'call'\n    ).map(\n      c => c.componentExecName\n    )\n    for (const execName of initCommandsExecNames) {\n      if (!callCommandsExecNames.includes(execName)) {\n        this.addCallCommand(execName, \"display\")\n      }\n    }\n    //TODO\n    // - display error if actions over two different component are called\n    //   and this components are not on ignore part of flow list, also define flow list    \n  }\n  updateLocation(replace = false) {\n    // TODO non blocking x request should not update location\n    let topComponent = null\n    let level = -1\n    let historyState = []\n    for (const component of Object.values(this.components)) {\n      if (component.hierarchyLevel > level && component.changesUrl === true) {\n        topComponent = component\n        level = component.hierarchyLevel\n      }\n      historyState.push({ execName: component.execName, state: component.state })\n    }\n    if (topComponent !== null) {\n      if (replace) {\n        window.history.replaceState(historyState, '', topComponent.url)\n      } else {\n        window.history.pushState(historyState, '', topComponent.url)\n      }\n    }\n  }\n  onHistoryPopState(event) {\n    if (event.state === null) {\n      window.location = document.location\n    } else {\n      for (const comp of event.state) {\n        this.jembeClient.addInitialiseCommand(comp.execName, comp.state)\n        this.jembeClient.addCallCommand(comp.execName, \"display\")\n      }\n      this.jembeClient.executeCommands(true, false)\n    }\n  }\n  /**\n   * Used for geting jembeCompoentApi usually attached to document or window.jembeComponent \n   * @param {*} domNode \n   */\n  component(domNode) {\n    const componentExecName = domNode.closest('[jmb-name]').getAttribute('jmb-name')\n    return new JMB(this, componentExecName)\n  }\n\n  dispatchUpdatePageEvent(isXUpdate = true, inputsDisabled = true, components = {}) {\n    window.dispatchEvent(\n      new CustomEvent(\n        'jembeUpdatePage',\n        {\n          detail: {\n            isXUpdate: isXUpdate,\n            inputsDisabled: inputsDisabled,\n            components: Object.fromEntries(\n              Object.entries(components).map(\n                ([key, val]) => [key, val.dom]\n              ))\n          }\n        }\n      )\n    )\n  }\n  dispatchStartUpdatePageEvent(isXUpdate = true, disableInputs = true) {\n    if (disableInputs && isXUpdate) {\n      this.xRequestsInProgress += 1\n      if (this.xRequestsInProgress === 1) {\n        this.disableInputBeforeRequestTimeoutId = window.setTimeout(\n          () => { this.disableInputsBeforeRequest() }, 25\n        )\n      }\n    }\n    window.dispatchEvent(\n      new CustomEvent(\n        'jembeStartUpdatePage',\n        {\n          detail: {\n            isXUpdate: isXUpdate,\n            inputsDisabled: disableInputs\n          }\n        }\n      )\n    )\n  }\n  dispatchUpdatePageErrorEvent(response = null, error = null, inputsDisabled=true) {\n    window.dispatchEvent(\n      new CustomEvent(\n        'jembeUpdatePageError',\n        {\n          detail: {\n            inputsDisabled: inputsDisabled,\n            networkError: error !== null,\n            response: response,\n            error: error\n          }\n        }\n      )\n    )\n  }\n  disableInputsBeforeRequest() {\n    // save currently focused element\n    if (this.document.activeElement !== null) {\n      this.xRequestActiveElement = this.document.activeElement\n    }\n    // walk over whole document and disable inputs\n    walk(this.document.documentElement, node => {\n      if (node.hasAttribute('jmb-ignore')) return false\n      if (\n        // <button>\n        (node.tagName.toLowerCase() === 'button') ||\n        // <select>\n        node.tagName.toLowerCase() === 'select' ||\n        // <input type=\"checkbox|radio\">\n        (node.tagName.toLowerCase() === 'input' &&\n          (node.type === 'checkbox' || node.type === 'radio'))\n      ) {\n        node.setAttribute('jmb-node-initially-disabled', node.disabled)\n        if (!node.disabled) {\n          node.disabled = true\n          this.xRequestDisabledElements.push(() => {\n            if (node.hasAttribute(\"jmb-node-initially-disabled\")) {\n              node.disabled = node.getAttribute(\"jmb-node-initially-disabled\") === \"true\"\n              node.removeAttribute(\"jmb-node-initially-disabled\")\n            }\n          })\n        }\n      } else if (\n        // <input type=\"text\">\n        node.tagName.toLowerCase() === 'input' ||\n        // <textarea>\n        node.tagName.toLowerCase() === 'textarea'\n      ) {\n        node.setAttribute('jmb-node-initially-readonly', node.readOnly)\n        if (!node.readOnly) {\n          node.readOnly = true\n          this.xRequestDisabledElements.push(() => {\n            if (node.hasAttribute(\"jmb-node-initially-readonly\")) {\n              node.readOnly = node.getAttribute(\"jmb-node-initially-readonly\") === \"true\"\n              node.removeAttribute(\"jmb-node-initially-readonly\")\n            }\n          })\n        }\n      }\n    })\n  }\n  enableInputsAfterResponse() {\n    window.clearTimeout(this.disableInputBeforeRequestTimeoutId)\n    if (this.xRequestsInProgress !== 0) {\n      return\n    }\n    //enable disabled inputs (not updated by morph) \n    for (let f of this.xRequestDisabledElements) {\n      f()\n    }\n    this.xRequestDisabledElements = []\n    // refocus active element\n    if (this.xRequestActiveElement !== null && this.document.contains(this.xRequestActiveElement)) {\n      this.xRequestActiveElement.focus()\n    }\n    this.xRequestActiveElement = null\n  }\n  addXRequestHeaderGenerator(callback) {\n    this.xRequestHeadersGenerators.push(callback)\n  }\n  calculateXRequestHeaders() {\n    let header = {}\n    for (const headerGenCallback of this.xRequestHeadersGenerators) {\n      header = { ...header, ...headerGenCallback() }\n    }\n    return header\n  }\n  getCookie(name) {\n    return getCookie(name)\n  }\n  walkComponent(component, callback) {\n    if (component instanceof String) {\n      component = this.document.querySelector(`[jmb-name=${component}]`)\n    }\n    walkComponentDom(component, callback)\n  }\n  walkDocument(callback) {\n    walk(this.document.documentElement, callback)\n  }\n}\n\nexport { JembeClient }","import { JembeClient } from \"./client.js\";\nwindow.jembeClient = new JembeClient(document)\nwindow.jembeClient.dispatchUpdatePageEvent(false, false)","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}